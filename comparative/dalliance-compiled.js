!function e(t,i,r){function n(o,a){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[o]={exports:{}};t[o][0].call(h.exports,function(e){var i=t[o][1][e];return n(i?i:e)},h,h.exports,e,t,i,r)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(e,t,i){"use strict";function r(){}function n(e,t){var i=t,r=h(e,i);i+=4;for(var n=0;r>n;++n){var s=(h(e,i),h(e,i+4));i+=8+16*s}var o=h(e,i);i+=4;for(var a=1e9,l=i,u=0;o>u;++u){var c=g(e,l);if(l+=8,c){var f=c.block;c.offset>0&&(f+=65536),a>f&&(a=f);break}}return i+=8*o,{minBlockIndex:a,nbin:r,length:i-t}}function s(e,t,i,r,n){e.slice(0,10).fetch(function(s){return s?o(e,t,i,r,n):r(null,"Couldn't access BAM.")},{timeout:5e3})}function o(e,t,i,s,a){function l(e){if(!e)return s(null,"Couldn't access BAM");var t=v(e,e.byteLength),i=new Uint8Array(t),r=h(i,0);if(r!=b)return s(null,"Not a BAM file, magic=0x"+r.toString(16));for(var n=h(i,4),o="",a=0;n>a;++a)o+=String.fromCharCode(i[a+8]);var l=h(i,n+8),u=n+12;c.chrToIndex={},c.indexToChr=[];for(var a=0;l>a;++a){for(var f=h(i,u),p="",d=0;f-1>d;++d)p+=String.fromCharCode(i[u+4+d]);h(i,u+f+4);c.chrToIndex[p]=a,0==p.indexOf("chr")?c.chrToIndex[p.substring(3)]=a:c.chrToIndex["chr"+p]=a,c.indexToChr.push(p),u=u+8+f}return c.indices?s(c):void 0}function u(e){if(!e)return"Couldn't access BAI";var t=new Uint8Array(e),i=h(t,0);if(i!=w)return s(null,"Not a BAI file, magic=0x"+i.toString(16));var r=h(t,4);c.indices=[];for(var o=8,a=0;r>a;++a){var l=o,u=n(t,l);o+=u.length,f=Math.min(u.minBlockIndex,f);var p=u.nbin;p>0&&(c.indices[a]=new Uint8Array(e,l,o-l))}return!0}var c=new r;c.data=e,c.bai=t,c.indexChunks=i;var f=c.indexChunks?c.indexChunks.minBlockIndex:1e9;if(c.indexChunks){var p=c.indexChunks.chunks;c.indices=[];for(var d=0;d<p.length;d++)c.indices[d]=null;c.data.slice(0,f).fetch(l)}else c.bai.fetch(function(t){var r=u(t);r!==!0?c.bai.url&&"undefined"==typeof a?(c.bai.url=c.data.url.replace(new RegExp(".bam$"),".bai"),o(e,c.bai,i,s,!0)):s(null,r):c.data.slice(0,f).fetch(l)})}function a(){}if("undefined"!=typeof e)var l=e("./spans"),u=(l.Range,l.union,l.intersection,e("./bin")),h=u.readInt,c=u.readShort,f=u.readByte,p=(u.readInt64,u.readFloat),d=e("./lh3utils"),g=d.readVob,v=d.unbgzf,y=d.reg2bins,m=d.Chunk;var b=21840194,w=21578050,x={MULTIPLE_SEGMENTS:1,ALL_SEGMENTS_ALIGN:2,SEGMENT_UNMAPPED:4,NEXT_SEGMENT_UNMAPPED:8,REVERSE_COMPLEMENT:16,NEXT_REVERSE_COMPLEMENT:32,FIRST_SEGMENT:64,LAST_SEGMENT:128,SECONDARY_ALIGNMENT:256,QC_FAIL:512,DUPLICATE:1024,SUPPLEMENTARY:2048};r.prototype.blocksForRange=function(e,t,i){var r=this.indices[e];if(!r)return[];for(var n=y(t,i),s=[],o=0;o<n.length;++o)s[n[o]]=!0;for(var a=[],l=[],u=h(r,0),c=4,f=0;u>f;++f){var p=h(r,c),d=h(r,c+4);if(c+=8,s[p])for(var v=0;d>v;++v){var b=g(r,c),w=g(r,c+8);(4681>p?l:a).push(new m(b,w)),c+=16}else c+=16*d}for(var x=h(r,c),S=null,_=Math.min(t>>14,x-1),T=Math.min(i>>14,x-1),o=_;T>=o;++o){var C=g(r,c+4+8*o);C&&(!S||C.block<S.block||C.block==S.block&&C.offset<S.offset)&&(S=C)}var k=[];if(null!=S)for(var o=0;o<l.length;++o){var L=l[o];(L.maxv.block>S.block||L.maxv.block==S.block&&L.maxv.offset>=S.offset)&&k.push(L)}l=k;for(var O=[],o=0;o<l.length;++o)O.push(l[o]);for(var o=0;o<a.length;++o)O.push(a[o]);O.sort(function(e,t){var i=e.minv.block-t.minv.block;return 0!=i?i:e.minv.offset-t.minv.offset});var A=[];if(O.length>0){for(var E=O[0],o=1;o<O.length;++o){var R=O[o];R.minv.block==E.maxv.block?E=new m(E.minv,R.maxv):(A.push(E),E=R)}A.push(E)}return A},r.prototype.fetch=function(e,t,i,r,n){function s(){if(f>=a.length)return r(c);if(h){var e=new Uint8Array(h),u=o.readBamRecords(e,a[f].minv.offset,c,t,i,l,n);return h=null,++f,u?r(c):s()}var p=a[f],d=p.minv.block,g=p.maxv.block+65536;o.data.slice(d,g-d).fetch(function(e){return h=v(e,p.maxv.block-p.minv.block+1),s()})}var o=this;n=n||{};var a,l=this.chrToIndex[e];if(void 0===l)a=[];else{if(null===this.indices[l]&&this.indexChunks.chunks[l]){var u=this.indexChunks.chunks[l];return this.bai.slice(u[0],u[1]).fetch(function(s){var o=new Uint8Array(s);return this.indices[l]=o,this.fetch(e,t,i,r,n)}.bind(this))}a=this.blocksForRange(l,t,i),a||r(null,"Error in index fetch")}var h,c=[],f=0;s()};var S=["=","A","C","x","G","x","x","x","T","x","x","x","x","x","x","N"],_=["M","I","D","N","S","H","P","=","X","?","?","?","?","?","?","?"];r.prototype.readBamRecords=function(e,t,i,r,n,s,o){for(;;){var l=h(e,t),u=t+l+4;if(u>e.length)return!1;var d=new a,g=h(e,t+4),v=h(e,t+8),y=h(e,t+12),m=(65280&y)>>8,b=255&y,w=h(e,t+16),x=(4294901760&w)>>16,T=65535&w,C=h(e,t+20),k=h(e,t+24),L=h(e,t+28);h(e,t+32);if(d.segment=this.indexToChr[g],d.flag=x,d.pos=v,d.mq=m,o.light&&(d.seqLength=C),!o.light||o.includeName){for(var O="",A=0;b-1>A;++A)O+=String.fromCharCode(e[t+36+A]);d.readName=O}if(!o.light){k>=0&&(d.nextSegment=this.indexToChr[k],d.nextPos=L);for(var E=t+36+b,R="",M=0;T>M;++M){var B=h(e,E);R=R+(B>>4)+_[15&B],E+=4}d.cigar=R;for(var I="",P=C+1>>1,A=0;P>A;++A){var H=e[E+A];I+=S[(240&H)>>4],I.length<C&&(I+=S[15&H])}E+=P,d.seq=I;for(var N="",A=0;C>A;++A)N+=String.fromCharCode(e[E+A]+33);for(E+=C,d.quals=N;u>E;){var F,G=String.fromCharCode(e[E],e[E+1]),D=String.fromCharCode(e[E+2]);if("A"==D)F=String.fromCharCode(e[E+3]),E+=4;else if("i"==D||"I"==D)F=h(e,E+3),E+=7;else if("c"==D||"C"==D)F=e[E+3],E+=4;else if("s"==D||"S"==D)F=c(e,E+3),E+=5;else if("f"==D)F=p(e,E+3),E+=7;else if("Z"==D||"H"==D)for(E+=3,F="";;){var q=e[E++];if(0==q)break;F+=String.fromCharCode(q)}else{if("B"!=D)throw"Unknown type "+D;var U,z,j=String.fromCharCode(e[E+3]),W=h(e,E+4);if("i"==j||"I"==j||"f"==j)U=4,z="f"==j?p:h;else if("s"==j||"S"==j)U=2,z=c;else{if("c"!=j&&"C"!=j)throw"Unknown array type "+j;U=1,z=f}E+=8,F=[];for(var V=0;W>V;++V)F.push(z(e,E)),E+=U}d[G]=F}}if((!r||d.pos<=n&&d.pos+C>=r)&&(void 0===s||g==s)&&i.push(d),d.pos>n)return!0;t=u}},"undefined"!=typeof t&&(t.exports={makeBam:s,BAM_MAGIC:b,BAI_MAGIC:w,BamFlags:x})},{"./bin":4,"./lh3utils":26,"./spans":40}],2:[function(e,t,i){"use strict";function r(e){this.type=e}function n(e,t){this.parser=e,this.sink=t}function s(e,t){this.parser=e,this.sink=t,this.wigState=null}if("undefined"!=typeof e)var o=e("./spans"),a=o.Range,l=o.union,u=o.intersection,h=e("./sourceadapters"),c=h.registerParserFactory,f=e("./das"),p=f.DASStylesheet,d=f.DASStyle,g=(f.DASFeature,f.DASGroup),v=e("./utils"),y=v.shallowCopy;r.prototype.createSession=function(e){return"wig"==this.type?new s(this,e):new n(this,e)};var m=/([^=]+)=(.+)/,b=/\s/,w=new RegExp("^[0-9]+,[0-9]+,[0-9]+");n.prototype.parse=function(e){var t=e.split(b);if(!(t.length<3)){var i=parseInt(t[1])+1,r=parseInt(t[2]),n={segment:t[0],min:i,max:r};if(t.length>3&&"."!==t[3]&&(n.label=t[3]),t.length>4&&(n.score=parseFloat(t[4])),t.length>5&&(n.orientation=t[5]),t.length>8){var s=t[8];w.test(s)&&(n.itemRgb="rgb("+s+")")}if(t.length>=12){var o=parseInt(t[6]),h=parseInt(t[7]),c=parseInt(t[9]),f=t[10].split(",").map(function(e){return parseInt(e)}),p=t[11].split(",").map(function(e){return parseInt(e)});n.type="transcript";var d=new g;if(d.id=t[3],d.type="transcript",d.notes=[],n.groups=[d],t.length>12){var v=t[12],m=v;t.length>13&&(m=t[13]);var x=new g;x.id=v,x.label=m,x.type="gene",n.groups.push(x)}for(var S=null,_=0;c>_;++_){var T=p[_]+i,C=T+f[_],k=new a(T,C);S=S?l(S,k):k}for(var L=S.ranges(),O=0;O<L.length;++O){var A=L[O],E=y(n);E.min=A.min(),E.max=A.max(),this.sink(E)}if(h>o){var R="+"==n.orientation?new a(o,h+3):new a(o-3,h),M=u(S,R);if(M){n.type="translation";for(var B=M.ranges(),I=0,O=0;O<B.length;++O){var P=O;"-"==n.orientation&&(P=B.length-O-1);var A=B[P],E=y(n);E.min=A.min(),E.max=A.max(),n.readframe=I;var H=A.max()-A.min();I=(I+H)%3,this.sink(E)}}}}else this.sink(n)}},n.prototype.flush=function(){},s.prototype.parse=function(e){var t=e.split(b);if("fixedStep"==t[0]){this.wigState="fixedStep",this.chr=this.pos=this.step=null,this.span=1;for(var i=1;i<t.length;++i){var r=m.exec(t[i]);r&&("chrom"==r[1]?this.chr=r[2]:"start"==r[1]?this.pos=parseInt(r[2]):"step"==r[1]?this.step=parseInt(r[2]):"span"==r[1]&&(this.span=parseInt(r[2])))}}else if("variableStep"==t[0]){this.wigState="variableStep",this.chr=null,this.span=1;for(var i=1;i<t.length;++i){var r=m.exec(t[i]);"chrom"==r[1]?this.chr=r[2]:"span"==r[1]&&(this.span=parseInt(r[2]))}}else if(this.wigState){if("fixedStep"==this.wigState){if(1!=t.length)return;var n=parseFloat(t[0]),s={segment:this.chr,min:this.pos,max:this.pos+this.span-1,score:n};this.pos+=this.step,this.sink(s)}else if("variableStep"==this.wigState){if(2!=t.length)return;var o=parseInt(t[0]),n=parseFloat(t[1]),s={segment:this.chr,min:o,max:o+this.span-1,score:n};this.sink(s)}}else{if(t.length<4)return;var s={segment:t[0],min:parseInt(t[1])+1,max:parseInt(t[2]),score:parseFloat(t[3])};this.sink(s)}},s.prototype.flush=function(){},r.prototype.getStyleSheet=function(e){var t=new p;if("wig"==this.type){var i=new d;i.glyph="HISTOGRAM",i.BGCOLOR="blue",i.HEIGHT=30,t.pushStyle({type:"default"},null,i)}else{var i=new d;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="blue",i.HEIGHT=8,i.BUMP=!0,i.LABEL=!0,i.ZINDEX=20,t.pushStyle({type:"default"},null,i);var i=new d;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="red",i.HEIGHT=10,i.BUMP=!0,i.ZINDEX=20,t.pushStyle({type:"translation"},null,i);var r=new d;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="white",r.HEIGHT=10,r.ZINDEX=10,r.BUMP=!0,r.LABEL=!0,t.pushStyle({type:"transcript"},null,r);var n=new d;n.glyph="HISTOGRAM",n.COLOR1="white",n.COLOR2="black",n.HEIGHT=30,t.pushStyle({type:"density"},null,n)}return e(t)},c("bed",function(e){return new r(e)}),c("wig",function(e){return new r(e)})},{"./das":10,"./sourceadapters":38,"./spans":40,"./utils":55}],3:[function(e,t,i){"use strict";function r(e,t){var i=e[t]+e[t+1]*A+e[t+2]*E+e[t+3]*R+e[t+4]*M;return i}function n(){}function s(e,t,i,r){this.bwg=e,this.cirTreeOffset=t,this.cirTreeLength=i,this.isSummary=r}function o(e,t,i){var s=new n;s.data=e,s.name=i,s.data.slice(0,512).salted().fetch(function(e){if(!e)return t(null,"Couldn't fetch file");var i=e,n=new Uint8Array(i),o=new Int16Array(i),a=new Int32Array(i),l=n[0]+A*n[1]+E*n[2]+R*n[3];if(l==S)s.type="bigwig";else{if(l!=T)return l==_||l==C?t(null,"Currently don't support big-endian BBI files"):t(null,"Not a supported format, magic=0x"+l.toString(16));s.type="bigbed"}s.version=o[2],s.numZoomLevels=o[3],s.chromTreeOffset=r(n,8),s.unzoomedDataOffset=r(n,16),s.unzoomedIndexOffset=r(n,24),s.fieldCount=o[16],s.definedFieldCount=o[17],s.asOffset=r(n,36),s.totalSummaryOffset=r(n,44),s.uncompressBufSize=a[13],s.extHeaderOffset=r(n,56),s.zoomLevels=[];for(var u=0;u<s.numZoomLevels;++u){var h=a[6*u+16],c=r(n,24*u+72),f=r(n,24*u+80);s.zoomLevels.push({reduction:h,dataOffset:c,indexOffset:f})}s.readChromTree(function(){s.getAutoSQL(function(e){return s.schema=e,t(s)})})},{timeout:5e3})}function a(e,t,i,r,n){this.bbi=e,this.type=t,this.fieldCount=i,this.offset=r,this.field=n}if("undefined"!=typeof e)var l=e("./spans"),u=l.Range,h=l.union,c=l.intersection,f=e("./das"),p=f.DASFeature,d=f.DASGroup,g=e("./utils"),v=g.shallowCopy,y=e("./bin"),m=y.readInt,b=e("jszlib"),w=b.inflateBuffer,x=b.arrayCopy;var S=2291137574,_=654086024,T=2273964779,C=3958540679,k=1,L=2,O=3,A=256,E=65536,R=16777216,M=4294967296,B=new RegExp("^[0-9]+,[0-9]+,[0-9]+");n.prototype.readChromTree=function(e){var t=this;this.chromsToIDs={},this.idsToChroms={},this.maxID=0;var i=this.unzoomedDataOffset,n=i-this.chromTreeOffset&3;i=i+4-n,this.data.slice(this.chromTreeOffset,i-this.chromTreeOffset).fetch(function(i){var n=new Uint8Array(i),s=new Int16Array(i),o=new Int32Array(i),a=(o[0],o[1],o[2]),l=(o[3],r(n,16),32),u=function h(e){var i=n[e],o=s[e/2+1];e+=4;for(var l=0;o>l;++l)if(0==i){e+=a;var u=r(n,e);e+=8,u-=t.chromTreeOffset,h(u)}else{for(var c="",f=0;a>f;++f){var p=n[e++];0!=p&&(c+=String.fromCharCode(p))}var d=n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e+0];n[e+7]<<24|n[e+6]<<16|n[e+5]<<8|n[e+4];e+=8,t.chromsToIDs[c]=d,0==c.indexOf("chr")&&(t.chromsToIDs[c.substr(3)]=d),t.idsToChroms[d]=c,t.maxID=Math.max(t.maxID,d)}};u(l),e(t)})},s.prototype.readWigData=function(e,t,i,r){var n=this.bwg.chromsToIDs[e];return void 0===n?r([]):void this.readWigDataById(n,t,i,r)},s.prototype.readWigDataById=function(e,t,i,n){var s=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(r){s.cirHeader=r;var o=new Int32Array(s.cirHeader);s.cirBlockSize=o[1],s.readWigDataById(e,t,i,n)});var o=[],a=0,l=(Date.now(),function(r,n,s,o){return(0>e||r==e)&&i>=n&&s>=t}),c=function(e,t){if(s.bwg.instrument&&console.log("level="+t+"; offset="+e+"; time="+(0|Date.now())),a+=e.length,1==e.length&&e[0]-s.cirTreeOffset==48&&s.cachedCirRoot)return p(s.cachedCirRoot,0,t),--a,void(0==a&&s.fetchFeatures(l,o,n));for(var i,r=4+32*s.cirBlockSize,c=0;c<e.length;++c){var d=new u(e[c],e[c]+r);i=i?h(i,d):d}for(var g=i.ranges(),v=0;v<g.length;++v){var y=g[v];f(e,y,t)}},f=function(e,t,i,r){t.max()-t.min();s.bwg.data.slice(t.min(),t.max()-t.min()).fetch(function(r){for(var u=0;u<e.length;++u)t.contains(e[u])&&(p(r,e[u]-t.min(),i),e[u]-s.cirTreeOffset==48&&e[u]-t.min()==0&&(s.cachedCirRoot=r),--a,0==a&&s.fetchFeatures(l,o,n))})},p=function(n,s,a){var l=new Uint8Array(n),u=new Int16Array(n),h=new Int32Array(n),f=l[s],p=u[s/2+1];if(s+=4,0!=f)for(var d=0;p>d;++d){var g=s/4,v=h[g],y=h[g+1],m=h[g+2],b=h[g+3],w=r(l,s+16),x=r(l,s+24);(0>e||e>v||v==e&&i>=y)&&(0>e||m>e||m==e&&b>=t)&&o.push({offset:w,size:x}),s+=32}else{for(var S=[],d=0;p>d;++d){var g=s/4,v=h[g],y=h[g+1],m=h[g+2],b=h[g+3],w=r(l,s+16);(0>e||e>v||v==e&&i>=y)&&(0>e||m>e||m==e&&b>=t)&&S.push(w),s+=24}S.length>0&&c(S,a+1)}};c([s.cirTreeOffset+48],1)},s.prototype.fetchFeatures=function(e,t,i){var r=this;if(t.sort(function(e,t){return(0|e.offset)-(0|t.offset)}),0==t.length)i([]);else{var n=[],s=function(e,t,i,s){s||(s={});var o=new p;o._chromId=e,o.segment=r.bwg.idsToChroms[e],o.min=t,o.max=i,o.type=r.bwg.type;for(var a in s)o[a]=s[a];n.push(o)},o=function a(){if(0==t.length){Date.now();return void i(n)}var o=t[0];if(o.data)r.parseFeatures(o.data,s,e),t.splice(0,1),a();else{for(var l=o.offset,u=o.size,h=1;h<t.length&&t[h].offset==l+u;)u+=t[h].size,++h;r.bwg.data.slice(l,u).fetch(function(e){for(var i=0,n=0;u>i;){var s,o=t[n];if(r.bwg.uncompressBufSize>0)s=w(e,i+2,o.size-2);else{var l=new Uint8Array(o.size);x(new Uint8Array(e,i,o.size),0,l,0,o.size),s=l.buffer}o.data=s,i+=o.size,++n}a()})}};o()}},s.prototype.parseFeatures=function(e,t,i){var r=new Uint8Array(e);if(this.isSummary)for(var n=new Int16Array(e),s=new Int32Array(e),o=new Float32Array(e),a=e.byteLength/32,l=0;a>l;++l){var f=s[8*l],p=s[8*l+1],g=s[8*l+2],y=s[8*l+3],m=(o[8*l+4],o[8*l+5]),b=o[8*l+6];o[8*l+7];if(i(f,p+1,g)){var w={type:"bigwig",score:b/y,maxScore:m};"bigbed"==this.bwg.type&&(w.type="density"),t(f,p+1,g,w)}}else if("bigwig"==this.bwg.type){var n=new Int16Array(e),s=new Int32Array(e),o=new Float32Array(e),f=s[0],x=s[1],S=(s[2],s[3]),_=s[4],T=r[20],a=n[11];if(T==O)for(var l=0;a>l;++l){var C=o[l+6],A=x+l*S+1,E=x+l*S+_;i(f,A,E)&&t(f,A,E,{score:C})}else if(T==L)for(var l=0;a>l;++l){var p=s[2*l+6]+1,g=p+_-1,C=o[2*l+7];i(f,p,g)&&t(f,p,g,{score:C})}else if(T==k)for(var l=0;a>l;++l){var p=s[3*l+6]+1,g=s[3*l+7],C=o[3*l+8];p>g&&(p=g),i(f,p,g)&&t(f,p,g,{score:C})}else console.log("Currently not handling bwgType="+T)}else{if("bigbed"!=this.bwg.type)throw Error("Don't know what to do with "+this.bwg.type);for(var R=0,M=this.bwg.definedFieldCount,I=this.bwg.schema;R<r.length;){var f=r[R+3]<<24|r[R+2]<<16|r[R+1]<<8|r[R+0],p=r[R+7]<<24|r[R+6]<<16|r[R+5]<<8|r[R+4],g=r[R+11]<<24|r[R+10]<<16|r[R+9]<<8|r[R+8];R+=12;for(var P="";;){var H=r[R++];if(0==H)break;P+=String.fromCharCode(H)}var N,F={};if(N=P.length>0?P.split("	"):[],N.length>0&&M>3&&(F.label=N[0]),N.length>1&&M>4){var C=parseInt(N[1]);isNaN(C)||(F.score=C)}if(N.length>2&&M>5&&(F.orientation=N[2]),N.length>5&&M>8){var G=N[5];B.test(G)&&(F.itemRgb="rgb("+G+")")}if(N.length>M-3&&I)for(var D=M-3;D<N.length;++D)F[I.fields[D+3].name]=N[D];if(i(f,p+1,g,N))if(12>M)t(f,p+1,g,F);else{var q=0|N[3],U=0|N[4],z=0|N[6],j=N[7].split(","),W=N[8].split(",");if(F.exonFrames){var V=F.exonFrames.split(",");F.exonFrames=void 0}F.type="transcript";var X=new d;for(var K in F)X[K]=F[K];if(X.id=N[0],X.segment=this.bwg.idsToChroms[f],X.min=p+1,X.max=g,X.notes=[],F.groups=[X],N.length>9){var Z=F.geneName||N[9],Q=Z;N.length>10&&(Q=N[10]),F.geneName2&&(Q=F.geneName2);var Y=v(X);Y.id=Z,Y.label=Q,Y.type="gene",F.groups.push(Y)}for(var $=[],J=0;z>J;++J){var ee=(0|W[J])+p,te=ee+(0|j[J]),ie=new u(ee,te);$.push(ie)}for(var re=h($),ne=re.ranges(),se=0;se<ne.length;++se){var oe=ne[se];t(f,oe.min()+1,oe.max(),F)}if(U>q){var ae="+"==F.orientation?new u(q,U+3):new u(q-3,U),le=c(re,ae);if(le){F.type="translation";for(var ue=le.ranges(),he=0,ce=0;ue[0].min()>ne[ce].max();)ce++;for(var se=0;se<ue.length;++se){var fe=se;"-"==F.orientation&&(fe=ue.length-se-1);var oe=ue[fe];if(F.readframe=he,V){var pe=parseInt(V[fe+ce]);"number"==typeof pe&&pe>=0&&2>=pe&&(F.readframe=pe,F.readframeExplicit=!0)}var de=oe.max()-oe.min();he=(he+de)%3,t(f,oe.min()+1,oe.max(),F)}}}}}}},s.prototype.getFirstAdjacent=function(e,t,i,r){var n=this.bwg.chromsToIDs[e];return void 0===n?r([]):void this.getFirstAdjacentById(n,t,i,r)},s.prototype.getFirstAdjacentById=function(e,t,i,n){var s=this;if(!this.cirHeader)return void this.bwg.data.slice(this.cirTreeOffset,48).fetch(function(r){s.cirHeader=r;var o=new Int32Array(s.cirHeader);s.cirBlockSize=o[1],s.getFirstAdjacentById(e,t,i,n)});var o=null,a=-1,l=-1,c=0,f=(Date.now(),function(e,t){c+=e.length;for(var i,r=4+32*s.cirBlockSize,n=0;n<e.length;++n){var o=new u(e[n],e[n]+r);i=i?h(i,o):o}for(var a=i.ranges(),l=0;l<a.length;++l){var f=a[l];p(e,f,t)}}),p=function(r,a,l,u){a.max()-a.min();s.bwg.data.slice(a.min(),a.max()-a.min()).fetch(function(u){for(var h=0;h<r.length;++h)if(a.contains(r[h])&&(d(u,r[h]-a.min(),l),--c,0==c)){if(!o)return i>0&&(0!=e||t>0)?s.getFirstAdjacentById(0,0,i,n):0>i&&(e!=s.bwg.maxID||1e9>t)?s.getFirstAdjacentById(s.bwg.maxID,1e9,i,n):n([]);s.fetchFeatures(function(r,n,s,o){return 0>i&&(e>r||t>s)||i>0&&(r>e||n>t)},[o],function(e){for(var t=null,r=-1,s=-1,o=0;o<e.length;++o){var a=e[o],l=a._chromId,u=a.min,h=a.max;(null==t||0>i&&(l>r||h>s)||i>0&&(r>l||s>u))&&(t=a,s=0>i?h:u,r=l)}return n(null!=t?[t]:[])})}})},d=function(n,u,h){var c=new Uint8Array(n),p=new Int16Array(n),d=new Int32Array(n),g=c[u],v=p[u/2+1];if(u+=4,0!=g)for(var y=0;v>y;++y){var m=u/4,b=d[m],w=d[m+1],x=d[m+2],S=d[m+3],_=r(c,u+16),T=r(c,u+24);(0>i&&(e>b||b==e&&t>=w)||i>0&&(x>e||x==e&&S>=t))&&(/_random/.exec(s.bwg.idsToChroms[b])||(null==o||0>i&&(x>a||x==a&&S>l)||i>0&&(a>b||b==a&&l>w))&&(o={offset:_,size:T},l=0>i?S:w,a=0>i?x:b)),u+=32}else{for(var C=-1,k=-1,L=-1,y=0;v>y;++y){var m=u/4,b=d[m],w=d[m+1],x=d[m+2],S=d[m+3],_=d[m+4]<<32|d[m+5];(0>i&&(e>b||b==e&&t>=w)&&x>=e||i>0&&(x>e||x==e&&S>=t)&&e>=b)&&(0>C||S>k)&&(C=_,k=0>i?S:w,L=0>i?x:b),u+=24}C>=0&&f([C],h+1)}};f([s.cirTreeOffset+48],1)},n.prototype.readWigData=function(e,t,i,r){this.getUnzoomedView().readWigData(e,t,i,r)},n.prototype.getUnzoomedView=function(){if(!this.unzoomedView){var e=4e3,t=this.zoomLevels[0];t&&(e=this.zoomLevels[0].dataOffset-this.unzoomedIndexOffset),this.unzoomedView=new s(this,this.unzoomedIndexOffset,e,!1)}return this.unzoomedView},n.prototype.getZoomedView=function(e){var t=this.zoomLevels[e];return t.view||(t.view=new s(this,t.indexOffset,4e3,!0)),t.view},n.prototype._tsFetch=function(e,t,i,r,n){var s=this;if(!(e>=this.zoomLevels.length-1)){var o;return o=0>e?this.getUnzoomedView():this.getZoomedView(e),o.readWigDataById(t,i,r,n)}if(this.topLevelReductionCache){for(var a=[],l=this.topLevelReductionCache,u=0;u<l.length;++u)l[u]._chromId==t&&a.push(l[u]);return n(a)}this.getZoomedView(this.zoomLevels.length-1).readWigDataById(-1,0,3e8,function(o){return s.topLevelReductionCache=o,s._tsFetch(e,t,i,r,n)})},n.prototype.thresholdSearch=function(e,t,i,r,n){function s(){if(0==l.length)return n(null);l.sort(function(e,t){var r=e.zoom-t.zoom;return 0!=r?r:(r=e.chrOrd-t.chrOrd,0!=r?r:e.min-t.min*i)});var e=l.splice(0,1)[0];o._tsFetch(e.zoom,e.chr,e.min,e.max,function(o){var a=i>0?0:3e8;e.fromRef&&(a=t);for(var u=0;u<o.length;++u){var h,c=o[u];if(h=void 0!=c.maxScore?c.maxScore:c.score,i>0){if(h>r)if(e.zoom<0){if(c.min>a)return n(c)}else c.max>a&&l.push({chr:e.chr,chrOrd:e.chrOrd,zoom:e.zoom-2,min:c.min,max:c.max,fromRef:e.fromRef})}else if(h>r)if(e.zoom<0){if(c.max<a)return n(c)}else c.min<a&&l.push({chr:e.chr,chrOrd:e.chrOrd,zoom:e.zoom-2,min:c.min,max:c.max,fromRef:e.fromRef})}s()})}i=0>i?-1:1;for(var o=this,a=this.chromsToIDs[e],l=[{chrOrd:0,chr:a,zoom:o.zoomLevels.length-4,min:0,max:3e8,fromRef:!0}],u=1;u<=this.maxID+1;++u){var h=(a+i*u)%(this.maxID+1);0>h&&(h+=this.maxID+1),l.push({chrOrd:u,chr:h,zoom:o.zoomLevels.length-1,min:0,max:3e8})}s()},n.prototype.getAutoSQL=function(e){return this.asOffset?void this.data.slice(this.asOffset,2048).fetch(function(t){for(var i=new Uint8Array(t),r="",n=0;n<i.length&&0!=i[n];++n)r+=String.fromCharCode(i[n]);var s=/(\w+)\s+(\w+)\s+("([^"]+)")?\s+\(\s*/,o=/([\w\[\]]+)\s+(\w+)\s*;\s*("([^"]+)")?\s*/g,a=s.exec(r);if(a){var l={declType:a[1],name:a[2],comment:a[4],fields:[]};r=r.substring(a[0]);for(var u=o.exec(r);null!=u;u=o.exec(r))l.fields.push({type:u[1],name:u[2],comment:u[4]});return e(l)}}):e(null)},n.prototype.getExtraIndices=function(e){var t=this;return this.version<4||0==this.extHeaderOffset||"bigbed"!=this.type?e(null):void this.data.slice(this.extHeaderOffset,64).fetch(function(i){if(!i)return e(null,"Couldn't fetch extension header");var n=new Uint8Array(i),s=new Int16Array(i),o=(new Int32Array(i),s[0],s[1]),l=r(n,4);return 0==o?e(null):void t.data.slice(l,20*o).fetch(function(i){if(!i)return e(null,"Couldn't fetch index info");for(var n=new Uint8Array(i),s=new Int16Array(i),l=(new Int32Array(i),[]),u=0;o>u;++u){var h=s[10*u],c=s[10*u+1],f=r(n,20*u+4),p=s[10*u+8],d=new a(t,h,c,f,p);l.push(d)}e(l)})})},a.prototype.lookup=function(e,t){var i=this;this.bbi.data.slice(this.offset,32).fetch(function(n){function s(n){i.bbi.data.slice(n,4+l*(u+h)).fetch(function(n){var o=new Uint8Array(n),a=new Uint16Array(n),l=(new Uint32Array(n),o[0]),c=a[1],f=4;if(0!=l){for(var p=0;c>p;++p){for(var d="",g=0;u>g;++g){var v=o[f++];0!=v&&(d+=String.fromCharCode(v))}if(d==e){var y=r(o,f),b=m(o,f+8);return i.bbi.getUnzoomedView().fetchFeatures(function(t,r,n,s){return s&&s.length>i.field-3?s[i.field-3]==e:void 0},[{offset:y,size:b}],t)}f+=h}return t([])}for(var w=null,p=0;c>p;++p){for(var d="",g=0;u>g;++g){var v=o[f++];0!=v&&(d+=String.fromCharCode(v))}var x=r(o,f);if(f+=8,e.localeCompare(d)<0&&w)return void s(w);w=x}s(w)})}var o=new Uint8Array(n),a=(new Int16Array(n),new Int32Array(n)),l=(a[0],a[1]),u=a[2],h=a[3],c=(r(o,16),32);s(i.offset+c)})},"undefined"!=typeof t&&(t.exports={makeBwg:o,BIG_BED_MAGIC:T,BIG_WIG_MAGIC:S})},{"./bin":4,"./das":10,"./spans":40,"./utils":55,jszlib:60}],4:[function(e,t,i){"use strict";function r(e){this.blob=e}function n(e,t,i,r){r||("object"===("undefined"==typeof t?"undefined":f(t))?(r=t,t=void 0):r={}),this.url=e,this.start=t||0,i&&(this.end=i),this.opts=r}function s(e){if(!e)return null;for(var t=new Uint8Array(e.length),i=0;i<t.length;++i)t[i]=e.charCodeAt(i);return t.buffer}function o(e,t){return x[0]=e[t],x[1]=e[t+1],x[2]=e[t+2],x[3]=e[t+3],S[0]}function a(e,t){return e[t+7]<<24|e[t+6]<<16|e[t+5]<<8|e[t+4]}function l(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function u(e,t){return e[t+1]<<8|e[t]}function h(e,t){return e[t]}function c(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if("undefined"!=typeof e)var p=e("./utils"),d=p.shallowCopy,g=e("./sha1"),v=g.b64_sha1,y=e("es6-promise").Promise;r.prototype.slice=function(e,t){var i;return i=this.blob.slice?t?this.blob.slice(e,e+t):this.blob.slice(e):t?this.blob.webkitSlice(e,e+t):this.blob.webkitSlice(e),new r(i)},r.prototype.salted=function(){return this},"undefined"!=typeof FileReader?r.prototype.fetch=function(e){var t=new FileReader;t.onloadend=function(i){e(s(t.result))},t.readAsBinaryString(this.blob)}:r.prototype.fetch=function(e){var t=new FileReaderSync;try{var i=t.readAsArrayBuffer(this.blob);e(i)}catch(r){e(null,r)}},n.prototype.slice=function(e,t){if(0>e)throw"Bad slice "+e;var i=this.start,r=this.end;return i&&e?i+=e:i=e||i,r=t&&i?i+t-1:r||t-1,new n(this.url,i,r,this.opts)};var m=0,b="undefined"!=typeof navigator&&navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0;n.prototype.fetchAsText=function(e){var t=this;this.getURL().then(function(i){try{var r,n=new XMLHttpRequest;if((b||t.opts.salt)&&i.indexOf("?")<0&&(i=i+"?salt="+v(""+Date.now()+","+ ++m)),n.open("GET",i,!0),t.end){if(t.end-t.start>1e8)throw"Monster fetch!";n.setRequestHeader("Range","bytes="+t.start+"-"+t.end),r=t.end-t.start+1}n.onreadystatechange=function(){return 4==n.readyState?e(200==n.status||206==n.status?n.responseText:null):void 0},t.opts.credentials&&(n.withCredentials=!0),n.send()}catch(s){return e(null)}})["catch"](function(t){return console.log(t),e(null,t)})},n.prototype.salted=function(){var e=d(this.opts);return e.salt=!0,new n(this.url,this.start,this.end,e)},n.prototype.getURL=function(){return this.opts.resolver?this.opts.resolver(this.url).then(function(e){return"string"==typeof e?e:e.url}):y.resolve(this.url)},n.prototype.fetch=function(e,t){var i=this;t=t||{};var r=t.attempt||1,n=t.truncatedLength;return r>3?e(null):void this.getURL().then(function(o){try{var a;t.timeout&&!i.opts.credentials&&(a=setTimeout(function(){return console.log("timing out "+o),u.abort(),e(null,"Timeout")},t.timeout));var l,u=new XMLHttpRequest;if((b||i.opts.salt)&&o.indexOf("?")<0&&(o=o+"?salt="+v(""+Date.now()+","+ ++m)),u.open("GET",o,!0),u.overrideMimeType("text/plain; charset=x-user-defined"),i.end){if(i.end-i.start>1e8)throw"Monster fetch!";u.setRequestHeader("Range","bytes="+i.start+"-"+i.end),l=i.end-i.start+1}u.responseType="arraybuffer",u.onreadystatechange=function(){if(4==u.readyState){if(a&&clearTimeout(a),200==u.status||206==u.status){if(u.response){var t=u.response.byteLength;return!l||l==t||n&&t==n?e(u.response):i.fetch(e,{attempt:r+1,truncatedLength:t})}if(u.mozResponseArrayBuffer)return e(u.mozResponseArrayBuffer);var o=u.responseText;return!l||l==o.length||n&&o.length==n?e(s(u.responseText)):i.fetch(e,{attempt:r+1,truncatedLength:o.length})}return i.fetch(e,{attempt:r+1})}},i.opts.credentials&&(u.withCredentials=!0),u.send()}catch(h){return e(null)}})["catch"](function(t){return console.log(t),e(null,t)})};var w=new ArrayBuffer(8),x=new Uint8Array(w),S=new Float32Array(w);"undefined"!=typeof t&&(t.exports={BlobFetchable:r,URLFetchable:n,readInt:l,readIntBE:c,readInt64:a,readShort:u,readByte:h,readFloat:o})},{"./sha1":37,"./utils":55,"es6-promise":59}],5:[function(e,t,i){"use strict";function r(e){var t="bp";return e>1e9?(e/=1e9,t="Gb"):e>1e6?(e/=1e6,t="Mb"):e>1e3&&(e/=1e3,t="kb"),""+Math.round(e)+t}if("undefined"!=typeof e){var n=e("./cbrowser"),s=n.Browser,o=e("./utils"),a=o.makeElement,l=(o.removeChildren,e("./numformats")),u=l.formatLongInt,h=e("./zoomslider");e("./tier-edit"),e("./export-config"),e("./export-ui"),e("./export-image"),e("./svg-export"),e("./session")}s.prototype.initUI=function(e,t){this.noSourceCSS||["bootstrap-scoped.css","dalliance-scoped.css","font-awesome.min.css"].forEach(function(e){document.head.appendChild(a("link","",{rel:"stylesheet",href:this.resolveURL("$$css/"+e)}))}.bind(this));var i=this;i.disableDefaultFeaturePopup||this.addFeatureListener(function(e,t,r,n){i.featurePopup(e,t,r,n)}),e.classList.add("dalliance");var n=i.toolbar=a("div",null,{className:"btn-toolbar toolbar"}),s=i.coordSystem.speciesName+" "+i.nameForCoordSystem(i.coordSystem);this.setDocumentTitle&&(document.title=s+" :: dalliance");var o=a("input","",{className:"loc-field"});i.makeTooltip(o,"Enter a genomic location or gene name");var l=a("p","",{className:"loc-status"}),c=a("a",[a("i",null,{className:"fa fa-search-plus"})],{className:"btn"}),f=new h({width:i.zoomSliderWidth});i.makeTooltip(f,"Highlighted button shows current zoom level, gray button shows inactive zoom level (click or tap SPACE to toggle).");var p=a("a",[a("i",null,{className:"fa fa-search-minus"})],{className:"btn"}),d=a("a",[a("i",null,{className:"fa fa-eraser"})],{className:"btn"}),g=a("a",[a("i",null,{className:"fa fa-plus"})],{className:"btn"}),v=a("a",[a("i",null,{className:"fa fa-bookmark"})],{className:"btn"}),y=a("a",[a("i",null,{className:"fa fa-print"})],{className:"btn"}),m=(a("a",[a("i",null,{className:"fa fa-refresh"})],{className:"btn"}),a("a",[a("i",null,{className:"fa fa-cogs"})],{className:"btn"})),b=a("a",[a("i",null,{className:"fa fa-question"})],{className:"btn"}),w=a("a",[a("i",null,{className:"fa fa-road"})],{className:"btn"});i.makeTooltip(w,"Configure currently selected track(s) (E)");var x=a("a",[a("i",null,{className:"fa fa-angle-left"})],{className:"btn"},{width:"5px"}),S=a("a",[a("i",null,{className:"fa fa-angle-right"})],{className:"btn pull-right"},{width:"5px"}),_=a("div",null,{className:"btn-group pull-right"});this.noTrackAdder||_.appendChild(g),this.noTrackEditor||_.appendChild(w),this.noExport||_.appendChild(y),this.noOptions||_.appendChild(m),this.noHelp||_.appendChild(b),this.setUiMode=function(e){this.uiMode=e;var t={help:b,add:g,opts:m,"export":y,tier:w};for(var i in t)i==e?t[i].classList.add("active"):t[i].classList.remove("active")},this.noLeapButtons||n.appendChild(S),_.firstChild&&n.appendChild(_),this.noLeapButtons||n.appendChild(x),this.noTitle||n.appendChild(a("div",a("h4",s,{},{margin:"0px"}),{className:"btn-group title"})),this.noLocationField||n.appendChild(a("div",[o,l],{className:"btn-group loc-group"})),this.noClearHighlightsButton||n.appendChild(d),this.noZoomSlider||n.appendChild(a("div",[c,a("span",f,{className:"btn"}),p],{className:"btn-group"})),this.toolbarBelow?(e.appendChild(t),e.appendChild(n)):(e.appendChild(n),e.appendChild(t));var T=Math.log(2)/Math.log(10),C=Math.log(5)/Math.log(10),k=function(e){var t,r=(e/i.zoomExpt+Math.log(i.zoomBase))/Math.log(10),n=0|r,s=r-n;return t=.01>s?n:T+.01>=s?n+T:C+.01>=s?n+C:n+1,(t*Math.log(10)-Math.log(i.zoomBase))*i.zoomExpt},L=function(e){f.addLabel(e,r(Math.exp(e/i.zoomExpt)*i.zoomBase))};this.addViewListener(function(e,t,r,n,s){o.value=e+":"+u(t)+".."+u(r),f.min=0|s.min,f.max=0|s.max,s.isSnapZooming?(f.value=s.alternate,f.value2=s.current,f.active=2):(f.value=s.current,f.value2=s.alternate,f.active=1),s.current==s.min?c.classList.add("disabled"):c.classList.remove("disabled"),s.current==s.max?p.classList.add("disabled"):p.classList.remove("disabled"),f.removeLabels();var a=s.min,l=s.max,h=l-a,g=4;i.zoomSliderWidth&&i.zoomSliderWidth<150&&(g=3),L(k(a));for(var v=1;g-1>v;++v)L(k(a+1*v*h/(g-1)));L(k(l)),i.storeStatus&&i.storeViewStatus(),i.highlights.length>0?d.style.display="inline-block":d.style.display="none"}),this.addTierListener(function(){i.storeStatus&&i.storeTierStatus()}),o.addEventListener("keydown",function(e){if(40==e.keyCode&&(e.preventDefault(),e.stopPropagation(),i.setSelectedTier(0)),10==e.keyCode||13==e.keyCode){e.preventDefault();var t=o.value;i.search(t,function(e){e?l.textContent=""+e:l.textContent=""})}},!1);var O;g.addEventListener("click",function(e){O&&O.displayed?i.removeAllPopups():O=i.showTrackAdder(e)},!1),i.makeTooltip(g,"Add a new track from the registry or an indexed file. (A)"),c.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),i.zoomStep(-10)},!1),i.makeTooltip(c,"Zoom in (+)"),p.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),i.zoomStep(10)},!1),i.makeTooltip(p,"Zoom out (-)"),f.addEventListener("change",function(e){
var t=2==f.active;t!=i.isSnapZooming&&(i.savedZoom=i.zoomSliderValue-i.zoomMin,i.isSnapZooming=t);var r=1==f.active?f.value:f.value2;i.zoomSliderValue=1*r,i.zoom(Math.exp(1*r/i.zoomExpt))},!1),v.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()},!1),i.makeTooltip(v,"Favourite regions"),y.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),i.openExportPanel()},!1),i.makeTooltip(y,"Export publication-quality SVG. (X)");m.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),i.toggleOptsPopup(e)},!1),i.makeTooltip(m,"Configure options."),b.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),i.toggleHelpPopup(e)}),i.makeTooltip(b,"Help; Keyboard shortcuts. (H)"),w.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),1==i.selectedTiers.length&&i.openTierPanel(i.tiers[i.selectedTiers[0]])},!1),x.addEventListener("click",function(e){i.leap(i.reverseKeyScrolling?-1:1,!1)},!1),i.makeTooltip(x,function(e){var t,r=i.getSelectedTier();return r>=0&&(t=i.tiers[r]),t&&t.featureSource&&i.sourceAdapterIsCapable(t.featureSource,"quantLeap")&&"number"==typeof t.quantLeapThreshold?'Jump to the next region with a score above the threshold in the selected track "'+(t.config.name||t.dasSource.name)+'"" (ctrl+LEFT)':t&&t.featureSource&&i.sourceAdapterIsCapable(t.featureSource,"leap")?'Jump to the next feature in the selected track "'+(t.config.name||t.dasSource.name)+'" (ctrl+LEFT)':"Jump left (shift+LEFT)"}),S.addEventListener("click",function(e){i.leap(i.reverseKeyScrolling?1:-1,!1)},!1),i.makeTooltip(S,function(e){var t,r=i.getSelectedTier();return r>=0&&(t=i.tiers[r]),t&&t.featureSource&&i.sourceAdapterIsCapable(t.featureSource,"quantLeap")&&"number"==typeof t.quantLeapThreshold?'Jump to the next region with a score above the threshold in the selected track "'+(t.config.name||t.dasSource.name)+'"" (ctrl+RIGHT)':t&&t.featureSource&&i.sourceAdapterIsCapable(t.featureSource,"leap")?'Jump to the next feature in the selected track "'+(t.config.name||t.dasSource.name)+'" (ctrl+RIGHT)':"Jump right (shift+RIGHT)"}),i.addTierSelectionListener(function(){var e,t=i.getSelectedTier();t>=0&&(e=i.tiers[t]);var r=!1;e&&e.featureSource&&(i.sourceAdapterIsCapable(e.featureSource,"quantLeap")&&"number"==typeof e.quantLeapThreshold?r=!0:i.sourceAdapterIsCapable(e.featureSource,"leap")&&(r=!0)),x.firstChild.className=r?"fa fa-angle-double-left":"fa fa-angle-left",S.firstChild.className=r?"fa fa-angle-double-right":"fa fa-angle-right"}),d.addEventListener("click",function(e){i.clearHighlights()},!1),i.makeTooltip(d,"Clear highlights (C)"),i.addTierSelectionWrapListener(function(e){0>e&&(i.setSelectedTier(null),o.focus())}),i.addTierSelectionListener(function(e){if("tier"===i.uiMode)if(0==e.length)i.hideToolPanel(),i.manipulatingTier=null,i.uiMode="none";else{var t=i.tiers[e[0]];t!=i.manipulatingTier&&i.openTierPanel(t)}});var A=function(e){65==e.keyCode||97==e.keyCode?(e.preventDefault(),e.stopPropagation(),i.showTrackAdder()):72==e.keyCode||104==e.keyCode?(e.stopPropagation(),e.preventDefault(),i.toggleHelpPopup(e)):69==e.keyCode||101==e.keyCode?(e.stopPropagation(),e.preventDefault(),1==i.selectedTiers.length&&i.openTierPanel(i.tiers[i.selectedTiers[0]])):88==e.keyCode||120==e.keyCode?(e.stopPropagation(),e.preventDefault(),i.openExportPanel()):(67==e.keyCode||99==e.keyCode)&&(e.stopPropagation(),e.preventDefault(),i.clearHighlights())};e.addEventListener("focus",function(t){e.addEventListener("keydown",A,!1)},!1),e.addEventListener("blur",function(t){e.removeEventListener("keydown",A,!1)},!1),e.addEventListener("keydown",function(e){27===e.keyCode&&"none"!==i.uiMode&&(e.preventDefault(),e.stopPropagation(),i.setUiMode("none"),i.hideToolPanel(),i.selectedTiers&&i.selectedTiers.length>0&&i.browserHolder.focus())},!1)},s.prototype.showToolPanel=function(e,t){var i=this;this.activeToolPanel&&this.activeToolPanel.parentElement.removeChild(this.activeToolPanel);var r;r=t?e:a("div",e,{},{overflowY:"auto",width:"100%"});var n=a("div",a("i",null,{className:"fa fa-caret-right"}),{className:"tool-divider"});n.addEventListener("click",function(e){i.hideToolPanel(),i.setUiMode("none")},!1),this.makeTooltip(n,"Close tool panel (ESC)"),this.activeToolPanel=a("div",[n,r],{className:"tool-holder"}),this.svgHolder.appendChild(this.activeToolPanel),this.resizeViewer();var i=this},s.prototype.hideToolPanel=function(){this.activeToolPanel&&this.activeToolPanel.parentElement.removeChild(this.activeToolPanel),this.svgHolder.style.width="100%",this.activeToolPanel=null,this.resizeViewer()},s.prototype.toggleHelpPopup=function(e){if("help"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var t=a("iframe",null,{scrolling:"yes",seamless:"seamless",src:this.resolveURL("$$help/index.html"),className:"help-panel"});this.showToolPanel(t,!1),this.setUiMode("help")}},s.prototype.toggleOptsPopup=function(e){var t=this;if("opts"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var i=a("div",null,{className:"form-horizontal"},{boxSizing:"border-box",MozBoxSizing:"border-box",display:"inline-block",verticalAlign:"top"}),r=a("table");r.cellPadding=5;var n=a("input","",{type:"checkbox",checked:t.reverseScrolling});n.addEventListener("change",function(e){t.reverseScrolling=n.checked,t.storeStatus()},!1),r.appendChild(a("tr",[a("td","Reverse trackpad scrolling",{align:"right"}),a("td",n)]));var s=a("input","",{type:"checkbox",checked:t.reverseKeyScrolling});s.addEventListener("change",function(e){t.reverseKeyScrolling=s.checked,t.storeStatus()},!1),r.appendChild(a("tr",[a("td","Reverse scrolling buttons and keys",{align:"right"}),a("td",s)]));var o=a("select");o.appendChild(a("option","Left",{value:"left"})),o.appendChild(a("option","Center",{value:"center"})),o.appendChild(a("option","Right",{value:"right"})),o.appendChild(a("option","None",{value:"none"})),o.value=t.rulerLocation,o.addEventListener("change",function(e){t.rulerLocation=o.value,t.positionRuler();for(var i=0;i<t.tiers.length;++i)t.tiers[i].paintQuant();t.storeStatus()},!1),r.appendChild(a("tr",[a("td","Vertical guideline",{align:"right"}),a("td",o)]));var l=a("input","",{type:"checkbox",checked:t.singleBaseHighlight});l.addEventListener("change",function(e){t.singleBaseHighlight=l.checked,t.positionRuler(),t.storeStatus()},!1),l.setAttribute("id","singleBaseHightlightButton"),r.appendChild(a("tr",[a("td","Display and highlight current genome location",{align:"right"}),a("td",l)])),i.appendChild(r);var u=a("button","Reset browser",{className:"btn"},{marginLeft:"auto",marginRight:"auto",display:"block"});u.addEventListener("click",function(e){t.reset()},!1),i.appendChild(u),this.showToolPanel(i),this.setUiMode("opts")}}},{"./cbrowser":6,"./export-config":16,"./export-image":17,"./export-ui":18,"./numformats":29,"./session":36,"./svg-export":43,"./tier-edit":50,"./utils":55,"./zoomslider":58}],6:[function(e,t,i){"use strict";function r(e,t,i){this.min=t,this.max=i,this.chr=e}function n(e){if(e||(e={}),this.renderers={"default":B,dummy:H,multi:I,sub:P},this.defaultRenderer=e.renderer||B,this.prefix="//www.biodalliance.org/release-0.14/",this.sources=[],this.tiers=[],this.tierGroups={},this.searchOnlySources=[],this.searchOnlySourceHolders=[],this.featureListeners=[],this.featureHoverListeners=[],this.viewListeners=[],this.regionSelectListeners=[],this.tierListeners=[],this.tierSelectionListeners=[],this.tierSelectionWrapListeners=[],this.cookieKey="browser",this.chains={},this.pageName="svgHolder",this.zoomFactor=1,this.maxPixelsPerBase=10,this.origin=0,this.targetQuantRes=1,this.featurePanelWidth=750,this.zoomBase=100,this.zoomExpt=30,this.zoomSliderValue=100,this.entryPoints=null,this.currentSeqMax=-1,this.highlights=[],this.selectedTiers=[1],this.maxViewWidth=5e5,this.defaultSubtierMax=100,this.highZoomThreshold=.2,this.mediumZoomThreshold=.01,this.minExtraWidth=100,this.maxExtraWidth=1e3,this.reverseScrolling=!1,this.rulerLocation="center",this.defaultHighlightFill="red",this.defaultHighlightAlpha=.3,this.exportHighlights=!0,this.exportRuler=!0,this.exportBanner=!0,this.exportRegion=!0,this.singleBaseHighlight=!0,this.tierBackgroundColors=["rgb(245,245,245)","white"],this.minTierHeight=20,this.noDefaultLabels=!1,this.availableSources=new c,this.defaultSources=[],this.mappableSources={},this.registry=null,this.noRegistryTabs=!0,this.defaultTrackAdderTab=null,this.hubs=[],this.hubObjects=[],this.sourceCache=new u,this.retina=!0,this.useFetchWorkers=!0,this.maxWorkers=2,this.workerPath="$$worker-all.js",this.resolvers={},this.resolverSeed=1,this.assemblyNamePrimary=!0,this.assemblyNameUcsc=!0,this.defaultSearchRegionPadding=1e4,this.httpCanaryURL="http://www.biodalliance.org/http-canary.txt",this.httpWarningURL="//www.biodalliance.org/https.html",this.initListeners=[],e.baseColors?this.baseColors=e.baseColors:this.baseColors={A:"green",C:"blue",G:"orange",T:"red","-":"hotpink",I:"red"},void 0!==e.viewStart&&"number"!=typeof e.viewStart)throw Error("viewStart must be an integer");if(void 0!==e.viewEnd&&"number"!=typeof e.viewEnd)throw Error("viewEnd must be an integer");if(void 0!==e.offscreenInitWidth&&"number"!=typeof e.offscreenInitWidth)throw Error("offscreenInitWidth must be an integer");for(var t in e)this[t]=e[t];if("string"==typeof e.uiPrefix&&"string"!=typeof e.prefix&&(this.prefix=e.uiPrefix),this.prefix.indexOf("//")<0&&0===this.prefix.indexOf("/")){var i=window.location.hostname;window.location.port&&(i+=":"+window.location.port),this.prefix="//"+i+this.prefix}if(0===this.prefix.indexOf("//")){var r=window.location.protocol;"http:"==r||"https:"==r||(console.log(window.location.protocol),console.log("WARNING: prefix is set to a protocol-relative URL ("+this.prefix+" when loading from a non-HTTP source"),this.prefix="http:"+this.prefix)}if(!this.coordSystem)throw Error("Coordinate system must be configured");if(void 0===this.chr||void 0===this.viewStart||void 0===this.viewEnd)throw Error("Viewed region (chr:start..end) must be defined");var n=this;if("complete"===document.readyState)n.realInit();else{var s=function o(e){window.removeEventListener("load",o,!1),n.realInit()};window.addEventListener("load",s,!1)}}function s(e,t,i){if(i)for(var r=0;r<t.length;++r)t[r].mapping=i;e.set(t)}function o(e,t,i,r){r=r||[];for(var n=e.length-1;n>=0;--n){var s=e[n];if(!s.notSelectable&&s.min()<=t&&s.max()>=t){if(s.minY&&(i<s.minY()||i>s.maxY()))continue;return s.feature?r.push(s.feature):s.group&&r.push(s.group),s.glyphs?o(s.glyphs,t,i,r):s.glyph?o([s.glyph],t,i,r):r}}return r}function a(e,t){var i=this;this.tagSeed=0,this.callbacks={},this.browser=e,this.worker=t,this.worker.onmessage=function(e){var t=e.data;if(t.cmd)if("resolve"==t.cmd){var r=i.browser.resolvers[t.resolver];r?r(t.url).then(function(e){i.worker.postMessage({tag:t.tag,url:e})})["catch"](function(e){console.log(e),i.worker.postMessage({tag:t.tag,err:e.toString()})}):console.log("No resolver "+t.resolver)}else console.log("Bad worker callback "+t.cmd);else{var n=i.callbacks[t.tag];n&&(n(t.result,t.error),delete i.callbacks[t.tag])}}}function l(e){var t=e.resolveURL(e.workerPath);if(0==t.indexOf("//")){var i=window.location.protocol;t="https:"==i?"https:"+t:"http:"+t}var r='importScripts("'+t+"?version="+_+'");',n=new Blob([r],{type:"application/javascript"});return new O(function(t,i){var r=new Worker(URL.createObjectURL(n));r.onmessage=function(i){"init"===i.data.tag&&(console.log("Worker initialized"),t(new a(e,r)))},r.onerror=function(e){i(e.message)}})}function u(){this.sourcesByURI={}}if("undefined"!=typeof e)var h=e("./utils"),c=h.Observed,f=(h.Awaited,h.makeElement),p=h.removeChildren,d=h.miniJSONify,g=h.shallowCopy,v=h.textXHR,y=e("./tier"),m=y.DasTier,b=e("./sha1"),w=b.hex_sha1,x=e("./thub"),S=x.connectTrackHub,_=e("./version"),T=e("./numformats"),C=T.formatQuantLabel,k=T.formatLongInt,L=e("./chainset").Chainset,O=e("es6-promise").Promise,A=e("./sourcecompare"),E=A.sourcesAreEqual,R=A.sourcesAreEqualModuloStyle,M=A.sourceDataURI,B=(A.sourceStyleURI,e("./default-renderer")),I=e("./multi-renderer"),P=e("./sub-renderer"),H=e("./dummy-renderer");n.prototype.resolveURL=function(e){return e.replace("$$",this.prefix)},n.prototype.destroy=function(){if(window.removeEventListener("resize",this.resizeListener,!1),this.fetchWorkers){var e=!0,t=!1,i=void 0;try{for(var r,n=this.fetchWorkers[Symbol.iterator]();!(e=(r=n.next()).done);e=!0){var s=r.value;s.terminate()}}catch(o){t=!0,i=o}finally{try{!e&&n["return"]&&n["return"]()}finally{if(t)throw i}}}},n.prototype.realInit=function(){var e=this,t=this;if(this.wasInitialized)return void console.log("Attemping to call realInit on an already-initialized Dalliance instance");if(this.wasInitialized=!0,"undefined"!=typeof navigator){var i=navigator.userAgent||"dummy";i.indexOf("Trident")>=0&&i.indexOf("rv:11")>=0&&(this.disablePinning=!0)}this.defaultChr=this.chr,this.defaultStart=this.viewStart,this.defaultEnd=this.viewEnd,this.defaultSources=[];for(var r=0;r<this.sources.length;++r){var n=this.sources[r];n&&this.defaultSources.push(n)}if(this.restoreStatus&&(this.statusRestored=this.restoreStatus()),this.injectionPoint&&this.injectionPoint instanceof Element)this.browserHolderHolder=this.injectionPoint;else if(this.injectionPoint){if(this.browserHolderHolder=document.getElementById(this.injectionPoint),!this.browserHolderHolder)throw Error("injectionPoint must point to a valid DOM element of element ID")}else if(this.browserHolderHolder=document.getElementById(this.pageName),!this.browserHolderHolder)throw Error("pageName must be a valid element ID (or use the injectionPoint option instead)");this.browserHolderHolder.classList.add("dalliance-injection-point"),this.browserHolder=f("div",null,{className:"dalliance dalliance-root",tabIndex:-1}),this.maxHeight?this.browserHolder.style.maxHeight=this.maxHeight+"px":void 0!=this.maxHeight&&(this.browserHolder.style.maxHeight=null),p(this.browserHolderHolder),this.browserHolderHolder.appendChild(this.browserHolder),this.svgHolder=f("div",null,{className:"main-holder"}),this.initUI(this.browserHolder,this.svgHolder),this.pinnedTierHolder=f("div",null,{className:"tier-holder tier-holder-pinned"}),this.tierHolder=f("div",this.makeLoader(24),{className:"tier-holder tier-holder-rest"}),this.locSingleBase=f("span","",{className:"loc-single-base"});var s=f("div",this.locSingleBase,{className:"loc-single-base-holder"});this.addViewListener(function(t,i,r,n,s,o,a){var l=Math.round((a+o)/2);e.locSingleBase.appendChild(document.createTextNode(t+":"+k(l))),e.locSingleBase.removeChild(e.locSingleBase.firstChild)}),this.disablePinning?this.tierHolderHolder=this.tierHolder:(this.tierHolderHolder=f("div",[s,this.pinnedTierHolder,this.tierHolder],{className:"tier-holder-holder"}),this.svgHolder.appendChild(this.tierHolderHolder)),this.svgHolder.appendChild(this.tierHolderHolder),this.bhtmlRoot=f("div"),this.disablePoweredBy||this.bhtmlRoot.appendChild(f("span",["Powered by ",f("a","Biodalliance",{href:"http://www.biodalliance.org/"})," "+_],{className:"powered-by"})),this.browserHolder.appendChild(this.bhtmlRoot),this.resizeListener=function(e){t.resizeViewer()},this.ruler=f("div",null,{className:"guideline"}),this.ruler2=f("div",null,{className:"single-base-guideline"}),this.tierHolderHolder.appendChild(this.ruler),this.tierHolderHolder.appendChild(this.ruler2),this.chainConfigs=this.chains||{},this.chains={};for(var o in this.chainConfigs){var a=this.chainConfigs[o];a instanceof L&&console.log('WARNING: Should no longer use "new Chainset" in Biodalliance configurations.'),this.chains[o]=new L(a)}var u;if(this.maxWorkers>0){for(var h=[],c=0;c<this.maxWorkers;++c)h.push(l(this));u=O.all(h)}else u=O.resolve([]);this.fetchWorkers=null,this.nextWorker=0,u.then(function(e){console.log("Booted "+e.length+" workers"),t.fetchWorkers=e},function(e){console.log("Failed to boot workers",e)}).then(function(){if(e.offscreenInitWidth||"none"!=window.getComputedStyle(t.browserHolderHolder).display&&t.tierHolder.getBoundingClientRect().width>0)setTimeout(function(){t.realInit2()},1);else var i=setInterval(function(){"none"!=window.getComputedStyle(t.browserHolderHolder).display&&t.tierHolder.getBoundingClientRect().width>0&&(clearInterval(i),t.realInit2())},300)})},n.prototype.realInit2=function(){var e=this,t=this;p(this.tierHolder),p(this.pinnedTierHolder),this.featurePanelWidth=this.tierHolder.getBoundingClientRect().width|t.offscreenInitWidth|0,window.addEventListener("resize",this.resizeListener,!1),this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart),this.zoomMax||(this.zoomMax=this.zoomExpt*Math.log(this.maxViewWidth/this.zoomBase),this.zoomMin=this.zoomExpt*Math.log(this.featurePanelWidth/this.maxPixelsPerBase/this.zoomBase)),this.zoomSliderValue=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase),this.tierHolderHolder.addEventListener("mousewheel",function(e){if(e.stopPropagation(),e.preventDefault(),e.wheelDeltaX){var i=e.wheelDeltaX/5;t.reverseScrolling||(i=-i),t.move(i)}if(e.wheelDeltaY){var i=e.wheelDeltaY;t.reverseScrolling&&(i=-i),t.tierHolder.scrollTop+=i}},!1),this.tierHolderHolder.addEventListener("MozMousePixelScroll",function(e){if(e.stopPropagation(),e.preventDefault(),1==e.axis){if(0!=e.detail){var i=e.detail/4;t.reverseScrolling&&(i=-i),t.move(i)}}else{var i=e.detail;t.reverseScrolling||(i=-i),t.tierHolder.scrollTop+=i}},!1),this.tierHolderHolder.addEventListener("touchstart",function(e){return t.touchStartHandler(e)},!1),this.tierHolderHolder.addEventListener("touchmove",function(e){return t.touchMoveHandler(e)},!1),this.tierHolderHolder.addEventListener("touchend",function(e){return t.touchEndHandler(e)},!1),this.tierHolderHolder.addEventListener("touchcancel",function(e){return t.touchCancelHandler(e)},!1);var i=function(e){if(13==e.keyCode){for(var i=!1,r=0;r<t.tiers.length;++r){var n=t.tiers[r];n.wantedLayoutHeight&&n.wantedLayoutHeight!=n.layoutHeight&&(n.layoutHeight=n.wantedLayoutHeight,n.clipTier(),i=!0)}i&&t.arrangeTiers()}else if(32==e.keyCode||32==e.charCode){if(t.isSnapZooming){t.isSnapZooming=!1;var s=(t.savedZoom||20)+t.zoomMin;t.savedZoom=t.zoomSliderValue-t.zoomMin,t.zoomSliderValue=s,t.zoom(Math.exp(1*s/t.zoomExpt))}else{t.isSnapZooming=!0;var s=(t.savedZoom||0)+t.zoomMin;t.savedZoom=t.zoomSliderValue-t.zoomMin,t.zoomSliderValue=s,t.zoom(Math.exp(1*s/t.zoomExpt))}e.stopPropagation(),e.preventDefault()}else if(85==e.keyCode){if("opts"===t.uiMode){var o=document.getElementById("singleBaseHightlightButton").checked;document.getElementById("singleBaseHightlightButton").checked=!o}t.singleBaseHighlight=!t.singleBaseHighlight,t.positionRuler(),e.stopPropagation(),e.preventDefault()}else if(39==e.keyCode)e.stopPropagation(),e.preventDefault(),t.scrollArrowKey(e,-1);else if(37==e.keyCode)e.stopPropagation(),e.preventDefault(),t.scrollArrowKey(e,1);else if(38==e.keyCode||87==e.keyCode)if(e.stopPropagation(),e.preventDefault(),e.shiftKey){var a=t.getSelectedTier();if(0>a)return;var l=t.tiers[a],u=l.forceHeight||l.subtiers[0].height;u>=40&&l.mergeConfig({height:u-10})}else if(e.ctrlKey||e.metaKey){var a=t.getSelectedTier();if(0>a)return;var l=t.tiers[a];if(l.quantLeapThreshold){var h=l.subtiers[0].height,c=l.subtiers[0].quant;if(!c)return;var f=1*c.min,p=1*c.max,d=(p-f)/h;l.mergeConfig({quantLeapThreshold:f+((0|Math.round((l.quantLeapThreshold-f)/d))+1)*d}),l.notify("Threshold: "+C(l.quantLeapThreshold))}}else if(e.altKey){var g=t.selectedTiers.length;if(0==g)return;for(var a=t.selectedTiers[0],v=!0,y=[],m=0;m<t.selectedTiers.length;++m)y.push(t.tiers[t.selectedTiers[m]]),m>0&&t.selectedTiers[m]-t.selectedTiers[m-1]!=1&&(v=!1);if(v&&0>=a)return;for(var m=t.selectedTiers.length-1;m>=0;--m)t.tiers.splice(t.selectedTiers[m],1);t.selectedTiers.splice(0,g);for(var b=v?a-1:a,m=0;m<y.length;++m)t.tiers.splice(b+m,0,y[m]),t.selectedTiers.push(b+m);t.withPreservedSelection(t._ensureTiersGrouped),t.markSelectedTiers(),t.notifyTierSelection(),t.reorderTiers(),t.notifyTier("selected",a)}else{var a=t.getSelectedTier();if(a>0){t.setSelectedTier(a-1);var w=t.tiers[t.getSelectedTier()],x=w.row.offsetTop,S=x+w.row.offsetHeight;(x<t.tierHolder.scrollTop||S>t.tierHolder.scrollTop+t.tierHolder.offsetHeight)&&(t.tierHolder.scrollTop=x)}else t.notifyTierSelectionWrap(-1)}else if(40==e.keyCode||83==e.keyCode)if(e.stopPropagation(),e.preventDefault(),e.shiftKey){var a=t.getSelectedTier();if(0>a)return;var l=t.tiers[a],u=l.forceHeight||l.subtiers[0].height;l.mergeConfig({height:u+10})}else if(e.ctrlKey||e.metaKey){var a=t.getSelectedTier();if(0>a)return;var l=t.tiers[a];if(l.quantLeapThreshold){var h=l.subtiers[0].height,c=l.subtiers[0].quant;if(!c)return;var f=1*c.min,p=1*c.max,d=(p-f)/h,_=0|Math.round((l.quantLeapThreshold-f)/d);_>1&&(l.mergeConfig({quantLeapThreshold:f+(_-1)*d}),l.notify("Threshold: "+C(l.quantLeapThreshold)))}}else if(e.altKey){var g=t.selectedTiers.length;if(0==g)return;for(var a=t.selectedTiers[0],T=0,y=[],m=0;m<t.selectedTiers.length;++m)y.push(t.tiers[t.selectedTiers[m]]),m>0&&(T+=t.selectedTiers[m]-t.selectedTiers[m-1]-1);var v=0==T;if(v&&a+g>=t.tiers.length)return;for(var m=t.selectedTiers.length-1;m>=0;--m)t.tiers.splice(t.selectedTiers[m],1);t.selectedTiers.splice(0,g);for(var b=v?a+1:a+T,m=0;m<y.length;++m)t.tiers.splice(b+m,0,y[m]),t.selectedTiers.push(b+m);t.withPreservedSelection(function(){t._ensureTiersGrouped(!0)}),t.markSelectedTiers(),t.notifyTierSelection(),t.reorderTiers(),t.notifyTier("selected",a)}else{var a=t.getSelectedTier();if(a<t.tiers.length-1){t.setSelectedTier(a+1);var w=t.tiers[t.getSelectedTier()],x=w.row.offsetTop,S=x+w.row.offsetHeight;(x<t.tierHolder.scrollTop||S>t.tierHolder.scrollTop+t.tierHolder.offsetHeight)&&(t.tierHolder.scrollTop=Math.min(x,S-t.tierHolder.offsetHeight))}}else if(187==e.keyCode||61==e.keyCode)e.stopPropagation(),e.preventDefault(),t.zoomStep(-10);else if(189==e.keyCode||173==e.keyCode)e.stopPropagation(),e.preventDefault(),t.zoomStep(10);else if(73==e.keyCode||105==e.keyCode){e.stopPropagation(),e.preventDefault();var a=t.getSelectedTier();if(0>a)return;var n=t.tiers[a];n.infoVisible?(n.infoElement.style.display="none",n.updateHeight(),n.infoVisible=!1):(n.infoElement.style.display="block",n.updateHeight(),n.infoVisible=!0)}else if(84==e.keyCode||116==e.keyCode){var k;if(e.shiftKey){e.stopPropagation(),e.preventDefault();for(var r=0;r<t.tiers.length;++r){var n=t.tiers[r];n.dasSource.collapseSuperGroups&&(void 0===k&&(k=!n.bumped),n.mergeConfig({bumped:k}))}}else if(!e.ctrlKey&&!e.metaKey){e.stopPropagation(),e.preventDefault();var a=t.getSelectedTier();if(0>a)return;var n=t.tiers[a];n.dasSource.collapseSuperGroups&&(void 0===k&&(k=!n.bumped),n.mergeConfig({bumped:k}))}}else if(77==e.keyCode||109==e.keyCode)e.stopPropagation(),e.preventDefault(),(e.ctrlKey||e.metaKey)&&t.selectedTiers.length>1&&t.mergeSelectedTiers();else if(68==e.keyCode||100==e.keyCode){if(e.stopPropagation(),e.preventDefault(),e.ctrlKey||e.metaKey){var a=t.getSelectedTier();if(0>a)return;t.addTier(t.tiers[a].dasSource)}}else if((80==e.keyCode||112==e.keyCode)&&(e.ctrlKey||e.metaKey)){for(var l=[],a=0;a<t.selectedTiers.length;++a)l.push(t.tiers[t.selectedTiers[a]]);for(var r=0;r<l.length;++r)l[r].mergeConfig({pinned:!l[r].pinned})}};this.browserHolder.addEventListener("focus",function(e){t.browserHolder.addEventListener("keydown",i,!1)},!1),this.browserHolder.addEventListener("blur",function(e){t.browserHolder.removeEventListener("keydown",i,!1)},!1),this.hPopupHolder=f("div"),this.hPopupHolder.style["font-family"]="helvetica",this.hPopupHolder.style["font-size"]="12pt",this.hPopupHolder.classList.add("dalliance"),document.body.appendChild(this.hPopupHolder);for(var r=0;r<this.sources.length;++r){var n=this.sources[r];if(n){var s={};this.restoredConfigs&&(s=this.restoredConfigs[r]),n.disabled||this.makeTier(n,s).then(function(e){t.refreshTier(e)})}}var o=!0,a=!1,l=void 0;try{for(var u,h=this.searchOnlySources[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var c=u.value;if(!c.disabled){var d=this.createSources(c),g=d.features;g&&this.searchOnlySourceHolders.push({dasSource:c,featureSource:g})}}}catch(v){a=!0,l=v}finally{try{!o&&h["return"]&&h["return"]()}finally{if(a)throw l}}this.onFirstRender&&O.all(this.tiers.map(function(e){return e.firstRenderPromise})).then(function(){return e.onFirstRender()})["catch"](function(e){return console.log(e)}),t._ensureTiersGrouped(),t.arrangeTiers(),t.reorderTiers();var y=this.getSequenceSource();y&&y.getSeqInfo(this.chr,function(e){e?t.currentSeqMax=e.length:t.currentSeqMax=-1}),this.queryRegistry();for(var m in this.chains)this.queryRegistry(m,!0);if(this.hubs)for(var b=0;b<this.hubs.length;++b){var w=this.hubs[b];"string"==typeof w&&(w={url:w}),function(e){S(e.url,function(i,r){if(r)console.log(r);else{var n;n=e.genome?i.genomes[e.genome]:i.genomes[t.coordSystem.ucscName],n&&(e.mapping&&(n.mapping=e.mapping),e.label&&(n.hub.altLabel=e.label),t.hubObjects.push(n))}},e)}(w)}this.fullScreen&&this.setFullScreenHeight(),!this.statusRestored&&this.storeStatus&&this.storeStatus(),t.setLocation(this.chr,this.viewStart,this.viewEnd,function(){t.setSelectedTier(1);for(var e=0;e<t.initListeners.length;++e)try{t.initListeners[e].call(t)}catch(i){console.log(i)}})},n.prototype.touchStartHandler=function(e){if(this.touchOriginX=e.touches[0].pageX,this.touchOriginY=e.touches[0].pageY,2==e.touches.length){var t=Math.abs(e.touches[0].pageX-e.touches[1].pageX);this.zooming=!0,this.zoomLastSep=this.zoomInitialSep=t,this.zoomInitialScale=this.scale}},n.prototype.touchMoveHandler=function(e){if(e.stopPropagation(),e.preventDefault(),1==e.touches.length){var t=e.touches[0].pageX,i=e.touches[0].pageY;this.touchOriginX&&t!=this.touchOriginX&&this.move(t-this.touchOriginX),this.touchOriginY&&i!=this.touchOriginY&&(this.tierHolder.scrollTop-=i-this.touchOriginY),this.touchOriginX=t,this.touchOriginY=i}else if(this.zooming&&2==e.touches.length){var r=Math.abs(e.touches[0].pageX-e.touches[1].pageX);if(r!=this.zoomLastSep){var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=this.viewStart+n/this.scale|0;this.scale=this.zoomInitialScale*(r/this.zoomInitialSep),this.viewStart=s-n/this.scale|0;for(var o=0;o<this.tiers.length;++o)tiers[o].getRenderer().drawTier(tiers[o])}this.zoomLastSep=r}},n.prototype.touchEndHandler=function(e){},n.prototype.touchCancelHandler=function(e){},n.prototype.makeTier=function(e,t){try{return this.realMakeTier(e,t)}catch(i){console.log("Error initializing",e),console.log(i.stack||i)}},n.prototype.realMakeTier=function(e,t){var i=this,r=null;this.tierBackgroundColors&&(r=this.tierBackgroundColors[this.tiers.length%this.tierBackgroundColors.length]);var n=new m(this,e,t,r);n.oorigin=this.viewStart;var s,a,l,u=!1,h=function(e,t){var r=n.subtiers;if(r){var s=0;for(t-=n.padding;s<r.length&&t>r[s].height&&s<r.length-1;)t=t-r[s].height-n.padding,++s;if(!(s>=r.length)){var a=r[s].glyphs,l=((i.viewStart+i.viewEnd)/2,(n.glyphCacheOrigin-i.viewStart)*i.scale);return e-=l,o(a,e,t)}}},c=function(e){e.preventDefault(),e.stopPropagation();var t=e.clientX;t!=a&&(i.move(t-a,!0),a=t),i.isDragging=!0},f=function _(e){window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",_,!0),i.move(e.clientX-a)};n.viewport.addEventListener("mousedown",function(e){i.browserHolder.focus(),e.preventDefault();var t=(n.row.getBoundingClientRect(),e.clientX);e.clientY;window.addEventListener("mousemove",c,!0),window.addEventListener("mouseup",f,!0),s=a=t,i.isDragging=!1},!1),n.viewport.addEventListener("mousemove",function(e){var t=n.row.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top,o=h(r,s);o&&o.length>0?n.row.style.cursor="pointer":n.row.style.cursor="default",l&&clearTimeout(l),u||(l=setTimeout(function(){var t=h(r,s);t&&t.length>0&&i.notifyFeatureHover(e,t[t.length-1],t,n)},1e3))});var p=null;n.viewport.addEventListener("mouseup",function(e){var t=n.row.getBoundingClientRect(),r=e.clientX-t.left,o=e.clientY-t.top,a=h(r,o);if(a&&a.length>0&&!i.isDragging&&(p?(clearTimeout(p),p=null,i.featureDoubleClick(a,r,o)):p=setTimeout(function(){p=null,i.notifyFeature(e,a[a.length-1],a,n)},500)),i.isDragging&&r!=s&&n.sequenceSource){var l,u,c=i.viewStart+r/i.scale,f=i.viewStart+s/i.scale;f>c?(l=0|c,u=0|f):(l=0|f,u=0|c),i.notifyRegionSelect(i.chr,l,u)}i.isDragging=!1},!1),n.viewport.addEventListener("mouseout",function(e){u=!1}),n.removeButton.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();for(var t=0;t<i.tiers.length;++t)if(i.tiers[t]===n){i.removeTier({index:t});break}},!1),n.nameButton.addEventListener("click",function(e){if(e.stopPropagation(),e.preventDefault(),e.shiftKey){for(var t=-1,r=0;r<i.tiers.length;++r)if(i.tiers[r]===n){t=r;break}if(t>=0){var s=i.selectedTiers.indexOf(t);s>=0?i.selectedTiers.splice(s,1):(i.selectedTiers.push(t),i.selectedTiers.sort()),i.markSelectedTiers(),i.notifyTierSelection(),i.selectedTiers.length>0?i.browserHolder.focus():i.notifyTierSelectionWrap(-1)}}else{for(var r=0;r<i.tiers.length;++r)if(i.tiers[r]===n&&(i.browserHolder.focus(),1!=i.selectedTiers.length||i.selectedTiers[0]!=r))return void i.setSelectedTier(r);n.infoVisible?(n.infoElement.style.display="none",n.updateHeight(),n.infoVisible=!1):(n.infoElement.style.display="block",n.updateHeight(),n.infoVisible=!0)}},!1),n.bumpButton.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t,i=n;i.dasSource.collapseSuperGroups&&(void 0===t&&(t=!i.bumped),i.mergeConfig({bumped:t}))},!1);var d,g,v,y,b,w=!1,x=function(e){var t=n.label;if(e.stopPropagation(),e.preventDefault(),!d){g=n.pinned?i.pinnedTierHolder:i.tierHolder,v=g.scrollHeight-g.offsetHeight,d=t.cloneNode(!0),d.style.cursor="pointer",g.appendChild(d),t.style.visibility="hidden";for(var r=0;r<i.tiers.length;++r)if(i.tiers[r]===n){y=r;break}b=e.clientY}var s=g.getBoundingClientRect();d.style.left=t.getBoundingClientRect().left-s.left+"px",d.style.top=e.clientY-s.top+g.scrollTop-10+"px";for(var o=e.clientY-s.top+g.scrollTop,r=0;r<i.tiers.length;++r){var a=i.tiers[r];if(!(a.pinned^n.pinned)){var l=a.row.getBoundingClientRect();if(o-=l.bottom-l.top,0>o){if(y>r&&e.clientY<b||r>y&&e.clientY>b){i.withPreservedSelection(function(){i.tiers.splice(y,1),i.tiers.splice(r,0,n),i._ensureTiersGrouped(r>y)});for(var u=0;u<i.tiers.length;++u)i.tiers[u]==n&&(y=u);b=e.clientY,i.reorderTiers(),g.appendChild(d),w=!0}break}}}d.offsetTop<g.scrollTop?g.scrollTop-=g.scrollTop-d.offsetTop:d.offsetTop+d.offsetHeight>g.scrollTop+g.offsetHeight&&(g.scrollTop=Math.min(g.scrollTop+(d.offsetTop+d.offsetHeight)-(g.scrollTop+g.offsetHeight),v))},S=function T(e){var t=n.label;if(e.stopPropagation(),e.preventDefault(),d&&(d.style.cursor="auto",g.removeChild(d),d=null,t.style.visibility="visible"),document.removeEventListener("mousemove",x,!1),document.removeEventListener("mouseup",T,!1),w){for(var r=0;r<i.tiers.length;++r)if(i.tiers[r]==n){i.setSelectedTier(r);break}i.notifyTier("reordered",n)}};return n.label.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),w=!1,document.addEventListener("mousemove",x,!1),document.addEventListener("mouseup",S,!1)},!1),this.tiers.push(n),n.init().then(function(e){return e.currentlyHeight=50,i.updateHeight(),e.updateLabel(),i.withPreservedSelection(i._ensureTiersGrouped),e._updateFromConfig(),i.reorderTiers(),e})},n.prototype.reorderTiers=function(){p(this.tierHolder),p(this.pinnedTierHolder),this.disablePinning&&(this.tierHolder.appendChild(this.ruler),this.tierHolder.appendChild(this.ruler2));for(var e=!1,t=[],i=[],r=0;r<this.tiers.length;++r){var n=this.tiers[r],s=-1===["sub","dummy"].indexOf(this.tiers[r].dasSource.renderer);n.pinned&&!this.disablePinning?(t.push(n),s&&this.pinnedTierHolder.appendChild(this.tiers[r].row),e=!0):(i.push(n),s&&this.tierHolder.appendChild(this.tiers[r].row))}this.withPreservedSelection(function(){this.tiers.splice(0,this.tiers.length);for(var e=0;e<t.length;++e)this.tiers.push(t[e]);
for(var e=0;e<i.length;++e)this.tiers.push(i[e])}),e?this.pinnedTierHolder.classList.add("tier-holder-pinned-full"):this.pinnedTierHolder.classList.remove("tier-holder-pinned-full"),this.arrangeTiers()},n.prototype.withPreservedSelection=function(e){for(var t=[],i=0;i<this.selectedTiers.length;++i)t.push(this.tiers[this.selectedTiers[i]]);e.call(this),this.selectedTiers=[];for(var r=0;r<this.tiers.length;++r)t.indexOf(this.tiers[r])>=0&&this.selectedTiers.push(r)},n.prototype.refreshTier=function(e,t){var i=this.getTierRenderer(e);if("multi"===e.dasSource.renderer)i.drawTier(e);else{var r=t||i.renderTier;this.knownSpace&&this.knownSpace.invalidate(e,r)}},n.prototype.getTierRenderer=function(e){var t=e.dasSource.renderer||this.defaultRenderer;return"string"==typeof t?this.renderers[t]:"function"==typeof t.renderTier&&"function"==typeof t.drawTier?t:void console.log("Tier doesn't have a renderer")},n.prototype._ensureTiersGrouped=function(e){for(var t={},i=0;i<this.tiers.length;++i){var r=this.tiers[i];r.dasSource.tierGroup&&pusho(t,r.dasSource.tierGroup,r)}var n=[];e&&this.tiers.reverse();for(var i=0;i<this.tiers.length;++i){var r=this.tiers[i];if(r.dasSource.tierGroup){var s=t[r.dasSource.tierGroup];if(s){e&&s.reverse();for(var o=0;o<s.length;++o)n.push(s[o]);t[r.dasSource.tierGroup]=null}}else n.push(r)}e&&n.reverse(),this.tiers.splice(0,this.tiers.length);for(var o=0;o<n.length;++o)this.tiers.push(n[o])},n.prototype.arrangeTiers=function(){for(var e=[],t={},i=0;i<this.tiers.length;++i){var r=this.tiers[i];r.pinned&&(e.push(r),r.dasSource.tierGroup&&pusho(t,r.dasSource.tierGroup,r))}for(var i=0;i<this.tiers.length;++i){var r=this.tiers[i];r.pinned||(e.push(r),r.dasSource.tierGroup&&pusho(t,r.dasSource.tierGroup,r))}for(var n in t){var s=t[n],o=this.tierGroups[n];o||(o={element:f("div",f("span",n,{className:"tier-group-label"}),{className:"tier-group"})},this.tierGroups[n]=o),o.element.parentNode&&o.element.parentNode.removeChild(o.element);for(var a=s[0].pinned?this.pinnedTierHolder:this.tierHolder,l=1e7,u=0,i=0;i<s.length;++i){var h=s[i].row;l=Math.min(l,h.offsetTop),u=Math.max(u,h.offsetTop+h.offsetHeight)}o.element.style.top=l+"px",o.element.style.left="0px",o.element.style.height=u-l+"px",a.appendChild(o.element)}if(this.tierBackgroundColors)for(var i=0;i<e.length;++i){var r=e[i];r.setBackground(this.tierBackgroundColors[i%this.tierBackgroundColors.length]),r.dasSource.tierGroup?r.label.style.left="18px":r.label.style.left="2px",r.background=this.tierBackgroundColors[i%this.tierBackgroundColors.length]}},n.prototype.refresh=function(){this.retrieveTierData(this.tiers),this.drawOverlays(),this.positionRuler()};if(n.prototype.retrieveTierData=function(e){this.notifyLocation();var t=(this.viewEnd-this.viewStart+1,this.minExtraWidth/this.scale|0),i=this.maxExtraWidth/this.scale|0,r=(this.viewStart+this.viewEnd)/2,n=r-this.origin;this.origin=r,this.scaleAtLastRedraw=this.scale;for(var s=0;s<e.length;++s){var o=n;e[s].originHaxx&&(o+=e[s].originHaxx),e[s].originHaxx=o}var a=this.targetQuantRes/this.scale,l=Math.max(1,(0|this.viewStart)-t),u=Math.min((0|this.viewEnd)+t,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9),h=Math.max(1,(0|this.viewStart)-i),c=Math.min((0|this.viewEnd)+i,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9);if(!this.knownSpace||this.knownSpace.chr!==this.chr){var f=this.getSequenceSource();this.knownSpace&&this.knownSpace.cancel(),this.knownSpace=new q(this.tiers,this.chr,h,c,a,f)}var p=this.knownSpace.bestCacheOverlapping(this.chr,l,u);p&&p.min<=l&&p.max>=u?(this.drawnStart=Math.max(p.min,h),this.drawnEnd=Math.min(p.max,c)):(this.drawnStart=h,this.drawnEnd=c),this.knownSpace.retrieveFeatures(e,this.chr,this.drawnStart,this.drawnEnd,a)},n.prototype.queryRegistry=function(e,t){if(this.registry){var i,r,n=this;e?(i=this.chains[e].coords,n.mappableSources[e]||(n.mappableSources[e]=new c),r=n.mappableSources[e]):(i=this.coordSystem,r=this.availableSources);var o=w(d(i));if(t){var a=localStorage["dalliance.registry."+o+".last_queried"];if(a)try{s(r,JSON.parse(localStorage["dalliance.registry."+o+".sources"]),e);var l=(0|Date.now())-(0|a);if(432e5>l)return}catch(u){console.log("Bad registry cache: "+u)}}var h=this.registry;if(0==h.indexOf("//")){var f=window.location.protocol;"https:"!=f&&"http:"!=f&&(h="http:"+h)}new U(h).sources(function(t){for(var n=[],a=0;a<t.length;++a){var l=t[a];if(l.coords&&0!=l.coords.length){var u=l.coords[0];u.taxon==i.taxon&&u.auth==i.auth&&u.version==i.version&&n.push(l)}}localStorage["dalliance.registry."+o+".sources"]=JSON.stringify(n),localStorage["dalliance.registry."+o+".last_queried"]=""+Date.now(),s(r,n,e)},function(e){},i)}},n.prototype.move=function(e,t){var i=this.viewEnd-this.viewStart,r=this.viewStart-1*e/this.scale,n=r+i;t||(this.currentSeqMax>0&&n>this.currentSeqMax&&(n=this.currentSeqMax,r=this.viewEnd-i),1>r&&(r=1,n=r+i)),this.setLocation(null,r,n,null,t)},n.prototype.zoomStep=function(e){var t=1*this.zoomSliderValue,i=t+e;i<this.zoomMin&&(i=this.zoomMin),i>this.zoomMax&&(i=this.zoomMax),i!=t&&(this.zoomSliderValue=i,this.zoom(Math.exp(1*i/this.zoomExpt)))},n.prototype.zoom=function(e){this.zoomFactor=e;var t=0|Math.round((this.viewStart+this.viewEnd)/2);if(this.viewStart=t-this.zoomBase*this.zoomFactor/2,this.viewEnd=t+this.zoomBase*this.zoomFactor/2,this.currentSeqMax>0&&this.viewEnd>this.currentSeqMax+5){var i=this.viewEnd-this.viewStart+1;this.viewEnd=this.currentSeqMax,this.viewStart=this.viewEnd-i+1}if(this.viewStart<1){var i=this.viewEnd-this.viewStart+1;this.viewStart=1,this.viewEnd=this.viewStart+i-1}this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart);this.viewEnd-this.viewStart+1,this.scale/this.scaleAtLastRedraw;this.notifyLocation(),this.refresh()},n.prototype.spaceCheck=function(e){if(!this.knownSpace||this.knownSpace.chr!==this.chr)return void this.refresh();var t=((this.viewEnd-this.viewStart|0)+1,this.minExtraWidth/this.scale|0);this.maxExtraWidth/this.scale|0;((0|this.drawnStart)>Math.max(1,(0|this.viewStart)-t|0)||(0|this.drawnEnd)<Math.min((0|this.viewEnd)+t,(0|this.currentSeqMax)>0?0|this.currentSeqMax:1e9))&&this.refresh()},n.prototype.resizeViewer=function(e){var t=0|this.tierHolder.getBoundingClientRect().width;if(0!=t){var i=Math.max(this.featurePanelWidth,300);if(this.featurePanelWidth=0|t,i!=this.featurePanelWidth){this.zoomMax=this.zoomExpt*Math.log(this.maxViewWidth/this.zoomBase),this.zoomMin=this.zoomExpt*Math.log(this.featurePanelWidth/this.maxPixelsPerBase/this.zoomBase),this.zoomSliderValue=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase);var r=this.viewEnd-this.viewStart,n=this.viewStart+r*this.featurePanelWidth/i;this.viewEnd=n;var s=this.viewEnd-this.viewStart+1;this.currentSeqMax>0&&this.viewEnd>this.currentSeqMax&&(this.viewEnd=this.currentSeqMax,this.viewStart=this.viewEnd-s+1),this.viewStart<1&&(this.viewStart=1,this.viewEnd=this.viewStart+s-1),this.positionRuler(),e||this.spaceCheck(),this.notifyLocation()}this.fullScreen&&this.setFullScreenHeight()}},n.prototype.setFullScreenHeight=function(){var e=document.body.offsetHeight-this.browserHolder.offsetHeight;this.browserHolder.style.maxHeight=Math.max(300,window.innerHeight-e-20)+"px"},n.prototype.addTier=function(e){var t=this;return e=g(e),e.disabled=!1,this.makeTier(e).then(function(e){return t.refreshTier(e),t.markSelectedTiers(),t.positionRuler(),t.notifyTier("added",e),e})},n.prototype.removeTier=function(e,t){var i=-1;if("undefined"!=typeof e.index&&e.index>=0&&e.index<this.tiers.length)i=e.index;else for(var r=0;r<this.tiers.length;++r){var n=this.tiers[r].dasSource;if(E(e,n)){i=r;break}}if(0>i)throw"Couldn't find requested tier";var s=this.tiers[i];this.tiers.splice(i,1);for(var o=[],a=0;a<this.selectedTiers.length;++a){var l=this.selectedTiers[a];i>l?o.push(l):l>i&&o.push(l-1)}this.selectedTiers=o,this.markSelectedTiers(),s.destroy(),this.knownSpace&&(this.knownSpace.featureCache[s]=null),this.reorderTiers(),this.notifyTier("removed",s)},n.prototype.removeAllTiers=function(){var e=this;this.selectedTiers=[],this.markSelectedTiers(),this.tiers.forEach(function(t){t.destroy(),e.knownSpace&&(e.knownSpace.featureCache[t]=null)}),this.tiers.length=0,this.reorderTiers(),this.notifyTier("removedAll",null)},n.prototype.getSequenceSource=function(){return void 0===this._sequenceSource&&(this._sequenceSource=this._getSequenceSource()),this._sequenceSource},n.prototype._getSequenceSource=function(){for(var e=0;e<this.tiers.length;++e)if(this.tiers[e].sequenceSource)return this.tiers[e].sequenceSource;for(var t=0;t<this.defaultSources.length;++t){var i=this.defaultSources[t];if(i.provides_entrypoints||"sequence"==i.tier_type||i.twoBitURI||i.twoBitBlob)return i.twoBitURI||i.twoBitBlob?new F(i):i.ensemblURI?new G(i):new D(i)}},n.prototype.setLocation=function(e,t,i,r,n){if("number"!=typeof t)throw Error("minimum must be a number (got "+JSON.stringify(t)+")");if("number"!=typeof i)throw Error("maximum must be a number (got "+JSON.stringify(i)+")");if(t>i){var s=t;t=i,i=s}else t===i&&(i+=1);r||(r=function(e){if(e)throw e});var o=this;if((!e||e==this.chr)&&this.currentSeqMax>0)return this._setLocation(null,t,i,null,r,n);var a=this.getSequenceSource();if(!a)return r("Need a sequence source");var l=e||this.chr;a.getSeqInfo(l,function(s){if(s)return o._setLocation(e,t,i,s,r,n);var u;u=0==l.indexOf("chr")?l.substr(3):"chr"+l,a.getSeqInfo(u,function(s){return!s&&e?r("Couldn't find sequence '"+e+"'"):s?o._setLocation(u,t,i,s,r,n):o._setLocation(null,t,i,null,r,n)})})},n.prototype._setLocation=function(e,t,i,r,n,s){var o=!1;e&&(0==e.indexOf("chr")&&(e=e.substring(3)),this.chr!=e&&(o=!0),this.chr=e,this.currentSeqMax=r.length),t=parseFloat(t),i=parseFloat(i);var a=Math.max(10,i-t+1);if(!s){var l=this.currentSeqMax;0>=l&&(l=1e12),1>t&&(t=1,i=t+a-1),i>l&&(i=l,t=Math.max(1,i-a+1))}this.viewStart=t,this.viewEnd=i;var u=Math.max(this.featurePanelWidth||this.offscreenInitWidth,50)/(this.viewEnd-this.viewStart),h=this.scale,c=Math.abs(u-h)>1e-6;this.scale=u;var f,p;if(p=this.zoomSliderValue,this.zoomSliderValue=f=this.zoomExpt*Math.log((this.viewEnd-this.viewStart+1)/this.zoomBase),c||o){for(var d=0;d<this.tiers.length;++d)this.tiers[d].viewportHolder.style.left="5000px",this.tiers[d].overlay.style.left="5000px";if(this.refresh(),this.savedZoom){f-=this.zoomMin,p-=this.zoomMin;var g=f-p,v=f-this.savedZoom;Math.abs(g)>Math.abs(v)&&(this.isSnapZooming=!this.isSnapZooming,this.savedZoom=p)}else this.isSnapZooming=!1,this.savedZoom=null}else for(var d=((this.viewStart+this.viewEnd)/2,0);d<this.tiers.length;++d){var y=(this.viewStart-this.tiers[d].norigin)*this.scale;this.tiers[d].viewportHolder.style.left=""+((0|-y)-1e3)+"px",this.tiers[d].drawOverlay()}return this.notifyLocation(),this.spaceCheck(),this.instrumentActivity&&(this.activityStartTime=0|Date.now()),n()},n.prototype.setCenterLocation=function(e,t){var i=(this.viewEnd-this.viewStart)/2,r=t-i,n=t+i;this.setLocation(e,r,n)},n.prototype.pingActivity=function(){if(this.instrumentActivity&&this.activityStartTime){for(var e=0,t=0;t<this.tiers.length;++t)"none"!==this.tiers[t].loaderButton.style.display&&++e;if(0==e){var i=0|Date.now();console.log("Loading took "+(i-this.activityStartTime)+"ms"),this.activityStartTime=null}}},n.prototype.addInitListener=function(e){this.initListeners.push(e)},n.prototype.addFeatureListener=function(e,t){t=t||{},this.featureListeners.push(e)},n.prototype.removeFeatureListener=function(e,t){var i=arrayIndexOf(this.featureListeners,e);i>=0&&this.featureListeners.splice(i,1)},n.prototype.notifyFeature=function(e,t,i,r){for(var n=0;n<this.featureListeners.length;++n)try{if(this.featureListeners[n](e,t,i,r))return}catch(s){console.log(s.stack)}},n.prototype.addFeatureHoverListener=function(e,t){t=t||{},this.featureHoverListeners.push(e)},n.prototype.removeFeatureHoverListener=function(e,t){var i=arrayIndexOf(this.featureHoverListeners,e);i>=0&&this.featureHoverListeners.splice(i,1)},n.prototype.notifyFeatureHover=function(e,t,i,r){for(var n=0;n<this.featureHoverListeners.length;++n)try{this.featureHoverListeners[n](e,t,i,r)}catch(s){console.log(s.stack)}},n.prototype.addViewListener=function(e,t){t=t||{},this.viewListeners.push(e)},n.prototype.removeViewListener=function(e,t){var i=arrayIndexOf(this.viewListeners,e);i>=0&&this.viewListeners.splice(i,1)},n.prototype.notifyLocation=function(){var e=Math.max(1,0|this.viewStart),t=0|this.viewEnd;this.currentSeqMax>0&&t>this.currentSeqMax&&(t=this.currentSeqMax);for(var i=0;i<this.viewListeners.length;++i)try{this.viewListeners[i](this.chr,e,t,this.zoomSliderValue,{current:this.zoomSliderValue,alternate:this.savedZoom+this.zoomMin||this.zoomMin,isSnapZooming:this.isSnapZooming,min:this.zoomMin,max:this.zoomMax},this.viewStart,this.viewEnd)}catch(r){console.log(r.stack)}},n.prototype.addTierListener=function(e){this.tierListeners.push(e)},n.prototype.removeTierListener=function(e){var t=arrayIndexOf(this.tierListeners,e);t>=0&&this.tierListeners.splice(t,1)},n.prototype.notifyTier=function(e,t){for(var i=0;i<this.tierListeners.length;++i)try{this.tierListeners[i](e,t)}catch(r){console.log(r.stack)}},n.prototype.addRegionSelectListener=function(e){this.regionSelectListeners.push(e)},n.prototype.removeRegionSelectListener=function(e){var t=arrayIndexOf(this.regionSelectListeners,e);t>=0&&this.regionSelectListeners.splice(t,1)},n.prototype.notifyRegionSelect=function(e,t,i){for(var r=0;r<this.regionSelectListeners.length;++r)try{this.regionSelectListeners[r](e,t,i)}catch(n){console.log(n.stack)}},n.prototype.highlightRegion=function(e,t,i){var r=this;if(e==this.chr)return this._highlightRegion(e,t,i);var n=this.getSequenceSource();if(!n)throw"Need a sequence source";n.getSeqInfo(e,function(s){if(s)return r._highlightRegion(e,t,i);var o;o=0==e.indexOf("chr")?e.substr(3):"chr"+e,n.getSeqInfo(o,function(e){return e?r._highlightRegion(o,t,i):void 0})})},n.prototype._highlightRegion=function(e,t,i){for(var n=0;n<this.highlights.length;++n){var s=this.highlights[n];if(s.chr==e&&s.min==t&&s.max==i)return}this.highlights.push(new r(e,t,i));var o=this.viewStart-1e3/this.scale,a=this.viewEnd+1e3/this.scale;(e==this.chr||e=="chr"+this.chr)&&a>t&&i>o&&this.drawOverlays(),this.notifyLocation()},n.prototype.clearHighlights=function(){this.highlights=[],this.drawOverlays(),this.notifyLocation()},n.prototype.drawOverlays=function(){for(var e=0;e<this.tiers.length;++e)this.tiers[e].drawOverlay()},n.prototype.featuresInRegion=function(e,t,i){var r=[];if(e!==this.chr)return[];for(var n=0;n<this.tiers.length;++n)for(var s=this.tiers[n].currentFeatures||[],o=0;o<s.length;++o){var a=s[o];a.min<=i&&a.max>=t&&r.push(a)}return r},n.prototype.getSelectedTier=function(){return this.selectedTiers.length>0?this.selectedTiers[0]:-1},n.prototype.setSelectedTier=function(e){null==e?this.selectedTiers=[]:this.selectedTiers=[e],this.markSelectedTiers(),this.notifyTierSelection()},n.prototype.markSelectedTiers=function(){for(var e=0;e<this.tiers.length;++e){var t=this.tiers[e].nameButton;this.selectedTiers.indexOf(e)>=0?t.classList.add("active"):t.classList.remove("active")}if(this.selectedTiers.length>0){var i=this.browserHolder.offsetTop+this.browserHolder.offsetHeight/2;i>document.body.scrollTop&&i+100<document.body.scrollTop+window.innerHeight&&this.browserHolder.focus()}},n.prototype.addTierSelectionListener=function(e){this.tierSelectionListeners.push(e)},n.prototype.removeTierSelectionListener=function(e){var t=arrayIndexOf(this.tierSelectionListeners,e);t>=0&&this.tierSelectionListeners.splice(t,1)},n.prototype.notifyTierSelection=function(){for(var e=0;e<this.tierSelectionListeners.length;++e)try{this.tierSelectionListeners[e](this.selectedTiers)}catch(t){console.log(t.stack)}},n.prototype.addTierSelectionWrapListener=function(e){this.tierSelectionWrapListeners.push(e)},n.prototype.removeTierSelectionWrapListener=function(e){var t=arrayIndexOf(this.tierSelectionWrapListeners,e);t>=0&&this.tierSelectionWrapListeners.splice(t,1)},n.prototype.notifyTierSelectionWrap=function(e){for(var t=0;t<this.tierSelectionWrapListeners.length;++t)try{this.tierSelectionWrapListeners[t](e)}catch(i){console.log(i.stack)}},n.prototype.positionRuler=function(){var e="none",t="",i="";if("center"==this.rulerLocation?(e="block",t=""+(this.featurePanelWidth/2|0)+"px"):"left"==this.rulerLocation?(e="block",t="0px"):"right"==this.rulerLocation?(e="block",i="0px"):e="none",this.ruler.style.display=e,this.ruler.style.left=t,this.ruler.style.right=i,this.singleBaseHighlight){this.ruler2.style.display="block",this.ruler2.style.borderWidth="1px",this.scale<1?(this.ruler2.style.width="0px",this.ruler2.style.borderRightWidth="0px"):(this.ruler2.style.width=this.scale+"px",this.ruler2.style.borderRightWidth="1px"),this.locSingleBase.style.visibility="visible";var r=this.featurePanelWidth/2-this.locSingleBase.offsetWidth/2+this.ruler2.offsetWidth/2;this.locSingleBase.style.left=""+(0|r)+"px"}else this.locSingleBase.style.visibility="hidden",this.ruler2.style.width="1px",this.ruler2.style.borderWidth="0px",this.ruler2.style.display="center"==this.rulerLocation?"none":"block";this.ruler2.style.left=""+(this.featurePanelWidth/2|0)+"px";for(var n=0;n<this.tiers.length;++n){var s,o=this.tiers[n],a=o.quantOverlay;o.subtiers&&o.subtiers.length>0&&(s=o.subtiers[0].quant),a&&(a.style.display=s?e:"none",a.style.left=t,a.style.right=i)}},n.prototype.featureDoubleClick=function(e,t,i){if(e&&0!=e.length){var r=e[e.length-1];if(r.min&&r.max){var n=((0|r.min)-(0|this.viewStart))*this.scale,s=(r.max-r.min+1)*this.scale,o=((0|r.min)+(0|r.max))/2;if(s>10){var a=1*(t-n)/s;.3>a?o=0|r.min:a>.7&&(o=(0|r.max)+1)}var l=this.viewEnd-this.viewStart;this.setLocation(null,o-l/2,o+l/2)}}},n.prototype.zoomForScale=function(e){var t;return t=e>this.highZoomThreshold?"high":e>this.mediumZoomThreshold?"medium":"low"},n.prototype.zoomForCurrentScale=function(){return this.zoomForScale(this.scale)},n.prototype.updateHeight=function(){for(var e=0,t=0;t<this.tiers.length;++t)e+=this.tiers[t].currentHeight||30;this.ruler.style.height=""+e+"px",this.ruler2.style.height=""+e+"px",this.browserHolder.style.display="block",this.browserHolder.style.display="-webkit-flex",this.browserHolder.style.display="flex"},n.prototype.scrollArrowKey=function(e,t){if(this.reverseKeyScrolling&&(t=-t),e.ctrlKey||e.metaKey){var i=!1;e.shiftKey&&(i=!0),this.leap(t,i)}else if(this.scale>1){var r=(this.viewStart+this.viewEnd)/2,n=r-Math.round(r),s=1;e.shiftKey&&(s*=10),t>0?(s=-s,s-=n,n>0&&(s+=1)):(s-=n,0>n&&(s-=1)),this.setLocation(null,this.viewStart+s,this.viewEnd+s)}else this.move(e.shiftKey?100*t:25*t)},n.prototype.leap=function(e,t){var i=this,r=(i.viewStart+i.viewEnd+1)/2|0;e>0&&i.viewStart<=1?r-=1e8:0>e&&i.viewEnd>=i.currentSeqMax&&(r+=1e8);var n=i.getSelectedTier();if(!(0>n)){var s=i.tiers[n];s&&(s.featureSource&&this.sourceAdapterIsCapable(s.featureSource,"quantLeap")&&"number"==typeof s.quantLeapThreshold||s.featureSource&&this.sourceAdapterIsCapable(s.featureSource,"leap"))?s.findNextFeature(i.chr,r,-e,t,function(n){if(n){var s=n.min,o=n.max;t&&(e>0?s>r+1?o=s:(o++,s=o):r-1>o?(o++,s=o):o=s);var a=i.viewEnd-i.viewStart+1;parseFloat(a/2)==parseInt(a/2)&&a--;var l=(s+o-a)/2+1,u=l+a-1;i.setLocation(n.segment,l,u)}else alert("no next feature")}):this.move(100*e)}},n.prototype.nameForCoordSystem=function(e){var t=null,i=null;return this.assemblyNamePrimary&&(t=""+e.auth,"undefined"!=typeof e.version&&(t+=e.version)),this.assemblyNameUcsc&&(i=e.ucscName),null!=t&&null!=i?t+"/"+i:t||i||"unknown"},n.prototype.makeLoader=function(e){e=e||16;var t=window.devicePixelRatio>1;return 20>e?f("img",null,{src:this.resolveURL("$$img/spinner_"+(t?16:32)+".gif"),width:"16",height:"16"}):f("img",null,{src:this.resolveURL("$$img/spinner_"+(t?24:48)+".gif"),width:"24",height:"24"})},n.prototype.canFetchPlainHTTP=function(){var e=this;if(!this._plainHTTPPromise){var t=this.getWorker();t?this._plainHTTPPromise=new O(function(i,r){t.postCommand({command:"textxhr",uri:e.httpCanaryURL},function(e,t){i(e?!0:!1)})}):this._plainHTTPPromise=new O(function(t,i){v(e.httpCanaryURL,function(e,i){t(e?!0:!1)},{timeout:2e3})})}return this._plainHTTPPromise},n.prototype.getWorker=function(){return this.useFetchWorkers&&this.fetchWorkers&&0!=this.fetchWorkers.length?(this.nextWorker>=this.fetchWorkers.length&&(this.nextWorker=0),this.fetchWorkers[this.nextWorker++]):null},n.prototype.registerResolver=function(e){var t="res"+ ++this.resolverSeed;return this.resolvers[t]=e,t},a.prototype.postCommand=function(e,t,i){var r="x"+ ++this.tagSeed;e.tag=r,this.callbacks[r]=t,this.worker.postMessage(e,i)},a.prototype.terminate=function(){this.worker.terminate()},"undefined"!=typeof t){t.exports={Browser:n},e("./browser-ui"),e("./track-adder"),e("./feature-popup"),e("./tier-actions"),e("./domui"),e("./search");var N=e("./sourceadapters"),F=N.TwoBitSequenceSource,G=N.EnsemblSequenceSource,D=N.DASSequenceSource,q=e("./kspace").KnownSpace,U=e("./das").DASRegistry}u.prototype.get=function(e){var t=this.sourcesByURI[M(e)];if(t)for(var i=0;i<t.configs.length;++i)if(R(t.configs[i],e))return t.sources[i]},u.prototype.put=function(e,t){var i=M(e),r=this.sourcesByURI[i];r||(r={configs:[],sources:[]},this.sourcesByURI[i]=r),r.configs.push(e),r.sources.push(t)}},{"./browser-ui":5,"./chainset":7,"./das":10,"./default-renderer":11,"./domui":12,"./dummy-renderer":13,"./feature-popup":21,"./kspace":25,"./multi-renderer":28,"./numformats":29,"./search":34,"./sha1":37,"./sourceadapters":38,"./sourcecompare":39,"./sub-renderer":42,"./thub":48,"./tier":51,"./tier-actions":49,"./track-adder":52,"./utils":55,"./version":57,"es6-promise":59}],7:[function(e,t,i){"use strict";function r(e,t,i,r){"string"==typeof e?(this.uri=e,this.srcTag=t,this.destTag=i,this.coords=r):(this.uri=e.uri,this.srcTag=e.srcTag,this.destTag=e.destTag,this.coords=g(e.coords),this.type=e.type,this.credentials=e.credentials),this.chainsBySrc={},this.chainsByDest={},this.postFetchQueues={},this.fetchedTiles={},this.granularity=1e6,"bigbed"==this.type?this.chainFetcher=new s(this.uri,this.credentials):"alias"==this.type?this.chainFetcher=new u(e):this.chainFetcher=new n(this.uri,this.srcTag,this.destTag)}function n(e,t,i){this.source=new c(e),this.srcTag=t,this.destTag=i}function s(e,t){var i=this;this.uri=e,this.credentials=t,this.bwg=new x(function(e,t){w(new m(i.uri,{credentials:i.credentials,resolver:i.resolver}),function(i,r){i?e(i):t(r)})}),this.bwg.then(function(e,t){t&&console.log(t)})}function o(e){return parseInt(e)}function a(e){return 0==e.indexOf("chr")?e.substr(3):e}function l(e){for(var t={srcChr:a(e.srcChrom),srcMin:parseInt(e.srcStart),srcMax:parseInt(e.srcEnd),srcOri:e.srcOri,destChr:a(e.segment),destMin:e.min-1,destMax:e.max,destOri:e.ori,blocks:[]},i=e.srcStarts.split(",").map(o),r=e.destStarts.split(",").map(o),n=e.blockLens.split(",").map(o),s=0;s<i.length;++s)t.blocks.push([i[s],r[s],n[s]]);return t}function u(e){this.conf=e,this.forwardAliases={};for(var t=e.sequenceAliases||[],i=0;i<t.length;++i){var r=t[i];if(!(r.length<2)){for(var n=[],s=0;s<r.length-1;++s)n.push(r[s]);this.forwardAliases[r[r.length-1]]=n}}}if("undefined"!=typeof e)var h=e("./das"),c=h.DASSource,f=h.DASSegment,p=e("./utils"),d=p.pusho,g=p.shallowCopy,v=e("./cigar").parseCigar,y=e("./bin"),m=y.URLFetchable,b=e("./bigwig"),w=b.makeBwg,x=e("es6-promise").Promise;r.prototype.exportConfig=function(){return{uri:this.uri,srcTag:this.srcTag,destTag:this.destTag,coords:this.coords,type:this.type,credentials:this.credentials}},r.prototype.mapPoint=function(e,t){for(var i=this.chainsBySrc[e]||[],r=0;r<i.length;++r){var n=i[r];if(t>=n.srcMin&&t<=n.srcMax){var s;s="-"==n.srcOri?n.srcMax-t:t-n.srcMin;for(var o=n.blocks,a=0;a<o.length;++a){var l=o[a],u=l[0],h=l[1],c=l[2];if(s>=u&&u+c>=s){var f,p=s-u;return f="-"==n.destOri?n.destMax-h-p:p+h+n.destMin,{seq:n.destChr,pos:f,flipped:n.srcOri!=n.destOri}}}}}return null},r.prototype.mapSegment=function(e,t,i){for(var r=this.chainsBySrc[e]||[],n=[],s=0;s<r.length;++s){var o=r[s];if(i>=o.srcMin&&t<=o.srcMax){var a,l;"-"==o.srcOri?(a=o.srcMax-i,l=o.srcMax-t):(a=t-o.srcMin,l=i-o.srcMin);for(var u=o.blocks,h=0;h<u.length;++h){var c=u[h],f=c[0],p=c[1],d=c[2];if(l>=f&&f+d>=a){var g={segment:o.destChr,flipped:"-"==o.srcOri^"-"==o.destOri};"-"==o.destOri?(a>=f?g.max=o.destMax-p-a+f:(g.max=o.destMax-p,g.partialMax=f-a),f+d>=l?g.min=o.destMax-p-l+f:(g.min=o.destMax-p-d,g.partialMin=l-f-d)):(a>=f?g.min=o.destMin+p+a-f:(g.min=o.destMin+p,g.partialMin=f-a),f+d>=l?g.max=o.destMin+p+l-f:(g.max=o.destMin+p+d,g.partialMax=l-f-d)),n.push(g)}}}}return n},r.prototype.unmapPoint=function(e,t){for(var i=this.chainsByDest[e]||[],r=0;r<i.length;++r){var n=i[r];if(t>=n.destMin&&t<=n.destMax){var s;s="-"==n.srcOri?n.destMax-t:t-n.destMin;for(var o=n.blocks,a=0;a<o.length;++a){var l=o[a],u=l[0],h=l[1],c=l[2];if(s>=h&&h+c>=s){var f,p=s-h,f=p+u+n.srcMin;return f="-"==n.destOri?n.srcMax-u-p:p+u+n.srcMin,{seq:n.srcChr,pos:f,flipped:n.srcOri!=n.destOri}}}}}return null},r.prototype.sourceBlocksForRange=function(e,t,i,r){for(var n=1,s=2,o=this,a=t/this.granularity|0,l=i/this.granularity|0,u=!1,h=!1,c=a;l>=c;++c){var p=e+"_"+c;this.fetchedTiles[p]!=s&&(u=!0,this.fetchedTiles[p]!=n&&(this.fetchedTiles[p]=n,h=!0))}if(u)this.postFetchQueues[e]||this.chainFetcher.fetchChains(e,a*this.granularity,(l+1)*this.granularity-1).then(function(t){o.chainsByDest||(o.chainsByDest[e]=[]);for(var i=0;i<t.length;++i){var r=t[i],n=o.chainsBySrc[r.srcChr];if(n){for(var u=!1,h=0;h<n.length;++h){var c=n[h];if(c.srcMin==r.srcMin&&c.srcMax==r.srcMax){u=!0;break}}u||n.push(r)}else o.chainsBySrc[r.srcChr]=[r];var f=o.chainsByDest[r.destChr];if(f){for(var u=!1,h=0;h<f.length;++h){var c=f[h];if(c.destMin==r.destMin&&c.destMax==r.destMax){u=!0;break}}u||f.push(r)}else o.chainsByDest[r.destChr]=[r]}for(var p=a;l>=p;++p){var d=e+"_"+p;o.fetchedTiles[d]=s}if(o.postFetchQueues[e]){for(var g=o.postFetchQueues[e],v=0;v<g.length;++v)g[v]();o.postFetchQueues[e]=null}})["catch"](function(e){console.log(e)}),d(this.postFetchQueues,e,function(){o.sourceBlocksForRange(e,t,i,r)});else{for(var g=[],v=this.chainsByDest[e]||[],y=0;y<v.length;++y){var m=v[y];if(t<=m.destMax&&i>=m.destMin){var b,w;"-"==m.srcOri?(b=m.destMax-i,w=m.destMax-t):(b=t-m.destMin,w=i-m.destMin);for(var x=m.blocks,S=0;S<x.length;++S){var _=x[S],T=_[0],C=_[1],k=_[2];if(w>=C&&C+k>=b){var L=Math.max(b,C)-C,O=Math.min(w,C+k)-C;"-"==m.destOri?g.push(new f(m.srcChr,m.srcMax-T-O,m.srcMax-T-L)):g.push(new f(m.srcChr,m.srcMin+L+T,m.srcMin+O+T))}}}}r(g)}},n.prototype.fetchChains=function(e,t,i){var r=this;return new x(function(t,i){r.source.alignments(e,{},function(e){for(var i=[],n=0;n<e.length;++n)for(var s=e[n],o=0;o<s.blocks.length;++o){for(var a,l,u=s.blocks[o],h=0;h<u.segments.length;++h){var c=u.segments[h],f=s.objects[c.object];f.dbSource===r.srcTag?a=c:f.dbSource===r.destTag&&(l=c)}if(a&&l){for(var p={srcChr:s.objects[a.object].accession,srcMin:0|a.min,srcMax:0|a.max,srcOri:a.strand,destChr:s.objects[l.object].accession,destMin:0|l.min,destMax:0|l.max,destOri:l.strand,blocks:[]},d=v(a.cigar),g=v(l.cigar),y=0,m=0,b=0,w=0;b<d.length&&w<g.length;)if("M"==d[b].op&&"M"==g[w].op){var x=Math.min(d[b].cnt,g[w].cnt);p.blocks.push([y,m,x]),d[b].cnt==x?++b:d[b].cnt-=x,g[w].cnt==x?++w:g[w]-=x,y+=x,m+=x}else"I"==d[b].op?m+=d[b++].cnt:"I"==g[w].op&&(y+=g[w++].cnt);i.push(p)}}t(i)})})},s.prototype.fetchChains=function(e,t,i){return this.bwg.then(function(r,n){if(!r)throw Error("No BWG");return new x(function(n,s){r.getUnzoomedView().readWigData(e,t,i,function(e){n(e.map(l))})})})},u.prototype.fetchChains=function(e,t,i){for(var r=[],n=this.forwardAliases[e]||[],s=0;s<n.length;++s)r.push({srcChr:n[s],srcMin:1,srcMax:1e9,srcOri:"+",destChr:e,destMin:1,destMax:1e9,destOri:"+",blocks:[[1,1,1e9]]});return x.resolve(r)},"undefined"!=typeof t&&(t.exports={Chainset:r})},{"./bigwig":3,"./bin":4,"./cigar":8,"./das":10,"./utils":55,"es6-promise":59}],8:[function(e,t,i){"use strict";function r(e){for(var t,i=[];null!=(t=n.exec(e));){var r=t[1];0==r.length&&(r=1),i.push({cnt:0|r,op:t[2]})}return i}var n=new RegExp("([0-9]*)([MIDS])","g");"undefined"!=typeof t&&(t.exports={parseCigar:r})},{}],9:[function(e,t,i){"use strict";function r(e,t,i,r){this.red=0|e,this.green=0|t,this.blue=0|i,r&&(this.name=r)}function n(e){var t="00"+e.toString(16);return t.substring(t.length-2)}function s(e){var t=l[e];if(!t){var i=u.exec(e);i?(t=new r("0x"+i[1]|0,"0x"+i[2]|0,"0x"+i[3]|0,e),l[e]=t):(i=h.exec(e),i?(t=new r(0|i[1],0|i[2],0|i[3],e),l[e]=t):(console.log("couldn't handle color: "+e),t=l.black,l[e]=t))}return t}function o(e,t,i){for(var n=[],o=0;o<i.length;++o)n.push(s(i[o]));var a=[];e:for(var l=0;e>l;++l){for(var u=1*l/(e-1),h=t[0]+(t[t.length-1]-t[0])*u,c=0;c<t.length-1;++c)if(h>=t[c]&&h<=t[c+1]){var f=(h-t[c])/(t[c+1]-t[c]),p=n[c],d=n[c+1],g=new r(p.red*(1-f)+d.red*f|0,p.green*(1-f)+d.green*f|0,p.blue*(1-f)+d.blue*f|0).toSvgString();a.push(g);continue e}throw"Bad step"}return a}function a(e,t,i,r){return r?o(e,[0,.5,1],[t,i,r]):o(e,[0,1],[t,i])}r.prototype.toSvgString=function(){return this.name||(this.name="rgb("+this.red+","+this.green+","+this.blue+")"),this.name},r.prototype.toHexString=function(){return"#"+n(this.red)+n(this.green)+n(this.blue)};var l={red:new r(255,0,0,"red"),green:new r(0,255,0,"green"),blue:new r(0,0,255,"blue"),yellow:new r(255,255,0,"yellow"),white:new r(255,255,255,"white"),black:new r(0,0,0,"black"),gray:new r(180,180,180,"gray"),grey:new r(180,180,180,"grey"),lightskyblue:new r(135,206,250,"lightskyblue"),lightsalmon:new r(255,160,122,"lightsalmon"),hotpink:new r(255,105,180,"hotpink")},u=new RegExp("^#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$"),h=/rgb\(([0-9]+),([0-9]+),([0-9]+)\)/;"undefined"!=typeof t&&(t.exports={makeColourSteps:o,makeGradient:a,dasColourForName:s})},{}],10:[function(e,t,i){"use strict";function r(e,t,i,r){this.name=e,this.start=t,this.end=i,this.description=r}function n(e,t){var i;"string"==typeof e?(this.uri=e,i=t||{}):i=e||{};for(var r in i)this[r]=i[r];this.coords||(this.coords=[]),this.props||(this.props={}),this.dasBaseURI=this.uri,this.dasBaseURI&&"/"!=this.dasBaseURI.substr(this.uri.length-1)&&(this.dasBaseURI=this.dasBaseURI+"/")}function s(){}function o(e,t){return e.taxon==t.taxon&&e.auth==t.auth&&e.version==t.version}function a(e,t,i,r,n){this.name=e,this.start=t,this.end=i,this.alphabet=r,this.seq=n}function l(){}function u(e){e&&(this.id=e)}function h(e,t){this.desc=e,this.uri=t}function c(e){this.type=e,this.objects={},this.blocks=[]}function f(){this.styles=[]}function p(){}function d(e){var t=e.getAttribute("steps");t=t?0|t:50;for(var i=[],r=[],n=e.getElementsByTagName("STOP"),s=0;s<n.length;++s){var o=n[s];i.push(1*o.getAttribute("score")),r.push(o.firstChild.nodeValue)}return O(t,i,r)}function g(e,t){t=t||{},this.uri=e,this.opts=t}function v(e,t){var i=e.getElementsByTagName(t);if(i.length>0&&i[0].firstChild){var r=i[0];if(1==r.childNodes.length)return r.firstChild.nodeValue;for(var n="",s=0;s<r.childNodes.length;++s)n+=r.childNodes[s].nodeValue;return n}return null}function y(e){if(e.hasChildNodes()){var t=e.firstChild;do{if(t.nodeType==Node.ELEMENT_NODE)return t;t=t.nextSibling}while(null!=t)}return null}function m(e){for(var t=new Array,i=e.getElementsByTagName("LINK"),r=0;r<i.length;++r){var n=i[r];n.parentNode==e&&t.push(new h(n.firstChild?n.firstChild.nodeValue:"Unknown",n.getAttribute("href")))}return t}function b(e){for(var t=[],i=e.getElementsByTagName("NOTE"),r=0;r<i.length;++r)i[r].firstChild&&t.push(i[r].firstChild.nodeValue);return t}function w(e,t,i,r){if(window.XDomainRequest){var n=new XDomainRequest;n.onload=function(){var e=new ActiveXObject("Microsoft.XMLDOM");e.async=!1,e.loadXML(n.responseText),t(e)},n.open("get",e),n.send()}else try{var n=new XMLHttpRequest,s=setTimeout(function(){console.log("timing out "+e),n.abort(),t(null,n)},5e3);n.ontimeout=function(){console.log("timeout on "+e)},n.onreadystatechange=function(){4==n.readyState&&(clearTimeout(s),
(n.status>=200||0==n.status)&&t(n.responseXML,n))},n.open("get",e,!0),n.timeout=5e3,i&&(n.withCredentials=!0),r&&n.setRequestHeader("X-DAS-Authorisation",r),n.overrideMimeType("text/xml"),n.setRequestHeader("Accept","application/xml,*/*"),n.send()}catch(o){t(null,n,o)}}function x(e){return e=(""+e).toLowerCase(),"yes"===e||"true"===e}function S(e){return e?(e=(""+e).toLowerCase(),"no"!==e||"false"!==e):!1}function _(e){var t=C(e);t.styles=[];for(var i=0;i<e.styles.length;++i){var r=t.styles[i]=C(e.styles[i]);r._methodRE=r._labelRE=r._typeRE=void 0,r.style=C(r.style),r.style.id=void 0,r.style._gradient=void 0}return t}if("undefined"!=typeof e)var T=e("./utils"),C=T.shallowCopy,k=T.pusho,L=e("./color"),O=L.makeColourSteps;new Array;r.prototype.toString=function(){return this.name+":"+this.start+".."+this.end},r.prototype.isBounded=function(){return this.start&&this.end},r.prototype.toDASQuery=function(){var e="segment="+this.name;return this.start&&this.end&&(e+=":"+this.start+","+this.end),e},n.prototype.getURI=function(e){return this.resolver?this.resolver(e).then(function(e){return"string"==typeof e?e:e.url}):Promise.resolve(e)},n.prototype.entryPoints=function(e){var t=this.dasBaseURI+"entry_points";this.doCrossDomainRequest(t,function(t){if(!t)return e([]);for(var i=new Array,n=t.getElementsByTagName("SEGMENT"),s=0;s<n.length;++s){var o,a,l=n[s],u=l.getAttribute("id"),h=l.getAttribute("size");h?(o=1,a=0|h):(o=l.getAttribute("start"),o&&(o|=0),a=l.getAttribute("stop"),a&&(a|=0));var c=null;l.firstChild&&(c=l.firstChild.nodeValue),i.push(new r(u,o,a,c))}e(i)})},n.prototype.sequence=function(e,t){var i=this.dasBaseURI+"sequence?"+e.toDASQuery();this.doCrossDomainRequest(i,function(e){if(!e)return void t([]);for(var i=new Array,r=e.getElementsByTagName("SEQUENCE"),n=0;n<r.length;++n){var s=r[n],o=s.getAttribute("id"),l=s.getAttribute("start"),u=s.getAttribute("stop"),h="DNA",c=null;if(s.firstChild){var f=s.firstChild.nodeValue;c="";for(var p=0;;){var d=f.indexOf("\n",p);if(!(d>=0)){c+=f.substring(p).toUpperCase();break}c+=f.substring(p,d).toUpperCase(),p=d+1}}i.push(new a(o,l,u,h,c))}t(i)})},n.prototype.features=function(e,t,i){t=t||{};var r;if(this.features_uri)r=this.features_uri;else{var n=[];if(e)n.push(e.toDASQuery());else if(t.group){var s=t.group;if("string"==typeof s)n.push("group_id="+s);else for(var o=0;o<s.length;++o)n.push("group_id="+s[o])}if(t.adjacent){var a=t.adjacent;"string"==typeof a&&(a=[a]);for(var h=0;h<a.length;++h)n.push("adjacent="+a[h])}if(t.type)if("string"==typeof t.type)n.push("type="+t.type);else for(var c=0;c<t.type.length;++c)n.push("type="+t.type[c]);t.maxbins&&n.push("maxbins="+t.maxbins),n.length>0?r=this.dasBaseURI+"features?"+n.join(";"):i([],"No filters specified")}this.doCrossDomainRequest(r,function(e,t){if(!e){var r;return r=0==t.status?"server may not support CORS":"status="+t.status,void i([],"Failed request: "+r)}for(var n=new Array,s={},o=e.getElementsByTagName("SEGMENT"),a=0;a<o.length;++a){var h=o[a],c=h.getAttribute("id");s[c]={min:h.getAttribute("start"),max:h.getAttribute("stop")};for(var f=h.getElementsByTagName("FEATURE"),p=0;p<f.length;++p){var d=f[p],g=new l;g.segment=c,g.id=d.getAttribute("id"),g.label=d.getAttribute("label");var y=v(d,"START"),w=v(d,"END");(0|y)>(0|w)?(g.min=0|w,g.max=0|y):(g.min=0|y,g.max=0|w);var x=d.getElementsByTagName("TYPE");if(x.length>0){var S=x[0];S.firstChild&&(g.type=S.firstChild.nodeValue),g.typeId=S.getAttribute("id"),g.typeCv=S.getAttribute("cvId")}g.type=v(d,"TYPE"),!g.type&&g.typeId&&(g.type=g.typeId),g.method=v(d,"METHOD");var _=v(d,"ORIENTATION");_||(_="0"),g.orientation=_,g.score=v(d,"SCORE"),g.links=m(d),g.notes=b(d);for(var T=d.getElementsByTagName("GROUP"),C=0;C<T.length;++C){var k=T[C],L=new u;L.type=k.getAttribute("type"),L.id=k.getAttribute("id"),L.links=m(k),L.notes=b(k),g.groups?g.groups.push(L):g.groups=new Array(L)}if(g.notes)for(var O=0;O<g.notes.length;++O){var A=g.notes[O];if(0==A.indexOf("Genename=")){var E=new u;E.type="gene",E.id=A.substring(9),g.groups?g.groups.push(E):g.groups=new Array(E)}}var R=d.getElementsByTagName("PART");if(R.length>0){for(var M=[],B=0;B<R.length;++B)M.push(R[B].getAttribute("id"));g.parts=M}var R=d.getElementsByTagName("PARENT");if(R.length>0){for(var I=[],B=0;B<R.length;++B)I.push(R[B].getAttribute("id"));g.parents=I}n.push(g)}}i(n,void 0,s)},function(e){i([],e)})},n.prototype.alignments=function(e,t,i){var r=this.dasBaseURI+"alignment?query="+e;this.doCrossDomainRequest(r,function(e){if(!e)return void i([],"Failed request "+r);for(var t=[],n=e.getElementsByTagName("alignment"),s=0;s<n.length;++s){for(var o=n[s],a=new c(o.getAttribute("alignType")),l=o.getElementsByTagName("alignObject"),u=0;u<l.length;++u){var h=l[u],f={id:h.getAttribute("intObjectId"),accession:h.getAttribute("dbAccessionId"),version:h.getAttribute("objectVersion"),dbSource:h.getAttribute("dbSource"),dbVersion:h.getAttribute("dbVersion")};a.objects[f.id]=f}for(var p=o.getElementsByTagName("block"),d=0;d<p.length;++d){for(var g=p[d],y={order:g.getAttribute("blockOrder"),segments:[]},m=g.getElementsByTagName("segment"),b=0;b<m.length;++b){var w=m[b],x={object:w.getAttribute("intObjectId"),min:w.getAttribute("start"),max:w.getAttribute("end"),strand:w.getAttribute("strand"),cigar:v(w,"cigar")};y.segments.push(x)}a.blocks.push(y)}t.push(a)}i(t)})},f.prototype.pushStyle=function(e,t,i){e||(e={type:"default"});var r=C(e);t&&(r.zoom=t),r.style=i,this.styles.push(r)},n.prototype.stylesheet=function(e,t){var i,r=this.credentials;this.stylesheet_uri?(i=this.stylesheet_uri,r=!1):i=this.dasBaseURI+"stylesheet",this.getURI(i).then(function(i){w(i,function(i){if(!i)return void(t&&t());for(var r=new f,n=i.getElementsByTagName("TYPE"),s=0;s<n.length;++s){var o=n[s],a={};a.type=o.getAttribute("id"),a.label=o.getAttribute("label"),a.method=o.getAttribute("method");for(var l=o.getElementsByTagName("GLYPH"),u=0;u<l.length;++u){var h=l[u],c=h.getAttribute("zoom"),g=y(h),v=new p;v.glyph=g.localName;for(var m=g.firstChild;m;)m.nodeType==Node.ELEMENT_NODE&&("BGGRAD"==m.localName?v[m.localName]=d(m):v[m.localName]=m.firstChild.nodeValue),m=m.nextSibling;r.pushStyle(a,c,v)}}e(r)},r)})["catch"](function(e){console.log(e),t()})},g.prototype.sources=function(e,t,i){i||(i={});var r=[];i.taxon&&r.push("organism="+i.taxon),i.auth&&r.push("authority="+i.auth),i.version&&r.push("version="+i.version);var o=this.uri;r.length>0&&(o=o+"?"+r.join("&")),w(o,function(i){if(!i&&t)return void t();for(var r=[],o=i.getElementsByTagName("SOURCE"),a=0;a<o.length;++a){var l=o[a],u=l.getElementsByTagName("VERSION");if(!(u.length<1)){for(var h=u[0],c=h.getElementsByTagName("COORDINATES"),f=[],p=0;p<c.length;++p){var d=c[p],g=new s;g.auth=d.getAttribute("authority"),g.taxon=d.getAttribute("taxid"),g.version=d.getAttribute("version"),f.push(g)}for(var v,y=[],m=h.getElementsByTagName("CAPABILITY"),p=0;p<m.length;++p){var b=m[p];if(y.push(b.getAttribute("type")),"das1:features"==b.getAttribute("type")){var w=b.getAttribute("query_uri");v=w.substring(0,w.length-"features".length)}}for(var x={},S=h.getElementsByTagName("PROP"),_=0;_<S.length;++_)k(x,S[_].getAttribute("name"),S[_].getAttribute("value"));if(v){var T=new n(v,{source_uri:l.getAttribute("uri"),name:l.getAttribute("title"),desc:l.getAttribute("description"),coords:f,props:x,capabilities:y});r.push(T)}}}e(r)})},n.prototype.doCrossDomainRequest=function(e,t,i){var r;this.xUser&&(r="Basic "+btoa(this.xUser+":"+this.xPass));try{return w(e,t,this.credentials,r)}catch(n){if(!i)throw n;i(n)}},"undefined"!=typeof t&&(t.exports={DASGroup:u,DASFeature:l,DASStylesheet:f,DASStyle:p,DASSource:n,DASSegment:r,DASRegistry:g,DASSequence:a,DASLink:h,isDasBooleanTrue:x,isDasBooleanNotFalse:S,copyStylesheet:_,coordsMatch:o})},{"./color":9,"./utils":55}],11:[function(e,t,i){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function n(e,t){s(t),t.updateStatus(e)}function s(e){var t=e.viewport.getContext("2d"),i=e.browser.retina&&window.devicePixelRatio>1;if(e.sequenceSource){var r=e.currentSequence;(0,E.drawSeqTier)(e,r)}else e.currentFeatures?c(e,t):console.log("No sequence or features in tier!");if(e.subtiers){var n=D.defaultTo(0,e.dasSource.vOffset);d(e,t,i,!0,n),g(e,t,n),t.restore()}e.drawOverlay(),e.paintQuant(),"function"==typeof e.dasSource.drawCallback&&e.dasSource.drawCallback(t,e),e.originHaxx=0,e.browser.arrangeTiers()}function o(e,t,i,r,n){var s=n.styleForFeature(r),o=void 0,l=!1,u=[],h=null;if(t.forEach(function(t){t.orientation&&null===h&&(h=t.orientation),!o&&t.label&&(o=t.label);var r=n.styleForFeature(t);if(r&&!t.parts){(0,P.isDasBooleanTrue)(r.LABEL)&&(l=!0);var s=a(e,t,i,r,n,null,!0);s&&u.push(s)}}),0===u.length)return null;var c="flat";s&&"LINE"===s.glyph||(n.dasSource.collapseSuperGroups&&!n.bumped?("+"===h||"-"===h)&&(c="collapsed"+h):("+"===h||"-"===h)&&(c="hat"+h));var f=null;(o&&l||s&&((0,P.isDasBooleanTrue)(s.LABEL)||(0,P.isDasBooleanTrue)(s.LABELS)))&&(f=r.label||o);var p=new I.GroupGlyph(u,c);return f&&("+"===h?f=">"+f:"-"===h&&(f="<"+f),p=new I.LabelledGlyph(e,p,f,!1)),p.bump=!0,p}function a(e,t,i,r,n,s,o){var a=n.browser.scale,l=n.browser.viewStart,u=r.glyph||"BOX",h=t.min,c=t.max,f=t.orientation,p=t.score,d=t.label||t.id;if(n.dasSource.hideSubpixelGlyphs&&1>(c-h)*a)return null;var g=(h-l)*a,v=(c-l+1)*a,y=Math.max(v,g+1);s=1*s;var _=1*(n.forceHeight||r.HEIGHT||s||12);_=1*_;var T=r.BUMP&&(0,P.isDasBooleanTrue)(r.BUMP),C=void 0,k=void 0;if("CROSS"===u||"EX"===u||"TRIANGLE"===u||"DOT"===u||"SQUARE"===u||"STAR"===u||"PLIMSOLL"===u){var L=b(e,n,t,i,u,r,s,o);if(L){var A=O(L,2);C=A[0],k=A[1]}}else if("HISTOGRAM"===u||"GRADIENT"===u&&"undefined"!==p){var E=w(e,n,t,i,u,r,s),R=O(E,2);C=R[0],k=R[1]}else if("HIDDEN"===u)C=new I.PaddedGlyph(null,g,y),o=!0;else if("ARROW"===u){var M=r.FGCOLOR||"purple",B=(0,P.isDasBooleanTrue)(r.PARALLEL),H=(0,P.isDasBooleanTrue)(r.SOUTHWEST),N=(0,P.isDasBooleanTrue)(r.NORTHEAST);C=new I.ArrowGlyph(g,y,_,M,B,H,N)}else if("ANCHORED_ARROW"===u){var F=r.FGCOLOR||"none",G=r.BGCOLOR||"green";C=new I.AArrowGlyph(g,y,_,G,F,f),C.bump=!0}else if("SPAN"===u){var D=r.FGCOLOR||"black";C=new I.SpanGlyph(g,y,_,D)}else if("LINE"===u){var q=r.FGCOLOR||"black",U=r.STYLE||"solid";C=new I.LineGlyph(g,y,_,U,f,q)}else if("PRIMERS"===u){var z=r.FGCOLOR||"black",j=r.BGCOLOR||"red";C=new I.PrimersGlyph(g,y,_,j,z)}else if("TEXT"===u){var W=r.STRING||"text",V=r.FGCOLOR||"black";C=new I.TextGlyph(e,g,y,_,V,W)}else if("TOOMANY"===u){var X=r.FGCOLOR||"gray",K=r.BGCOLOR||"orange";C=new I.TooManyGlyph(g,y,_,K,X)}else if("POINT"===u){var Z=x(n,t,r),Q=O(Z,2);C=Q[0],k=Q[1]}else if("__SEQUENCE"===u)C=S(e,n,t,r,s);else if("__INSERTION"===u){var Y=!0;if(void 0!==r.__INSERTIONS&&(Y=(0,P.isDasBooleanNotFalse)(r.__INSERTIONS)),C=new I.TriangleGlyph(g,5,"S",5,n.browser.baseColors.I),Y&&(C=new I.LabelledGlyph(e,C,t.insertion||t.altAlleles[0],!1,"center","above","7px sans-serif")),y-g>1){var $=r.FGCOLOR||"red",J=r.BGCOLOR||r.COLOR1||"green",ee=new I.BoxGlyph(g,5,y-g,_,J,$);C=new I.GroupGlyph([ee,C])}}else{if("__NONE"===u)return null;if("BOX"===u){var te=r.FGCOLOR||null,ie=r.BGCOLOR||r.COLOR1||"green";r.BGITEM&&t.itemRgb&&(ie=t.itemRgb);var re=(y-g)/(c-h);if("translation"==t.type&&("protein_coding"==t.method||t.readframeExplicit)&&(!t.tags||t.tags.indexOf("cds_start_NF")<0||t.readframeExplicit)&&(!n.dasSource.collapseSuperGroups||n.bumped)&&re>=.5){var ne=m(n,h,c);C=new I.AminoAcidGlyph(g,y,_,ie,ne,t.orientation,t.readframe)}else C=new I.BoxGlyph(g,0,y-g,_,ie,te)}}return C?(((0,P.isDasBooleanTrue)(r.LABEL)||t.forceLabel)&&d&&!o&&(C=new I.LabelledGlyph(e,C,d,!1)),T&&(C.bump=!0),C.feature=t,(0,P.isDasBooleanTrue)(r.HIDEAXISLABEL)&&(k=null),k&&(C.quant=k),r.ZINDEX&&(C.zindex=0|r.ZINDEX),C):void 0}function l(e,t,i){var r=[],n={},s={},o=[];D.map(function(l){l.forEach(function(l){var u=e.styleForFeature(l);if(!l.parts&&u)if("LINEPLOT"===u.glyph)(0,M.pusho)(n,u.id,l),s[u.id]=u;else if("STACKED"===u.glyph)o.push(l);else{var h=a(t,l,i,u,e);h&&r.push(h)}})},e.ungroupedFeatures),o.length>0&&(r=r.concat(T(o,e)));for(var l in n){var u=n[l],h=s[l];if("LINEPLOT"===h.glyph){var c=_(u,h,e,i);c.forEach(function(e){return r.push(e)})}}return r}function u(e,t,i,r){var n=Object.keys(e.groupedFeatures),s={};return n.sort(function(t,i){return e.groupedFeatures[i][0].score-e.groupedFeatures[t][0].score}),n.forEach(function(i){var n=o(t,e.groupedFeatures[i],r,e.groups[i],e,e.dasSource.collapseSuperGroups&&!e.bumped?"collapsed_gene":"tent");n&&(n.group=e.groups[i],s[i]=n)}),s}function h(e,t,i,r,n){var s=e.subtierMax||e.dasSource.subtierMax||e.browser.defaultSubtierMax,o=!1,a=new A.SubTier,l=[];return t.forEach(function(t){if(t.bump&&(e.bumped||e.dasSource.collapseSuperGroups)){var i=l.find(function(e){return e.hasSpaceFor(t)});if(i)i.add(t);else if(l.length>=s)o=!0;else{var r=new A.SubTier;r.add(t),l.push(r)}}else a.add(t)}),a.glyphs.length>0&&(l=[a].concat(l)),i&&l.forEach(function(e){e.quant&&e.glyphs.unshift(new I.GridGlyph(e.height,r,n))}),l.forEach(function(e){e.glyphs.sort(function(e,t){return(e.zindex||0)-(t.zindex||0)})}),[l,o]}function c(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!0,n=3;e.padding="number"==typeof e.dasSource.padding?e.dasSource.padding:n,e.scaleVertical="boolean"==typeof e.dasSource.scaleVertical?e.dasSource.scaleVertical:!1;var s=l(e,t,i);if(e.dasSource.collapseSuperGroups&&!e.bumped){var o=function(t){var i=e.superGroups[t];e.groups[t]=(0,M.shallowCopy)(e.groups[t]);var r=e.groups[t];r.isSuperGroup=!0;var n={},s=1e10,o=-1e10,a=null;i.forEach(function(t,l){var u=e.groupedFeatures[i[l]];u&&(u.forEach(function(e){(0,M.pusho)(n,e.type,e),s=Math.min(e.min,s),o=Math.max(e.max,o),e.segment&&!a&&(a=e.segment)}),(r&&!r.links||0===r.links.length)&&(r.links=e.groups[i[0]].links),delete e.groupedFeatures[i[l]])}),e.groups[t].max=o,e.groups[t].min=s,e.groups[t].segment=a,D.map(function(r){var n=r[0],s=null;r.forEach(function(e){var t=new R.Range(e.min,e.max);s=s?(0,R.union)(s,t):t});var o=s.ranges();o.forEach(function(s){var o=((0|s.max())-(0|s.min())+1)*i.length,a=0;r.forEach(function(e){var t=e.min||0,i=e.max||0;t<=s.max()&&i>=s.min()&&(a+=Math.min(i,s.max())-Math.max(t,s.min())+1)});var l=new P.DASFeature;for(var u in n)l[u]=n[u];l.min=s.min(),l.max=s.max(),l.label&&i.length>1&&(l.label+=" ("+i.length+" vars)"),l.visualWeight=1*a/o,(0,M.pusho)(e.groupedFeatures,t,l)})},n),delete e.superGroups[t]};for(var a in e.superGroups)o(a)}var c=u(e,t,s,i);D.map(function(e){var t=[],i=1e10,r=-1e10;e.forEach(function(e){var n=c[e];n&&(t.push(n),i=Math.min(i,n.min()),r=Math.max(r,n.max()))}),t.forEach(function(e){s.push(new I.PaddedGlyph(e,i,r))})},e.superGroups),D.map(function(e){return s.push(e)},c);var f=h(e,s,r,i),p=O(f,2),d=p[0],g=p[1];e.glyphCacheOrigin=e.browser.viewStart,g?e.updateStatus("Bumping limit exceeded, use the track editor to see more features"):e.updateStatus(),e.subtiers=d}function f(e,t,i){var r=e.browser.viewStart-1e3/e.browser.scale,n=e.browser.viewEnd+1e3/e.browser.scale,s=[];e.knownCoverage&&!function(){var t=e.knownCoverage.ranges();t.forEach(function(e,i){0===i?e.min()>r&&s.push({min:r,max:e.min()-1}):s.push({min:t[i-1].max()+1,max:e.min()-1}),i==t.length-1&&e.max()<n&&s.push({min:e.max()+1,max:n})})}(),s.length>0&&(t.fillStyle="gray",s.forEach(function(r){var n=(r.min-e.browser.viewStart)*e.browser.scale+1e3,s=(r.max-e.browser.viewStart)*e.browser.scale+1e3;t.fillRect(n,0,s-n,i)}))}function p(e,t,i){e.clearRect(0,0,t,i)}function d(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=e.browser.featurePanelWidth+2e3;i&&(s*=2);var o=0|e.viewport.width;s-50>o&&(e.viewport.width=o=s);var a=e.padding+n;e.subtiers.forEach(function(t){return a+=t.height+e.padding}),a+=6,a=Math.max(a,e.browser.minTierHeight);var l=a;i&&(l*=2),l!=e.viewport.height&&(e.viewport.height=l),e.viewportHolder.style.left="-1000px",e.viewport.style.width=i?""+o/2+"px":""+o+"px",e.viewport.style.height=""+a+"px",e.layoutHeight=Math.max(a,e.browser.minTierHeight),e.updateHeight(),e.norigin=e.browser.viewStart,t.save(),i&&t.scale(2,2),r&&p(t,o,l),f(e,t,a)}function g(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new I.OverlayLabelCanvas,n=(e.glyphCacheOrigin-e.browser.viewStart)*e.browser.scale+1e3;t.translate(n,i+e.padding),r.translate(0,e.padding),e.paintToContext(t,r,n),r.glyphs.length>0?e.overlayLabelCanvas=r:e.overlayLabelCanvas=null,t.restore()}function v(e,t){var i=e.quantMin(t),r=e.quantMax(t);return r||(r=0>i?0:10),i||(i=0),[i,r]}function y(e,t,i){var r=(1*e-t)/(i-t),n=-1*t/(i-t);return[r,n]}function m(e,t,i){var r=null;if(e.currentSequence){var n=0|e.currentSequence.start,s=0|e.currentSequence.end;if(i>=n&&s>=t){var o=Math.max(t,n),a=Math.min(i,s);for(r=e.currentSequence.seq.substr(o-n,a-o+1);o>t;)r="N"+r,o--;for(;i>a;)r+="N",a++}}return r}function b(e,t,i,r,n,s,o,a){var l=t.browser.scale,u=t.browser.viewStart,h=i.score,c=i.label||i.id,f=(i.min-u)*l,p=Math.max((i.max-u+1)*l,f+1),d=1*(t.forceHeight||s.HEIGHT||o||12),g=d,m=null,b=null,w=s.FGCOLOR||"black",x=s.BGCOLOR||"none",S=s.STROKECOLOR;if(s.BGITEM&&i.itemRgb)w=i.itemRgb;else if((0,P.isDasBooleanTrue)(s.COLOR_BY_SCORE2)){var _=s.BGGRAD||s._gradient;_||(_=(0,H.makeGradient)(50,s.COLOR1,s.COLOR2,s.COLOR3),s._gradient=_);var T=i.score2;if(void 0!==T||!w){T=T||0;var C=s.MIN2?1*s.MIN2:0,k=s.MAX2?1*s.MAX2:1,A=(1*T-C)/(k-C),E=A*_.length|0;D.clamp(0,E,_.length-1),w=_[E]}}var R=s.SIZE||d;s.RSIZE&&(R=1*s.RSIZE*d),s.STROKETHRESHOLD&&R<1*s.STROKETHRESHOLD&&(S=null);var M=(f+p)/2;if("EX"===n)m=new I.ExGlyph(M,R,w);else if("TRIANGLE"===n){var B=s.DIRECTION||"N",N=s.LINEWIDTH||R;m=new I.TriangleGlyph(M,R,B,N,w,S)}else if("DOT"===n)m=new I.DotGlyph(M,R,w,S);else if("PLIMSOLL"===n)m=new I.PlimsollGlyph(M,R,.2*R,w,S);else if("SQUARE"===n)m=new I.BoxGlyph(M-R/2,0,R,R,w,S);else if("STAR"===n){var F=s.POINTS||5;m=new I.StarGlyph(M,R/2,F,w,S)}else m=new I.CrossGlyph(M,R,w);if(x&&"none"!==x&&p-f>5){var G=new I.BoxGlyph(f,0,p-f,R,x);m=new I.GroupGlyph([G,m])}if((0,P.isDasBooleanTrue)(s.SCATTER)){var q=function(){var n=v(t,s),o=O(n,2),l=o[0],u=o[1],f=y(h,l,u),p=O(f,2),w=p[0],x=p[1];if(0>w||w>1)return{v:null};var S=function(e){return(e-x)*g};d=Math.max(1,S(w)),r+=S(1),w>=x&&(r-=d),b={min:l,max:u};var _=0,T=D.defaultTo(s.LABEL,i.forceLabel);(0,P.isDasBooleanNotFalse)(T)&&c&&!a&&(m=new I.LabelledGlyph(e,m,c,!0,null,"above"==T?"above":"below"),"above"===T&&(_=m.textHeight+2),a=!0),m=new I.TranslatedGlyph(m,0,r-R/2-_,g)}();if("object"===("undefined"==typeof q?"undefined":L(q)))return q.v}return[m,b]}function w(e,t,i,r,n,s,o){var a=t.browser.scale,l=t.browser.viewStart,u=i.score,h=(i.min-l)*a,c=Math.max((i.max-l+1)*a,h+1),f=1*(t.forceHeight||s.HEIGHT||o||12),p=1*f,d=null,g=null,m=(0,P.isDasBooleanTrue)(s.AXISCENTER),b=v(t,s),w=O(b,2),x=w[0],S=w[1];if((0,P.isDasBooleanTrue)(s.AUTOMIN)&&(x=.95*t.currentFeaturesMinScore,console.log("smin:	"+x)),(0,P.isDasBooleanTrue)(s.AUTOMAX)&&(S=1.05*t.currentFeaturesMaxScore,console.log("smax:	"+S)),1*x>1*u&&(u=x),1*u>1*S&&(u=S),m){var _=t.quantMin(s),T=t.quantMax(s);(0,P.isDasBooleanTrue)(s.AUTOMIN)&&(_=.95*t.currentFeaturesMinScore),(0,P.isDasBooleanTrue)(s.AUTOMAX)&&(T=1.05*t.currentFeaturesMaxScore),x=_-(T-_)/2,S=T-(T-_)/2}var C=y(u,x,S),k=O(C,2),L=k[0],A=k[1];if("HISTOGRAM"===n){var E=function(e){return e-Math.max(0,A)};f=Math.abs(E(L))*p,r+=E(1)*p,L>=A&&(r-=f),m&&(r+=f/2),g=(0,P.isDasBooleanTrue)(s.HIDEAXISLABEL)?null:{min:x,max:S}}var R=s.FGCOLOR||null,M=s.BGCOLOR||s.COLOR1||"green";s.BGITEM&&i.itemRgb&&(M=i.itemRgb);var B=s.ALPHA?1*s.ALPHA:null;if(s.BGGRAD){var N=s.BGGRAD,F=L*N.length|0;F=D.clamp(0,F,N.length-1),M=N[F]}if(s.COLOR2){var G=s._gradient;G||(G=(0,H.makeGradient)(50,s.COLOR1,s.COLOR2,s.COLOR3),s._gradient=G);var q=L*G.length|0;q=D.clamp(0,q,G.length-1),M=G[q]}var U=new I.BoxGlyph(h,r,c-h,f,M,R,B);return d=new I.TranslatedGlyph(U,0,0,p),[d,g]}function x(e,t,i){var r=e.browser.scale,n=e.browser.viewStart,s=t.score,o=(t.min-n)*r,a=Math.max((t.max-n+1)*r,o+1),l=e.forceHeight||i.HEIGHT||30,u=null,h=null,c=v(e,i),f=O(c,2),p=f[0],d=f[1],g=1*l/(d-p),y=(1*s-p)/(d-p),m=(s-1*p)*g|0;h={min:p,max:d};var b=i.FGCOLOR||i.COLOR1||"black";if(i.COLOR2){var w=i._gradient;w||(w=(0,H.makeGradient)(50,i.COLOR1,i.COLOR2,i.COLOR3),i._gradient=w);var x=y*w.length|0;x=D.clamp(0,x,w.length-1),b=w[x]}return u=new I.PointGlyph((o+a)/2,l-m,l,b),[u,h]}function S(e,t,i,r,n){var s=t.browser.scale,o=t.browser.viewStart,a=i.min,l=i.max,u=(i.min-o)*s,h=Math.max((i.max-o+1)*s,u+1),c=1*(t.forceHeight||r.HEIGHT||n||12),f=null,p=i.seq,d=p,g=i.quals,v=g,y=(0,P.isDasBooleanTrue)(r.__INSERTIONS),b=[];i.cigar&&!function(){var r=(0,N.parseCigar)(i.cigar);d="",v="";var n=0;r.forEach(function(i){if("M"===i.op)d+=p.substr(n,i.cnt),v+=g.substr(n,i.cnt),n+=i.cnt;else if("D"===i.op)d+="-".repeat(i.cnt),v+="Z".repeat(i.cnt);else if("I"===i.op){var r=p.substr(n,i.cnt),o=new I.TranslatedGlyph(new I.TriangleGlyph(u+d.length*s,6,"S",5,t.browser.baseColors.I),0,-2,0);y&&(o=new I.LabelledGlyph(e,o,r,!1,"center","above","7px sans-serif")),o.feature={label:"Insertion: "+r,type:"insertion",method:"insertion"},b.push(o),n+=i.cnt}else"S"===i.op?n+=i.cnt:console.log("unknown cigop"+i.op)})}();var w=m(t,a,l);if(d&&w&&("mismatch"===r.__SEQCOLOR||"mismatch-all"===r.__SEQCOLOR)){for(var x=[],S="-"===i.orientation?",":".",_=0;_<d.length;++_)x.push(d[_]==w[_]?S:d[_]);d=x.join("")}var T="-"===i.orientation?r._minusColor||"lightskyblue":r._plusColor||"lightsalmon";return r.__disableQuals&&(v=!1),f=new I.SequenceGlyph(t.browser.baseColors,T,u,h,c,d,w,r.__SEQCOLOR,v,!(0,P.isDasBooleanTrue)(r.__CLEARBG),t.scaleVertical),y&&(f=new I.TranslatedGlyph(f,0,7)),b.length>0&&(b.splice(0,0,f),f=new I.GroupGlyph(b)),f}function _(e,t,i,r){r=r||0;var n=i.browser.viewStart,s=i.browser.scale,o=i.forceHeight||t.HEIGHT||30,a=i.quantMin(t),l=i.quantMax(t);(0,P.isDasBooleanTrue)(t.AUTOMIN)&&(a=.95*i.currentFeaturesMinScore),(0,P.isDasBooleanTrue)(t.AUTOMAX)&&(l=1.05*i.currentFeaturesMaxScore);var u=1*o/(l-a),h=t.FGCOLOR||t.COLOR1||"black",c=1,f=null,p=[],d=[],g=null;e.forEach(function(e){var i=(((0|e.min)+(0|e.max))/2-n)*s,l=(e.score-1*a)*u|0;(0,P.isDasBooleanTrue)(t.ADDITIVE)?(f=e.score<0?-1:1,f!==c&&(d.push({points:p,color:1===c?t.POSCOLOR:t.NEGCOLOR}),p=[],p.push(g)),c=f):f=1;var h=o-l*f+r;g={x:i,y:h},p.push(g)}),(0,P.isDasBooleanTrue)(t.ADDITIVE)&&(h=1===f?t.POSCOLOR:t.NEGCOLOR),d.push({points:p,color:h});var v=d.map(function(e){var i=new I.LineGraphGlyph(e.points,e.color,o);return i.quant={min:a,max:l},t.ZINDEX&&(i.zindex=0|t.ZINDEX),i});return v}function T(e,t){for(var i=[],r=[],n=[],s=t.browser.scale,o=t.browser.viewStart,a=0;a<e.length;++a){var l=e[a],u=t.styleForFeature(l),h=1*l.score,c=t.forceHeight||u.HEIGHT||12,f=c=1*c,p=l.min,d=l.max,g=(p-o)*s,v=(d-o+1)*s,y=Math.max(v,g+1),m=t.quantMin(u),b=t.quantMax(u);b=b?1*b:0>m?0:10,m=m?1*m:0;var w;if(h>=0?(w=r[p]||0,r[p]=w+h):(w=n[p]||0,n[p]=w+h),!(w>b||m>w)){m>w+h&&(h=m-w),w+h>b&&(h=b-w);var x=(h+w-m)/(b-m),S=(w-m)/(b-m),_=Math.max(S,x),T=Math.min(S,x);c=(_-T)*f;var C=(1-_)*f,k=u.FGCOLOR||null,L=u.BGCOLOR||u.COLOR1||"green";u.BGITEM&&l.itemRgb&&(L=l.itemRgb);var O=u.ALPHA?1*u.ALPHA:null,A=new I.BoxGlyph(g,C,y-g,c,L,k,O);A=new I.TranslatedGlyph(A,0,0,f),A.feature=l,A.quant={min:m,max:b},u.ZINDEX&&(A.zindex=0|u.ZINDEX),i.push(A)}}return i}function C(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,r=50;e.quantOverlay.height=t,e.quantOverlay.width=i?2*r:r,e.quantOverlay.style.height=""+(i?t/2:t)+"px",e.quantOverlay.style.width=""+r+"px",e.quantOverlay.style.display="block";var n=e.quantOverlay.getContext("2d");return i&&n.scale(2,2),n}function k(e,t,i,r){e.save();var n=t.quantOverlay.height,s=100,o=(n+2*t.padding)/r,a=(i.max-i.min)/r;if(e.fillStyle="white",e.globalAlpha=.6,"right"==t.browser.rulerLocation?e.fillRect(s-30,0,30,n+2*t.padding):e.fillRect(0,0,30,n+2*t.padding),e.globalAlpha=1,e.strokeStyle="black",e.lineWidth=1,e.beginPath(),"right"==t.browser.rulerLocation){e.moveTo(s-8,t.padding),e.lineTo(s,t.padding),e.lineTo(s,n+t.padding),e.lineTo(s-8,n+t.padding);for(var l=1;r-1>l;l++){var u=l*o;e.moveTo(s,u),e.lineTo(s-5,u)}}else{e.moveTo(8,t.padding),e.lineTo(0,t.padding),e.lineTo(0,n+t.padding),e.lineTo(8,n+t.padding);for(var h=1;r-1>h;h++){var c=h*o;e.moveTo(0,c),e.lineTo(5,c)}}if(e.stroke(),e.fillStyle="black","right"==t.browser.rulerLocation){e.textAlign="right",e.fillText((0,F.formatQuantLabel)(i.max),s-9,8),e.fillText((0,F.formatQuantLabel)(i.min),s-9,n+t.padding);for(var f=1;r-1>f;f++){var p=f*o;e.fillText((0,F.formatQuantLabel)(1*i.max-f*a),s-9,p+3)}}else{e.textAlign="left",e.fillText((0,F.formatQuantLabel)(i.max),9,8),e.fillText((0,F.formatQuantLabel)(i.min),9,n+t.padding);for(var d=1;r-1>d;d++){var g=d*o;e.fillText((0,F.formatQuantLabel)(1*i.max-d*a),9,g+3)}}e.restore()}Object.defineProperty(i,"__esModule",{value:!0}),i.paintQuant=i.createQuantOverlay=i.clearViewport=i.drawUnmapped=i.paint=i.prepareViewport=i.prepareSubtiers=i.drawTier=i.renderTier=void 0;var L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=function(){function e(e,t){var i=[],r=!0,n=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(l){n=!0,s=l}finally{try{!r&&a["return"]&&a["return"]()}finally{if(n)throw s}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),A=e("./feature-draw.js"),E=e("./sequence-draw.js"),R=e("./spans.js"),M=e("./utils.js"),B=e("./glyphs.js"),I=r(B),P=e("./das.js"),H=e("./color.js"),N=e("./cigar.js"),F=e("./numformats"),G=e("ramda"),D=r(G);i.renderTier=n,i.drawTier=s,i.prepareSubtiers=c,i.prepareViewport=d,i.paint=g,i.drawUnmapped=f,i.clearViewport=p,i.createQuantOverlay=C,i.paintQuant=k},{"./cigar.js":8,"./color.js":9,"./das.js":10,"./feature-draw.js":20,"./glyphs.js":23,"./numformats":29,"./sequence-draw.js":35,"./spans.js":40,"./utils.js":55,ramda:62}],12:[function(e,t,i){"use strict";function r(e,t,i){function r(){i?(n.className="fa fa-caret-down",t.style.display="table"):(n.className="fa fa-caret-right",t.style.display="none")}var n=a("i");r(),n.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),i=!i,r()},!1);var s=a("h6",[n," ",e],{},{display:"block",background:"gray",color:"white",width:"100%",padding:"5px 2px",margin:"0px"});return a("div",[s,t],{})}if("undefined"!=typeof e)var n=e("./cbrowser"),s=n.Browser,o=e("./utils"),a=o.makeElement,l=o.removeChildren;s.prototype.removeAllPopups=function(){l(this.hPopupHolder),l(this.popupHolder)},s.prototype.makeTooltip=function(e,t){var i,r=!1,n=this,s=null;i=function(t){r=!1,s&&(clearTimeout(s),s=null),e.removeEventListener("mouseout",i,!1)};var o=function l(i){var o=i.clientX+window.scrollX,u=i.clientY+window.scrollY;s||(s=setTimeout(function(){var i;i="function"==typeof t?t():t;var h=a("div",[a("div",null,{className:"tooltip-arrow"}),a("div",i,{className:"tooltip-inner"})],{className:"tooltip bottom in"},{display:"block",top:""+(u+20)+"px",left:""+Math.max(o-30,20)+"px"});n.hPopupHolder.appendChild(h);var c;c=function(t){try{n.hPopupHolder.removeChild(h)}catch(i){}window.removeEventListener("mousemove",c,!1),r&&(null==e.offsetParent||l(t))},window.addEventListener("mousemove",c,!1),s=null},1e3))};e.addEventListener("mouseover",function(t){r=!0,e.addEventListener("mouseout",i,!1),o(t)},!1),e.addEventListener("DOMNodeRemovedFromDocument",function(e){r=!1,s&&(clearTimeout(s),s=null)},!1)},s.prototype.popit=function(e,t,i,r){var n=this;r||(r={}),e||(e={});var s,o,l=r.width||200;if(e.clientX)var s=e.clientX,o=e.clientY;else s=500,o=50;s+=document.documentElement.scrollLeft||document.body.scrollLeft,o+=document.documentElement.scrollTop||document.body.scrollTop;var u=window.innerWidth,h=o,c=Math.min(s-l/2-4,u-l-30),f=a("div");if(f.className="popover fade "+(e.clientX?"bottom ":"")+"in",f.style.display="block",f.style.position="absolute",f.style.top=""+h+"px",f.style.left=""+c+"px",f.style.width=l+"px",l>276&&(f.style.maxWidth=l+"px"),f.appendChild(a("div",null,{className:"arrow"})),t){var p=a("button","",{className:"close"});p.innerHTML="&times;",p.addEventListener("mouseover",function(e){p.style.color="red"},!1),p.addEventListener("mouseout",function(e){p.style.color="black"},!1),p.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),n.removeAllPopups()},!1);var d,g,v,y,m=a("h4",[a("span",t,null,{maxWidth:"200px"}),p],{},{paddingLeft:"10px",paddingRight:"10px"});v=function(e){e.stopPropagation(),e.preventDefault(),c+=e.clientX-d,8>c&&(c=8),c>u-l-32&&(c=u-l-26),h+=e.clientY-g,h=Math.max(10,h),f.style.top=""+h+"px",f.style.left=""+Math.min(c,u-l-10)+"px",d=e.clientX,g=e.clientY},y=function(e){e.stopPropagation(),e.preventDefault(),window.removeEventListener("mousemove",v,!1),window.removeEventListener("mouseup",y,!1)},m.addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation(),d=e.clientX,g=e.clientY,window.addEventListener("mousemove",v,!1),window.addEventListener("mouseup",y,!1)},!1),f.appendChild(m)}f.appendChild(a("div",i,{className:"popover-content"},{padding:"0px"})),this.hPopupHolder.appendChild(f);var b={node:f,displayed:!0};return f.addEventListener("DOMNodeRemoved",function(e){e.target==f&&(b.displayed=!1)},!1),b},"undefined"!=typeof t&&(t.exports={makeTreeTableSection:r})},{"./cbrowser":6,"./utils":55}],13:[function(e,t,i){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function n(e,t){s(t),t.updateStatus(e)}function s(e){var t=e.viewport.getContext("2d"),i=e.browser.retina&&window.devicePixelRatio>1;i&&t.scale(2,2);var r=e.currentFeatures,n=e.currentSequence;e.sequenceSource?a.drawSeqTier(e,n):r?a.prepareSubtiers(e,t):console.log("No sequence or features in tier!"),e.subtiers&&a.prepareViewport(e,t,i,!0),e.drawOverlay(),e.paintQuant(),"function"==typeof e.dasSource.drawCallback&&e.dasSource.drawCallback(t,e),e.originHaxx=0,e.browser.arrangeTiers()}Object.defineProperty(i,"__esModule",{value:!0}),i.drawTier=i.renderTier=void 0;var o=e("./default-renderer"),a=r(o);i.renderTier=n,i.drawTier=s},{"./default-renderer":11}],14:[function(e,t,i){"use strict";function r(e,t){return e.indexOf("?")<0&&(e+="?soft=true"),new l(function(i,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState)if(n.status>=300)r("Error code "+n.status);else{var e=JSON.parse(n.response);i(t?e:e.location)}},n.open("GET",e,!0),n.setRequestHeader("Accept","application/json"),n.responseType="text",n.send()})}function n(e){this.rawurl=e}function s(e,t,i,r){r||("object"===("undefined"==typeof t?"undefined":a(t))?(r=t,t=void 0):r={}),this.url="string"==typeof e?new n(e):e,this.start=t||0,i&&(this.end=i),this.opts=r}function o(e){if(!e)return null;for(var t=new Uint8Array(e.length),i=0;i<t.length;++i)t[i]=e.charCodeAt(i);return t.buffer}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if("undefined"!=typeof e)var l=e("es6-promise").Promise;n.prototype.getURLPromise=function(){return this.urlPromise&&this.urlPromiseValidity>Date.now()?this.urlPromise:(this.urlPromise=r(this.rawurl,!0).then(function(e){return e.location}),this.urlPromiseValidity=Date.now()+432e5,this.urlPromise)},s.prototype.slice=function(e,t){if(0>e)throw"Bad slice "+e;var i=this.start,r=this.end;return i&&e?i+=e:i=e||i,r=t&&i?i+t-1:r||t-1,new s(this.url,i,r,this.opts);
},s.prototype.fetchAsText=function(e){var t,i=this,r=new XMLHttpRequest;i.url.getURLPromise().then(function(n){if(r.open("GET",n,!0),i.end){if(i.end-i.start>1e8)throw"Monster fetch!";r.setRequestHeader("Range","bytes="+i.start+"-"+i.end),t=i.end-i.start+1}r.onreadystatechange=function(){return 4==r.readyState?e(200==r.status||206==r.status?r.responseText:null):void 0},i.opts.credentials&&(r.withCredentials=!0),r.send()})["catch"](function(t){return console.log(t),e(null)})},s.prototype.salted=function(){return this},s.prototype.fetch=function(e,t,i){var r=this;return t=t||1,t>3?e(null):void r.url.getURLPromise().then(function(n){var s,a=new XMLHttpRequest;if(a.open("GET",n,!0),a.overrideMimeType("text/plain; charset=x-user-defined"),r.end){if(r.end-r.start>1e8)throw"Monster fetch!";a.setRequestHeader("Range","bytes="+r.start+"-"+r.end),s=r.end-r.start+1}a.responseType="arraybuffer",a.onreadystatechange=function(){if(4==a.readyState){if(200==a.status||206==a.status){if(a.response){var n=a.response.byteLength;return!s||s==n||i&&n==i?e(a.response):r.fetch(e,t+1,n)}if(a.mozResponseArrayBuffer)return e(a.mozResponseArrayBuffer);var l=a.responseText;return!s||s==l.length||i&&l.length==i?e(o(a.responseText)):r.fetch(e,t+1,l.length)}return r.fetch(e,t+1)}},r.opts.credentials&&(a.withCredentials=!0),a.send()})["catch"](function(e){console.log(e)})},"undefined"!=typeof t&&(t.exports={lookupEncodeURI:r,EncodeFetchable:s})},{"es6-promise":59}],15:[function(e,t,i){"use strict";function r(e){if(o.call(this),this.source=e,this.base=e.uri||"//rest.ensembl.org",0===this.base.indexOf("//")){var t=window.location.protocol;"http:"==t||"https:"==t||(this.base="http:"+this.base)}this.species=e.species||"human","string"==typeof e.type?this.type=[e.type]:this.type=e.type||["regulatory"]}if("undefined"!=typeof e)var n=e("./sourceadapters"),s=n.registerSourceAdapterFactory,o=n.FeatureSourceBase,a=e("./das"),l=a.DASStylesheet,u=a.DASStyle,h=a.DASFeature,c=a.DASGroup;r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.getStyleSheet=function(e){var t=new l,i=new u;i.glyph="__NONE",this.type.indexOf("exon")>=0&&t.pushStyle({type:"transcript"},null,i),(this.type.indexOf("exon")>=0||this.type.indexOf("transcript")>=0)&&t.pushStyle({type:"gene"},null,i);var r=new u;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="red",r.HEIGHT=8,r.BUMP=!0,r.LABEL=!0,r.ZINDEX=10,t.pushStyle({type:"cds"},null,r);var n=new u;n.glyph="SQUARE",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="blue",t.pushStyle({type:"variation",method:".+_UTR_variant"},null,n);var n=new u;n.glyph="TRIANGLE",n.DIRECTION="S",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="blue",t.pushStyle({type:"variation",method:"missense_variant"},null,n);var n=new u;n.glyph="TRIANGLE",n.DIRECTION="N",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="blue",t.pushStyle({type:"variation",method:"splice_.+_variant"},null,n);var n=new u;n.glyph="STAR",n.POINTS=6,n.BUMP="yes",n.LABEL="no",n.FGCOLOR="blue",t.pushStyle({type:"variation",method:"regulatory_region_variant"},null,n);var n=new u;n.glyph="PLIMSOLL",n.BUMP="yes",n.LABEL="no",n.FGCOLOR="rgb(50,80,255)",n.STROKECOLOR="black",t.pushStyle({type:"variation"},null,n);var n=new u;n.glyph="SQUARE",n.BUMP="yes",n.LABEL="no",n.BGCOLOR="#888888",n.FGCOLOR="red",t.pushStyle({type:"indel",method:".+_UTR_variant"},null,n);var n=new u;n.glyph="TRIANGLE",n.DIRECTION="S",n.BUMP="yes",n.LABEL="no",n.BGCOLOR="#888888",n.FGCOLOR="red",t.pushStyle({type:"indel",method:"missense_variant"},null,n);var n=new u;n.glyph="TRIANGLE",n.DIRECTION="N",n.BUMP="yes",n.LABEL="no",n.BGCOLOR="#888888",n.FGCOLOR="red",t.pushStyle({type:"indel",method:"splice_.+_variant"},null,n);var n=new u;n.glyph="STAR",n.POINTS=6,n.BUMP="yes",n.LABEL="no",n.BGCOLOR="#888888",n.FGCOLOR="red",t.pushStyle({type:"indel",method:"regulatory_region_variant"},null,n);var n=new u;n.glyph="PLIMSOLL",n.BUMP="yes",n.LABEL="no",n.BGCOLOR="#888888",n.FGCOLOR="red",n.STROKECOLOR="black",t.pushStyle({type:"indel"},null,n);var s=new u;return s.glyph="BOX",s.FGCOLOR="black",s.BGCOLOR="orange",s.HEIGHT=8,s.BUMP=!0,s.LABEL=!0,s.ZINDEX=20,t.pushStyle({type:"default"},null,s),e(t)},r.prototype.getScales=function(){return[]},r.prototype.fetch=function(e,t,i,r,n,s,o){for(var a=this,l=this.base+"/overlap/region/"+this.species+"/"+e+":"+t+"-"+i,u=[],f=0;f<this.type.length;++f)u.push("feature="+this.type[f]);u.push("content-type=application/json"),l=l+"?"+u.join(";");var p=new XMLHttpRequest;p.onreadystatechange=function(){if(4==p.readyState)if(a.busy--,a.notifyActivity(),p.status>=300){var t="Error code "+p.status;try{var i=JSON.parse(p.response);i.error&&(t=i.error)}catch(r){}o(t,null)}else{for(var n=JSON.parse(p.response),s=[],l=0;l<n.length;++l){var u=n[l],f=[],d=new h;if(d.segment=e,d.min=0|u.start,d.max=0|u.end,d.type=u.feature_type||"unknown",d.id=u.ID,u.Parent){var g=new c;g.id=u.Parent,d.groups=[g]}u.strand&&(u.strand<0?d.orientation="-":u.strand>0&&(d.orientation="+")),u.consequence_type&&(d.method=u.consequence_type),u.alt_alleles&&(f.push("Alleles="+u.alt_alleles.join("/")),u.alt_alleles.length>1&&(u.alt_alleles[1].length!=u.alt_alleles[0].length||"-"==u.alt_alleles[1])&&(d.type="indel")),f.length>0&&(d.notes=f),s.push(d)}o(null,s)}},a.busy++,a.notifyActivity(),p.open("GET",l,!0),p.responseType="text",p.send()},r.prototype.capabilities=function(){var e={};return this.type&&this.type.indexOf("transcript")>=0&&(e.search=["gene"]),e},r.prototype.search=function(e,t){var i=this.base+"/lookup/symbol/"+this.species+"/"+e+"?content-type=application/json",r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){if(r.status>=300||r.status<200){var e="Error code "+r.status;try{var i=JSON.parse(r.response);i.error&&(e=i.error)}catch(n){}return 400==r.status?t([]):t(null,e)}var s=JSON.parse(r.response),o=[];return s&&s.seq_region_name&&o.push({segment:s.seq_region_name,min:s.start,max:s.end}),t(o)}},r.open("GET",i,!0),r.responseType="text",r.send()},s("ensembl",function(e){return{features:new r(e)}})},{"./das":10,"./sourceadapters":38}],16:[function(e,t,i){"use strict";if("undefined"!=typeof e)var r=e("./cbrowser"),n=r.Browser,s=e("./utils"),o=s.shallowCopy,a=e("./sha1"),l=a.hex_sha1,u=e("./das"),h=u.copyStylesheet;n.prototype.exportFullConfig=function(e){e=e||{};var t={chr:this.chr,viewStart:0|this.viewStart,viewEnd:0|this.viewEnd,cookieKey:"dalliance_"+l(Date.now()),coordSystem:this.coordSystem,sources:this.exportSourceConfig(),chains:this.exportChains()};return this.prefix&&(t.prefix=this.prefix),t},n.prototype.exportChains=function(){var e={},t=this.chains||{};for(var i in t)e[i]=t[i].exportConfig();return e},n.prototype.exportSourceConfig=function(e){e=e||{};for(var t=[],i=0;i<this.tiers.length;++i){var r=this.tiers[i],n=o(r.dasSource);n.noPersist||(n.coords=void 0,n.props=void 0,n.disabled||(n.disabled=void 0),r.config.stylesheet?(n.style=h(r.config.stylesheet).styles,n.stylesheet_uri=void 0):n.style&&(n.style=h({styles:n.style}).styles),"string"==typeof r.config.name&&(n.name=r.config.name),void 0!==r.config.height&&(n.forceHeight=r.config.height),void 0!==r.config.forceMin&&(n.forceMin=r.config.forceMin),r.config.forceMinDynamic&&(n.forceMinDynamic=r.config.forceMinDynamic),void 0!==r.config.forceMax&&(n.forceMax=r.config.forceMax),void 0!==r.config.bumped&&(n.bumped=r.config.bumped),r.config.forceMaxDynamic&&(n.forceMaxDynamic=r.config.forceMaxDynamic),t.push(n))}return t},n.prototype.exportPageTemplate=function(e){e=e||{};var t='<html>\n  <head>\n    <script language="javascript" src="'+this.resolveURL("$$dalliance-compiled.js")+'"></script>\n    <script language="javascript">\n      var dalliance_browser = new Browser('+JSON.stringify(this.exportFullConfig(e),null,2)+');\n    </script>\n  </head>\n  <body>\n    <div id="svgHolder">Dalliance goes here</div>\n  </body>\n<html>\n';return t}},{"./cbrowser":6,"./das":10,"./sha1":37,"./utils":55}],17:[function(e,t,i){"use strict";function r(e,t,i,r){e.fillText(t,i-e.measureText(t).width,r)}if("undefined"!=typeof e)var n=e("./cbrowser"),s=n.Browser,o=e("./glyphs"),a=o.OverlayLabelCanvas,l=e("./numformats"),u=l.formatQuantLabel,h=l.formatLongInt,c=e("./version"),f=e("./sequence-draw").drawSeqTierGC;s.prototype.exportImage=function(e){e=e||{};var t=e.width||this.featurePanelWidth,i=3,n=0;(e.banner||e.region)&&(n=40);var s=this.featurePanelWidth,o=this.scale;this.featurePanelWidth=t,this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart);for(var l=n,p=0;p<this.tiers.length;++p){p>0&&(l+=i);var d=this.tiers[p];if(d.backupSubtiers=d.subtiers,d.backupOriginHaxx=d.originHaxx,d.backupLayoutHeight=d.layoutHeight,d.subtiers){var g=this.getTierRenderer(d);if(g&&g.prepareSubtiers&&g.prepareSubtiers(d,d.viewport.getContext("2d")),d.subtiers){for(var v=d.padding,y=0;y<d.subtiers.length;++y)v=v+d.subtiers[y].height+d.padding;v+=6,d.layoutHeight=Math.max(v,this.minTierHeight)}}void 0!==d.layoutHeight&&(l+=d.layoutHeight)}var m=e.resolutionMultiplier||1,b=200,w=(t+b)*m|0,x=l*m|0,S=makeElement("canvas",null,{width:w,height:x}),_=S.getContext("2d");_.fillStyle="white",_.fillRect(0,0,w,x),_.scale(m,m),e.region&&(_.save(),_.fillStyle="black",_.font="12pt sans-serif",_.fillText(this.chr+":"+h(this.viewStart)+".."+h(this.viewEnd),b+100,28),_.restore()),e.banner&&(_.save(),_.fillStyle="black",_.font="12pt sans-serif",r(_,"Graphics from Biodalliance "+c,b+t-100,28),_.restore()),_.font="10px sans-serif";for(var p=0;p<this.tiers.length;++p){var d=this.tiers[p],T=(d.glyphCacheOrigin-this.viewStart)*this.scale,C=new a;_.save(),_.translate(0,n),_.save(),_.beginPath(),_.moveTo(b,0),_.lineTo(b+t,0),_.lineTo(b+t,d.layoutHeight),_.lineTo(b,d.layoutHeight),_.closePath(),_.clip(),_.translate(b,0),_.save(),_.translate(T,0),d.subtiers?d.paintToContext(_,C,T+1e3):f(d,d.currentSequence,_),_.restore(),_.save(),_.translate(T,0),C.draw(_,-T,t-T),_.restore(),_.restore();for(var k=!1,L=0,O=d.subtiers||[],A=0;A<O.length;++A){var E=O[A];if(E.quant){k=!0;var R=E.quant,M=E.height,B=2;M>40&&(B=1+(M/20|0));var I=M/(B-1),P=(R.max-R.min)/(B-1);_.beginPath(),_.moveTo(b+5,L),_.lineTo(b,L),_.lineTo(b,L+E.height),_.lineTo(b+5,L+E.height);for(var H=1;B-1>H;++H){var N=H*I;_.moveTo(b,L+N),_.lineTo(b+3,L+N)}_.strokeStyle="black",_.strokeWidth=2,_.stroke(),_.fillStyle="black",r(_,u(R.max),b-3,L+7),r(_,u(R.min),b-3,L+E.height);for(var H=1;B-1>H;++H){var N=H*I;r(_,u(1*R.max-H*P),b-3,L+N+3)}}L+=E.height+i}var F;F="string"==typeof d.config.name?d.config.name:d.dasSource.name;var G=_.measureText(F).width;_.fillStyle="black",_.fillText(F,b-(k?28:12)-G,(d.layoutHeight+3)/2),_.restore(),n+=d.layoutHeight+i,d.subtiers=d.backupSubtiers,d.originHaxx=d.backupOriginHaxx,d.layoutHeight=d.backupLayoutHeight}if(e.highlights){_.save(),_.beginPath(),_.moveTo(b,0),_.lineTo(b+t,0),_.lineTo(b+t,n),_.lineTo(b,n),_.closePath(),_.clip(),_.translate(b+T,0);for(var D=this.viewStart,q=this.viewStart,U=this.viewEnd,z=0;z<this.highlights.length;++z){var M=this.highlights[z];(M.chr===this.chr||M.chr==="chr"+this.chr)&&M.min<U&&M.max>q&&(_.globalAlpha=this.defaultHighlightAlpha,_.fillStyle=this.defaultHighlightFill,_.fillRect((M.min-D)*this.scale,0,(M.max-M.min)*this.scale,n))}_.restore()}var j=-1;return"center"==e.ruler?j=b+(this.viewEnd-this.viewStart+1)*this.scale/2:"left"==e.ruler?j=b:"right"==e.ruler&&(j=b+(this.viewEnd-this.viewStart+1)*this.scale),j>=0&&(_.strokeStyle="blue",_.beginPath(),_.moveTo(j,0),_.lineTo(j,n),_.stroke()),this.featurePanelWidth=s,this.scale=o,S.toDataURL("image/png")}},{"./cbrowser":6,"./glyphs":23,"./numformats":29,"./sequence-draw":35,"./version":57}],18:[function(e,t,i){"use strict";if("undefined"!=typeof e)var r=e("./cbrowser"),n=r.Browser,s=e("./utils"),o=s.makeElement,a=s.removeChildren;n.prototype.openExportPanel=function(){var e=this;if("export"===this.uiMode)this.hideToolPanel(),this.setUiMode("none");else{var t=o("div",null,{className:"export-form"}),i=o("select");i.appendChild(o("option","SVG",{value:"svg"})),i.appendChild(o("option","Image",{value:"png"})),i.appendChild(o("option","Dalliance config",{value:"config"})),i.appendChild(o("option","Dalliance sources",{value:"sources"})),i.appendChild(o("option","Dalliance page",{value:"page"})),i.value="svg",i.addEventListener("change",function(e){a(f),w()},!1),t.appendChild(o("p",["Export as: ",i]));var r=o("input",null,{type:"checkbox",checked:this.exportHighlights});r.addEventListener("change",function(t){e.exportHighlights=r.checked,e.storeStatus()},!1);var n=o("input",null,{type:"checkbox",checked:this.exportRuler});n.addEventListener("change",function(t){e.exportRuler=n.checked,e.storeStatus()},!1);var s=o("input",null,{type:"checkbox",checked:this.exportRegion});s.addEventListener("change",function(t){e.exportRegion=s.checked,e.storeStatus()},!1);var l=o("input",null,{type:"checkbox",checked:this.exportBanner});l.addEventListener("change",function(t){e.exportBanner=l.checked,e.storeStatus()},!1);var u=o("input",null,{type:"text",value:"1.0"}),h=o("input",null,{type:"text",value:"800"}),c=o("button","Export",{className:"btn btn-primary"});c.addEventListener("click",function(t){a(f);var s,l,c,p;if("svg"===i.value)s=URL.createObjectURL(e.makeSVG({highlights:r.checked,banner:e.exportBanner,region:e.exportRegion,ruler:n.checked?e.rulerLocation:"none",width:parseInt(h.value)||800})),l="SVG",c="image/svg",p="dalliance-view.svg";else if("png"===i.value){var d=parseFloat(u.value);if(.1>d||d>10)return void alert("bad scale "+d);s=e.exportImage({highlights:r.checked,banner:e.exportBanner,region:e.exportRegion,ruler:n.checked?e.rulerLocation:"none",resolutionMultiplier:d,width:parseInt(h.value)||800}),l="Image",c="image/png",p="dalliance-view.png"}else if("config"===i.value){var g=JSON.stringify(e.exportFullConfig(),null,2),v=new Blob([g],{type:"text/plain"});s=URL.createObjectURL(v),l="Configuration",c="text/plain",p="dalliance-config.json"}else if("sources"===i.value){var g=JSON.stringify(e.exportSourceConfig(),null,2),v=new Blob([g],{type:"text/plain"});s=URL.createObjectURL(v),l="Source array",c="text/plain",p="dalliance-sources.json"}else if("page"===i.value){var y=e.exportPageTemplate(),c="text/html",v=new Blob([y],{type:c});s=URL.createObjectURL(v),l="Page template",p="dalliance-view.html"}if(s){var m=o("a","[Download]",{href:s,download:p,type:c}),b=o("a","[Preview in browser]",{href:s,type:c,target:"_new"});f.appendChild(o("p",[""+l+" created: ",m,b]))}},!1),e.addViewListener(function(){a(f)}),e.addTierListener(function(){a(f)});var f=o("p",""),p=o("tr",[o("th","Include highlights",{},{width:"400px",textAlign:"right"}),o("td",r)]),d=o("tr",[o("th","Include vertical guideline",{},{textAlign:"right"}),o("td",n)]),g=o("tr",[o("th","Scale multiplier",{},{textAlign:"right"}),o("td",u)]),v=o("tr",[o("th","Width (logical px)",{},{textAlign:"right"}),o("td",h)]),y=o("tr",[o("th","Label with genomic coordinates",{},{textAlign:"right"}),o("td",s)]),m=o("tr",[o("th","Include banner",{},{textAlign:"right"}),o("td",l)]),b=o("table",[p,d,v,g,y],null,{width:"500px"}),w=function(){var e=i.value;p.style.display="svg"==e||"png"==e?"table-row":"none",d.style.display="svg"==e||"png"==e?"table-row":"none",g.style.display="png"==e?"table-row":"none",v.style.display="svg"==e||"png"==e?"table-row":"none",y.style.display="svg"==e||"png"==e?"table-row":"none",m.style.display="svg"==e||"png"==e?"table-row":"none"};w(),t.appendChild(b),t.appendChild(c),t.appendChild(f),"none"!==this.uiMode&&this.hideToolPanel(),this.browserHolder.insertBefore(t,this.svgHolder),this.activeToolPanel=t,this.setUiMode("export")}}},{"./cbrowser":6,"./utils":55}],19:[function(e,t,i){"use strict";var r=e("./cbrowser"),n=e("./chainset"),s=e("./sourceadapters"),o=e("./utils"),a=e("./das"),l=e("./sourcecompare");window.Browser=r.Browser,window.sourcesAreEqual=l.sourcesAreEqual,window.Chainset=n.Chainset,window.makeElement=o.makeElement,window.dalliance_registerSourceAdapterFactory=s.registerSourceAdapterFactory,window.dalliance_registerParserFactory=s.registerParserFactory,window.dalliance_makeParser=s.makeParser,window.DASSequence=a.DASSequence,window.DASFeature=a.DASFeature,window.DASGroup=a.DASGroup,window.DASStylesheet=a.DASStylesheet,window.DASStyle=a.DASStyle,window.DASSource=a.DASSource;var u=e("./rulers");window.Ruler=u.Ruler,window.rulerDrawCallback=u.rulerDrawCallback},{"./cbrowser":6,"./chainset":7,"./das":10,"./rulers":32,"./sourceadapters":38,"./sourcecompare":39,"./utils":55}],20:[function(e,t,i){"use strict";function r(){this.glyphs=[],this.height=0,this.quant=null}if("undefined"!=typeof e)var n=e("./tier"),s=n.DasTier,o=e("./numformats"),a=o.formatQuantLabel;r.prototype.indexFor=function(e){for(var t=e.min(),i=0,r=this.glyphs.length;r>i;){var n=(i+r)/2|0;if(n>=this.glyphs.length)return this.glyphs.length;var s=this.glyphs[n];t<s.min()?r=n:i=n+1}return r},r.prototype.add=function(e){var t=this.indexFor(e);this.glyphs.splice(t,0,e),this.height=Math.max(this.height,e.height()),e.quant&&null==this.quant&&(this.quant=e.quant)},r.prototype.hasSpaceFor=function(e){var t=this.indexFor(e);return t>0&&this.glyphs[t-1].max()>=e.min()?!1:t<this.glyphs.length&&this.glyphs[t].min()<=e.max()?!1:!0},s.prototype.paintToContext=function(e,t,i){var r=this.subtiers,n=0|this.viewport.width;e.save();for(var s=0;s<r.length;++s){for(var o=null,a=r[s].glyphs,l=0;l<a.length;++l){var u=a[l];if(u.min()<n-i&&u.max()>-i){var u=a[l];u.draw(e,t),u.quant&&(o=u.quant)}}if(o&&o.min<0&&o.max>0&&this.dasSource.zeroLine){var h=r[0].height*(o.max/(o.max-o.min));e.save(),e.strokeStyle=this.dasSource.zeroLine,e.lineWidth=.5,e.beginPath(),e.moveTo(-1e3,h),e.lineTo(n+1e3,h),e.stroke(),e.restore()}if(this.scaleVertical){var c=this.browser.scale;e.translate(0,c+this.padding),t.translate(0,c+this.padding)}else e.translate(0,r[s].height+this.padding),t.translate(0,r[s].height+this.padding)}if(e.restore(),o&&this.quantLeapThreshold&&this.featureSource&&this.browser.sourceAdapterIsCapable(this.featureSource,"quantLeap")){var h=r[0].height*(1-(this.quantLeapThreshold-o.min)/(o.max-o.min));e.save(),e.strokeStyle="red",e.lineWidth=.3,e.beginPath(),e.moveTo(-1e3,h),e.lineTo(n+1e3,h),e.stroke(),e.restore()}},s.prototype.paintQuant=function(){if(this.quantOverlay){var e,t=this.browser.retina&&window.devicePixelRatio>1;if(this.subtiers&&this.subtiers.length>0&&(e=this.subtiers[0].quant),e){var i=this.subtiers[0].height,r=50;this.quantOverlay.height=this.viewport.height,this.quantOverlay.width=t?2*r:r,this.quantOverlay.style.height=""+(t?this.quantOverlay.height/2:this.quantOverlay.height)+"px",this.quantOverlay.style.width=""+r+"px",this.quantOverlay.style.display="block";var n=this.quantOverlay.getContext("2d");t&&n.scale(2,2);var s=2;i>40&&(s=1+(i/20|0));var o=(i+2*this.padding)/(s-1),l=(e.max-e.min)/(s-1);if(n.fillStyle="white",n.globalAlpha=.6,"right"==this.browser.rulerLocation?n.fillRect(r-30,0,30,i+2*this.padding):n.fillRect(0,0,30,i+2*this.padding),n.globalAlpha=1,n.strokeStyle="black",n.lineWidth=1,n.beginPath(),"right"==this.browser.rulerLocation){n.moveTo(r-8,this.padding),n.lineTo(r,this.padding),n.lineTo(r,i+this.padding),n.lineTo(r-8,i+this.padding);for(var u=1;s-1>u;++u){var h=u*o;n.moveTo(r,h),n.lineTo(r-5,h)}}else{n.moveTo(8,this.padding),n.lineTo(0,this.padding),n.lineTo(0,i+this.padding),n.lineTo(8,i+this.padding);for(var u=1;s-1>u;++u){var h=u*o;n.moveTo(0,h),n.lineTo(5,h)}}if(n.stroke(),n.fillStyle="black","right"==this.browser.rulerLocation){n.textAlign="right",n.fillText(a(e.max),r-9,8),n.fillText(a(e.min),r-9,i+this.padding);for(var u=1;s-1>u;++u){var h=u*o;n.fillText(a(1*e.max-u*l),r-9,h+3)}}else{n.textAlign="left",n.fillText(a(e.max),9,8),n.fillText(a(e.min),9,i+this.padding);for(var u=1;s-1>u;++u){var h=u*o;n.fillText(a(1*e.max-u*l),9,h+3)}}}else this.quantOverlay.style.display="none"}},s.prototype.styleForFeature=function(e){var t=this.browser.zoomForCurrentScale();if(!this.stylesheet)return null;for(var i=null,r=this.stylesheet.styles,n=0;n<r.length;++n){var s=r[n];if(!(s.zoom&&s.zoom!=t||s.orientation&&s.orientation!=e.orientation)){var o=s._labelRE;if(o&&o.test||(o=new RegExp("^"+s.label+"$"),s._labelRE=o),!s.label||o.test(e.label)){var a=s._methodRE;if(a&&a.test||(a=new RegExp("^"+s.method+"$"),s._methodRE=a),!s.method||a.test(e.method)){if(s.type){if("default"==s.type){i||(i=s.style);continue}var l=s._typeRE;if(l&&l.test||(l=new RegExp("^"+s.type+"$"),s._typeRE=l),!l.test(e.type))continue}return s.style}}}}return i},s.prototype.quantMin=function(e){if(this.forceMinDynamic)return this.currentFeaturesMinScore||0;if("number"==typeof this.forceMin)return this.forceMin;var t="undefined"!=typeof e.SOFTMIN?e.SOFTMIN:Number.MAX_VALUE;return e.MIN||Math.min(t,this.currentFeaturesMinScore||0)},s.prototype.quantMax=function(e){if(this.forceMaxDynamic)return this.currentFeaturesMaxScore||0;if("number"==typeof this.forceMax)return this.forceMax;var t="undefined"!=typeof e.SOFTMAX?e.SOFTMAX:Number.MIN_VALUE;return e.MAX||Math.max(t,this.currentFeaturesMaxScore||0)},"undefined"!=typeof t&&(t.exports={SubTier:r})},{"./numformats":29,"./tier":51}],21:[function(e,t,i){"use strict";function r(e,t,i){var r=l(i.type,t.type),n=l(i.label,t.label,i.id,t.id);n&&0!=n.indexOf("__dazzle")&&(r=r+": "+n),this.hit=e,this.feature=t,this.group=i,this.title=r,this.sections=[]}function n(e,t){var i=[];if(e)for(var r=0;r<e.length;++r)u(i,e[r]);if(t)for(var r=0;r<t.length;++r)u(i,t[r]);return i}if("undefined"!=typeof e)var s=e("./cbrowser"),o=s.Browser,a=e("./utils"),l=a.pick,u=a.pushnew,h=a.makeElement;var c=new RegExp("^([A-Za-z_-]+)=(.+)");o.prototype.addFeatureInfoPlugin=function(e){this.featureInfoPlugins||(this.featureInfoPlugins=[]),this.featureInfoPlugins.push(e)},r.prototype.setTitle=function(e){this.title=e},r.prototype.add=function(e,t){"string"==typeof t&&(t=h("span",t)),this.sections.push({label:e,info:t})},o.prototype.featurePopup=function(e,t,i,s){var o=i.length,a=--o>=0?i[o]:{},l=--o>=0?i[o]:{},u=new r(i,a,l);u.tier=s;for(var f=this.featureInfoPlugins||[],p=0;p<f.length;++p)try{f[p](a,u)}catch(d){console.log(d.stack||d)}for(f=s.featureInfoPlugins||[],p=0;p<f.length;++p)try{f[p](a,u)}catch(d){console.log(d.stack||d)}this.removeAllPopups();var g=h("table",null,{className:"table table-striped table-condensed"});g.style.width="100%",g.style.margin="0px";var v=0;if(a.method&&!s.dasSource.suppressMethod){var y=h("tr",[h("th","Method"),h("td",a.method)]);g.appendChild(y),++v}var m;m=l.segment?l:a;var y=h("tr",[h("th","Location"),h("td",m.segment+":"+m.min+"-"+m.max,{},{minWidth:"200px"})]);if(g.appendChild(y),++v,void 0!==a.score&&null!==a.score&&"-"!=a.score&&!a.suppressScore&&!s.dasSource.suppressScore){var y=h("tr",[h("th","Score"),h("td",""+a.score)]);g.appendChild(y),++v}var b=n(l.links,a.links);if(b&&b.length>0){var y=h("tr",[h("th","Links"),h("td",b.map(function(e){return h("div",h("a",e.desc,{href:e.uri,target:"_new"}))}))]);g.appendChild(y),++v}for(var w=n(l.notes,a.notes),x=0;x<w.length;++x){var S="Note",_=w[x],T=_.match(c);T&&(S=T[1],_=T[2]);var y=h("tr",[h("th",S),h("td",_)]);g.appendChild(y),++v}for(var C=0;C<u.sections.length;++C){var k=u.sections[C];g.appendChild(h("tr",[h("th",k.label),h("td",k.info)]))}this.popit(e,u.title||"Feature",g,{width:450})}},{"./cbrowser":6,"./utils":55}],22:[function(e,t,i){"use strict";function r(e){for(var t,i,r,n=e.browser.drawnStart,a=e.browser.drawnEnd,l={},u={},h={},c={},f={},p={},d={},g={},v=[],y=function(){r={};for(var t=0;t<e.currentFeatures.length;++t){var i=e.currentFeatures[t];i.id&&(r[i.id]=i)}},m=function(e){var t=[];if(e.parents)for(var i=0;i<e.parents.length;++i){var n=e.parents[i],s=r[n];s&&"SO:0000704"==s.typeCv&&pushnew(t,n)}return t},b=0;b<e.currentFeatures.length;++b){var w=e.currentFeatures[b];if(!w.parts){var x=w.min<=a&&w.max>=n;if(w.min&&w.max){if(w.score&&"."!=w.score&&"-"!=w.score){var S=1*w.score;(!t||t>S)&&(t=S),(!i||S>i)&&(i=S)}var _=[],T=null;if(w.groups)for(var C=0;C<w.groups.length;++C){var k=w.groups[C],L=k.id;if("gene"==k.type)T=L,p[L]=k;else if("translation"==k.type);else{s(u,L,w),p[L]=k,_.push(L);var O=c[L];(!O||w.min<O)&&(c[L]=w.min),O=f[L],(!O||w.max>O)&&(f[L]=w.max)}}if(w.parents){r||y();for(var A=0;A<w.parents.length;++A){var E=w.parents[A],R=r[E];if(R){R.parts||(R.parts=[w]),o(u,E,R),s(u,E,w),p[E]||(p[E]={type:R.type,id:R.id,label:R.label||R.id}),_.push(E);var O=c[E];(!O||w.min<O)&&(c[E]=w.min),O=f[E],(!O||w.max>O)&&(f[E]=w.max);var M=m(R);if(M.length>0){T=M[0];var B=r[M[0]];p[M[0]]={type:B.type,id:B.id,label:B.label||B.id},e.dasSource.collapseSuperGroups||(e.dasSource.collapseSuperGroups=!0)}}}}if(0==_.length)x&&s(l,w.type,w);else if(T)for(var k=0;k<_.length;++k){var L=_[k];o(d,T,L),g[L]=T}}else v.push(w)}}for(var L in u){var I=p[L];"number"!=typeof I.min&&(I.min=c[L]),"number"!=typeof I.max&&(I.max=f[L]),f[L]>=n&&c[L]<=a&&(h[L]=u[L])}e.ungroupedFeatures=l,e.groupedFeatures=h,e.groups=p,e.superGroups=d,e.groupsToSupers=g,t&&(t>0?t=0:0>i&&(i=0),e.currentFeaturesMinScore=t,e.currentFeaturesMaxScore=i)}if("undefined"!=typeof e)var n=e("./utils"),s=n.pusho,o=n.pushnewo;"undefined"!=typeof t&&(t.exports={sortFeatures:r})},{"./utils":55}],23:[function(e,t,i){"use strict";function r(e,t){this._stroke=e,this._fill=t}function n(e,t,i,r,n,s,o,a){this.x=e,this.y=t,this._width=i,this._height=r,this.fill=n,this.stroke=s,this._alpha=o,this._radius=a||0}function s(e,t){this.glyphs=e,this.connector=t,this.h=e[0].height();for(var i=[],r=0;r<e.length;++r){var n=e[r];i.push(new M(n.min(),n.max())),this.h=Math.max(this.h,n.height())}this.coverage=R(i)}function o(e,t,i){this.points=e,this.color=t,this._height=i||50}function a(e,t,i,r,n,s,o){this.glyph=t,this.text=i,this.anchor=n||"left",this.align=s||"below",o&&(this.font=o),this.font&&(e.save(),e.font=this.font);var a=e.measureText(i);this.font&&e.restore(),this.textLen=a.width,this.textHeight=5,this.bump=t.bump,this.measured=!r}function l(e,t,i){this._x=e,this._height=t,this._stroke=i}function u(e,t,i){this._x=e,this._height=t,this._stroke=i}function h(e,t,i,n,s,o){r.call(this,o,s),this._x=e,this._height=t,this._dir=i,this._width=n}function c(e,t,i,r){this._x=e,this._height=t,this._fill=i,this._stroke=r}function f(e,t,i){this.glyph=e,this._min=t,this._max=i,e&&(this.bump=e.bump)}function p(e,t,i,n,s,o){r.call(this,s,n),this._min=e,this._max=t,this._height=i,this._ori=o}function d(e,t,i,n){r.call(this,n,null),this._min=e,this._max=t,this._height=i}function g(e,t,i,r,n,s){this._min=e,this._max=t,this._height=i,this._style=r,this._strand=n,this._stroke=s}function v(e,t,i,r,n){this._min=e,this._max=t,this._height=i,this._fill=r,this._stroke=n}function y(e,t,i,n,s,o,a){r.call(this,null,n),this._min=e,this._max=t,this._height=i,this._color=n,this._parallel=s,this._sw=o,this._ne=a}function m(e,t,i,r,n){this._min=e,this._max=t,this._height=i,this._fill=r,this._stroke=n}function b(e,t,i,r,n,s){this._min=t,this._max=i,this._height=r,this._fill=n,this._string=s,this._textLen=e.measureText(s).width}function w(e,t,i){var r,n={red:"darkred",purple:"mediumpurple",blue:"darkblue",green:"darkgreen"},s=n[i.toLowerCase()];return r=s?[i,s]:["rgb(73, 68, 149)","rgb(9, 0, 103)"],"?"==e?"black":"M"==e?"greenyellow":"*"==e?"crimson":r[t%2]}function x(e){for(var t={A:"T",T:"A",G:"C",C:"G"},i=e.split("").reverse().join(""),r=[],n=0;n<i.length;++n){var s=i.substr(n,1).toUpperCase();r.push(s in t?t[s]:"N")}return r.join("")}function S(e,t,i,r,n,s,o){this._min=e,this._max=t,this._height=i,this._fill=r,this._seq=n,this._orientation=s,this._readframe=o}function _(e,t,i,r,n,s,o,a,l,u,h){this.baseColors=e,this._strandColor=t,this._min=i,this._max=r,this._height=n,this._seq=s,this._ref=o,this._scheme=a,this._quals=l,this._fillbg=u,this._scaleVertical=h}function T(e,t,i,r){this.glyph=e,this._height=r,this._x=t,this._y=i}function C(e,t,i,r){this._x=e,this._y=t,this._height=i,this._fill=r}function k(e,t,i){this._height=e||50,this.yOffset=t||0,this.spacing=i||10}function L(e,t,i,n,s){r.call(this,s,n),this._x=e,this._r=t,this._points=i}function O(e,t,i,r,n){this._x=e,this._height=t,this._overhang=i,this._fill=r,this._stroke=n,this._hh=t/2}function A(){this.ox=0,this.oy=0,this.glyphs=[]}if("undefined"!=typeof e)var E=e("./spans"),R=E.union,M=E.Range,B=e("./utils"),I=B.makeElementNS,P=B.AMINO_ACID_TRANSLATION,H=e("./svg-utils"),N=H.NS_SVG,F=(H.NS_XLINK,H.SVGPath);r.prototype.draw=function(e){e.beginPath(),this.drawPath(e),this._fill&&(e.fillStyle=this._fill,e.fill()),this._stroke&&(e.strokeStyle=this._stroke,e.stroke())},r.prototype.toSVG=function(){var e=new F;return this.drawPath(e),I(N,"path",null,{d:e.toPathData(),fill:this._fill||"none",stroke:this._stroke||"none"})},r.prototype.drawPath=function(e){throw"drawPath method on PathGlyphBase must be overridden"},n.prototype.draw=function(e){var t=this._radius;t>0?(e.beginPath(),e.moveTo(this.x+t,this.y),e.lineTo(this.x+this._width-t,this.y),e.arcTo(this.x+this._width,this.y,this.x+this._width,this.y+t,t),e.lineTo(this.x+this._width,this.y+this._height-t),e.arcTo(this.x+this._width,this.y+this._height,this.x+this._width-t,this.y+this._height,t),e.lineTo(this.x+t,this.y+this._height),e.arcTo(this.x,this.y+this._height,this.x,this.y+this._height-t,t),e.lineTo(this.x,this.y+t),e.arcTo(this.x,this.y,this.x+t,this.y,t),e.closePath(),null!=this._alpha&&(e.save(),e.globalAlpha=this._alpha),this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=.5,e.stroke()),null!=this._alpha&&e.restore()):(null!=this._alpha&&(e.save(),e.globalAlpha=this._alpha),this.fill&&(e.fillStyle=this.fill,e.fillRect(this.x,this.y,this._width,this._height)),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=.5,e.strokeRect(this.x,this.y,this._width,this._height)),null!=this._alpha&&e.restore())},n.prototype.toSVG=function(){var e=I(N,"rect",null,{x:this.x,y:this.y,width:this._width,height:this._height,stroke:this.stroke||"none",strokeWidth:.5,fill:this.fill||"none"});return null!=this._alpha&&e.setAttribute("opacity",this._alpha),e},n.prototype.min=function(){return this.x},n.prototype.max=function(){return this.x+this._width},n.prototype.height=function(){return this.y+this._height},s.prototype.drawConnectors=function(e){for(var t=this.coverage.ranges(),i=1;i<t.length;++i){var r=t[i],n=t[i-1];if(n&&r.min()>n.max()){var s=n.max(),o=r.min(),a=(s+o)/2;"hat+"===this.connector?(e.moveTo(s,this.h/2),e.lineTo(a,0),e.lineTo(o,this.h/2)):"hat-"===this.connector?(e.moveTo(s,this.h/2),e.lineTo(a,this.h),e.lineTo(o,this.h/2)):"collapsed+"===this.connector?(e.moveTo(s,this.h/2),e.lineTo(o,this.h/2),o-s>4&&(e.moveTo(a-2,this.h/2-3),e.lineTo(a+2,this.h/2),e.lineTo(a-2,this.h/2+3))):"collapsed-"===this.connector?(e.moveTo(s,this.h/2),e.lineTo(o,this.h/2),o-s>4&&(e.moveTo(a+2,this.h/2-3),e.lineTo(a-2,this.h/2),e.lineTo(a+2,this.h/2+3))):(e.moveTo(s,this.h/2),e.lineTo(o,this.h/2))}n=r}},s.prototype.draw=function(e,t){for(var i=0;i<this.glyphs.length;++i){var r=this.glyphs[i];r.draw(e,t)}e.strokeStyle="black",e.beginPath(),this.drawConnectors(e),e.stroke()},s.prototype.toSVG=function(){for(var e=I(N,"g"),t=0;t<this.glyphs.length;++t)e.appendChild(this.glyphs[t].toSVG());var i=new F;this.drawConnectors(i);var r=i.toPathData();if(r.length>0){var n=I(N,"path",null,{d:i.toPathData(),fill:"none",stroke:"black",strokeWidth:.5});e.appendChild(n)}return e},s.prototype.min=function(){return this.coverage.min()},s.prototype.max=function(){return this.coverage.max()},s.prototype.height=function(){return this.h},o.prototype.min=function(){return this.points[0].x},o.prototype.max=function(){return this.points[this.points.length-1].x},o.prototype.height=function(){return this._height},o.prototype.draw=function(e){e.save(),e.strokeStyle=this.color,e.lineWidth=2,e.beginPath(),this.points.forEach(function(t,i){0===i?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)}),e.stroke(),e.restore()},o.prototype.toSVG=function(){for(var e=new F,t=0;t<this.points.length;++t){var i=this.points[t].x,r=this.points[t].y;0==t?e.moveTo(i,r):e.lineTo(i,r)}return I(N,"path",null,{d:e.toPathData(),fill:"none",stroke:this.color,strokeWidth:"2px"})},a.prototype.toSVG=function(){
var e=this.glyph.toSVG(),t={};return"above"==this.align?(e=I(N,"g",e,{transform:"translate(0, "+(2|this.textHeight)+")"}),t.y=this.textHeight):t.y=this.glyph.height()+15,this.font&&(t.fontSize=7),"center"==this.anchor?t.x=(this.glyph.min()+this.glyph.max()-this.textLen)/2:t.x=this.glyph.min(),I(N,"g",[e,I(N,"text",this.text,t)])},a.prototype.min=function(){return this.glyph.min()},a.prototype.max=function(){return this.measured?Math.max(this.glyph.max(),1*this.glyph.min()+this.textLen+10):this.glyph.max()},a.prototype.height=function(){var e=this.glyph.height();return this.measured&&(e+="above"==this.align?this.textHeight+2:20),e},a.prototype.draw=function(e,t){"above"==this.align&&(e.save(),e.translate(0,this.textHeight+2)),this.glyph.draw(e),"above"==this.align&&e.restore(),t.registerGlyph(this)},a.prototype.drawOverlay=function(e,t,i){e.fillStyle="black",this.font&&(e.save(),e.font=this.font);var r;"center"==this.anchor?r=(this.glyph.min()+this.glyph.max()-this.textLen)/2:(r=this.glyph.min(),t>r&&(r=Math.min(t,this.glyph.max()-this.textLen))),e.fillText(this.text,r,"above"==this.align?this.textHeight:this.glyph.height()+15),this.font&&e.restore()},l.prototype.draw=function(e){var t=this._height/2;e.beginPath(),e.moveTo(this._x,0),e.lineTo(this._x,this._height),e.moveTo(this._x-t,t),e.lineTo(this._x+t,t),e.strokeStyle=this._stroke,e.lineWidth=1,e.stroke()},l.prototype.toSVG=function(){var e=this._height/2,t=new F;return t.moveTo(this._x,0),t.lineTo(this._x,this._height),t.moveTo(this._x-e,e),t.lineTo(this._x+e,e),I(N,"path",null,{d:t.toPathData(),fill:"none",stroke:this._stroke,strokeWidth:"1px"})},l.prototype.min=function(){return this._x-this._height/2},l.prototype.max=function(){return this._x+this._height/2},l.prototype.height=function(){return this._height},u.prototype.draw=function(e){var t=this._height/2;e.beginPath(),e.moveTo(this._x-t,0),e.lineTo(this._x+t,this._height),e.moveTo(this._x-t,this._height),e.lineTo(this._x+t,0),e.strokeStyle=this._stroke,e.lineWidth=1,e.stroke()},u.prototype.toSVG=function(){var e=this._height/2,t=new F;return t.moveTo(this._x-e,0),t.lineTo(this._x+e,this._height),t.moveTo(this._x-e,this._height),t.lineTo(this._x+e,0),I(N,"path",null,{d:t.toPathData(),fill:"none",stroke:this._stroke,strokeWidth:"1px"})},u.prototype.min=function(){return this._x-this._height/2},u.prototype.max=function(){return this._x+this._height/2},u.prototype.height=function(){return this._height},h.prototype=Object.create(r.prototype),h.prototype.drawPath=function(e){var t=this._height/2,i=this._width/2;"S"===this._dir?(e.moveTo(this._x,this._height),e.lineTo(this._x-i,0),e.lineTo(this._x+i,0)):"W"===this._dir?(e.moveTo(this._x+i,t),e.lineTo(this._x-i,0),e.lineTo(this._x-i,this._height)):"E"===this._dir?(e.moveTo(this._x-i,t),e.lineTo(this._x+i,0),e.lineTo(this._x+i,this._height)):(e.moveTo(this._x,0),e.lineTo(this._x+i,this._height),e.lineTo(this._x-i,this._height)),e.closePath()},h.prototype.min=function(){return this._x-this._height/2},h.prototype.max=function(){return this._x+this._height/2},h.prototype.height=function(){return this._height},c.prototype.draw=function(e){var t=this._height/2;e.fillStyle=this._stroke,e.beginPath(),e.arc(this._x,t,t,0,6.29),this._fill&&(e.fillStyle=this._fill,e.fill()),this._stroke&&(e.strokeStyle=this._stroke,e.stroke())},c.prototype.toSVG=function(){var e=this._height/2;return I(N,"circle",null,{cx:this._x,cy:e,r:e,fill:this._fill||"none",stroke:this._stroke||"none",strokeWidth:"1px"})},c.prototype.min=function(){return this._x-this._height/2},c.prototype.max=function(){return this._x+this._height/2},c.prototype.height=function(){return this._height},f.prototype.draw=function(e,t){this.glyph&&this.glyph.draw(e,t)},f.prototype.toSVG=function(){return this.glyph?this.glyph.toSVG():I(N,"g")},f.prototype.min=function(){return this._min},f.prototype.max=function(){return this._max},f.prototype.height=function(){return this.glyph?this.glyph.height():1},p.prototype=Object.create(r.prototype),p.prototype.min=function(){return this._min},p.prototype.max=function(){return this._max},p.prototype.height=function(){return this._height},p.prototype.drawPath=function(e){var t=this._max,i=this._min,r=this._height,n=0,s=0,o=this._height+2,a=.333333*this._height,l=0;this._ori&&("+"===this._ori?s=.5*this._height:"-"===this._ori&&(n=.5*this._height)),o>t-i&&(i=(t+i-o)/2,t=i+o),e.moveTo(i+n,l+a),e.lineTo(t-s,l+a),e.lineTo(t-s,l),e.lineTo(t,l+this._height/2),e.lineTo(t-s,l+r),e.lineTo(t-s,l+a+a),e.lineTo(i+n,l+a+a),e.lineTo(i+n,l+r),e.lineTo(i,l+r/2),e.lineTo(i+n,l),e.lineTo(i+n,l+a)},d.prototype=Object.create(r.prototype),d.prototype.min=function(){return this._min},d.prototype.max=function(){return this._max},d.prototype.height=function(){return this._height},d.prototype.drawPath=function(e){var t=this._min,i=this._max,r=this._height,n=r/2;e.moveTo(t,n),e.lineTo(i,n),e.moveTo(t,0),e.lineTo(t,r),e.moveTo(i,0),e.lineTo(i,r)},g.prototype.min=function(){return this._min},g.prototype.max=function(){return this._max},g.prototype.height=function(){return this._height},g.prototype.drawPath=function(e){var t=this._min,i=this._max,r=this._height,n=r/2;"hat"===this._style?(e.moveTo(t,n),e.lineTo((t+i)/2,"-"===this._strand?r:0),e.lineTo(i,n)):(e.moveTo(t,n),e.lineTo(i,n))},g.prototype.draw=function(e){e.beginPath(),this.drawPath(e),e.strokeStyle=this._stroke,"dashed"===this._style&&e.setLineDash?(e.save(),e.setLineDash([3]),e.stroke(),e.restore()):e.stroke()},g.prototype.toSVG=function(){var e=new F;this.drawPath(e);var t={d:e.toPathData(),stroke:this._stroke||"none"};return"dashed"===this._style&&(t.strokeDasharray="3"),I(N,"path",null,t)},v.prototype.min=function(){return this._min},v.prototype.max=function(){return this._max},v.prototype.height=function(){return this._height},v.prototype.drawStemPath=function(e){var t=this._min,i=this._max,r=this._height,n=r/2;e.moveTo(t,n),e.lineTo(i,n)},v.prototype.drawTrigsPath=function(e){var t=this._min,i=this._max,r=this._height,n=r/2;e.moveTo(t,0),e.lineTo(t+r,n),e.lineTo(t,r),e.lineTo(t,0),e.moveTo(i,0),e.lineTo(i-r,n),e.lineTo(i,r),e.lineTo(i,0)},v.prototype.draw=function(e){e.beginPath(),this.drawStemPath(e),e.strokeStyle=this._stroke,e.stroke(),e.beginPath(),this.drawTrigsPath(e),e.fillStyle=this._fill,e.fill()},v.prototype.toSVG=function(){var e=new F;this.drawStemPath(e);var t=new F;return this.drawTrigsPath(t),I(N,"g",[I(N,"path",null,{d:e.toPathData(),stroke:this._stroke||"none"}),I(N,"path",null,{d:t.toPathData(),fill:this._fill||"none"})])},y.prototype=Object.create(r.prototype),y.prototype.min=function(){return this._min},y.prototype.max=function(){return this._max},y.prototype.height=function(){return this._height},y.prototype.drawPath=function(e){var t=this._min,i=this._max,r=this._height;if(this._parallel){var n=r/2,s=.4*r;this._sw?(e.moveTo(t+n,r-s),e.lineTo(t+n,r),e.lineTo(t,n),e.lineTo(t+n,0),e.lineTo(t+n,s)):(e.moveTo(t,r-s),e.lineTo(t,s)),this._ne?(e.lineTo(i-n,s),e.lineTo(i-n,0),e.lineTo(i,n),e.lineTo(i-n,r),e.lineTo(i-n,r-s)):(e.lineTo(i,s),e.lineTo(i,r-s)),e.closePath()}else{var o=(t+i)/2,s=.4*(i-t),a=r/3;this._ne?(e.moveTo(t+s,a),e.lineTo(t,a),e.lineTo(o,0),e.lineTo(i,a),e.lineTo(i-s,a)):(e.moveTo(t+s,0),e.lineTo(i-s,0)),this._sw?(e.lineTo(i-s,r-a),e.lineTo(i,r-a),e.lineTo(o,r),e.lineTo(t,r-a),e.lineTo(t+s,r-a)):(e.lineTo(i-s,r),e.lineTo(t+s,r)),e.closePath()}},m.prototype.min=function(){return this._min},m.prototype.max=function(){return this._max},m.prototype.height=function(){return this._height},m.prototype.toSVG=function(){return I(N,"rect",null,{x:this._min,y:0,width:this._max-this._min,height:this._height,stroke:this._stroke||"none",fill:this._fill||"none"})},m.prototype.draw=function(e){if(this._fill&&(e.fillStyle=this._fill,e.fillRect(this._min,0,this._max-this._min,this._height)),this._stroke){e.strokeStyle=this._stroke,e.strokeRect(this._min,0,this._max-this._min,this._height),e.beginPath();for(var t=2;t<this._height;t+=3)e.moveTo(this._min,t),e.lineTo(this._max,t);e.stroke()}},b.prototype.min=function(){return this._min},b.prototype.max=function(){return Math.max(this._max,this._min+this._textLen)},b.prototype.height=function(){return this._height},b.prototype.draw=function(e){e.fillStyle=this._fill,e.fillText(this._string,this._min,this._height-4)},b.prototype.toSVG=function(){return I(N,"text",this._string,{x:this._min,y:this._height-4})},S.prototype.min=function(){return this._min},S.prototype.max=function(){return this._max},S.prototype.height=function(){return this._height},S.prototype.draw=function(e){var t=this._seq,i=this._fill;if(t){var r=(this._max-this._min+1)/t.length,n=(3-this._readframe)%3,s=(t.length-n)%3,o="+"==this._orientation?n:s;o>0&&(e.fillStyle=i,e.fillRect(this._min,0,r*o,this._height));for(var a=o;a<t.length;a+=3){var l=t.substr(a,3).toUpperCase();"-"==this._orientation&&(l=x(l));var u=l in P?P[l]:"?";i=3==l.length?w(u,a,this._fill):this._fill,e.fillStyle=i,e.fillRect(this._min+a*r,0,r*l.length,this._height),r>=8&&3==l.length&&(e.fillStyle="white",e.fillText(u,this._min+(a+1)*r,this._height))}}},S.prototype.toSVG=function(){var e=I(N,"g"),t=this._seq,i=this._fill;if(!t)return e;var r=(this._max-this._min+1)/t.length,n=(3-this._readframe)%3,s=(t.length-n)%3,o="+"==this._orientation?n:s;o>0&&e.appendChild(I(N,"rect",null,{x:this._min,y:0,width:r*o,height:this._height,fill:i}));for(var a=o;a<t.length;a+=3){var l=t.substr(a,3).toUpperCase();"-"==this._orientation&&(l=x(l));var u=l in P?P[l]:"?";i=3==l.length?w(u,a,this._fill):this._fill,e.appendChild(I(N,"rect",null,{x:this._min+a*r,y:0,width:r*l.length,height:this._height,fill:i})),r>=8&&3==l.length&&e.appendChild(I(N,"text",u,{x:this._min+(a+1)*r,y:this._height,fill:"white"}))}return e};var G="undefined"!=typeof window&&window.devicePixelRatio>1,D={},q=new RegExp("^[ACGT-]$"),U=function(e){return e>=8};_.prototype.min=function(){return this._min},_.prototype.max=function(){return this._max},_.prototype.height=function(){return this._height},_.prototype.alphaForQual=function(e){return.1+.9*Math.max(0,Math.min(1*e/30,1))},_.prototype.draw=function(e){var t=this._seq,i=this._ref,r="mismatch"===this._scheme||"mismatch-all"===this._scheme,n="mismatch-all"===this._scheme,s=t?t.length:this._max-this._min+1,o=(this._max-this._min+1)/s;r&&!U(o)&&(e.fillStyle=this._strandColor,this._scaleVertical?e.fillRect(this._min,o,this._max-this._min,o):e.fillRect(this._min,this._height/4,this._max-this._min,this._height/2));for(var a=0;s>a;++a){var l=t?t.substr(a,1).toUpperCase():"N";if(q.test(l)||U(o)){var u=this.baseColors[l];if(this._quals){var h=this._quals.charCodeAt(a)-33,c=e.globalAlpha;e.globalAlpha=this.alphaForQual(h)}if(!u){var f=i?i.substr(a,1).toUpperCase():"N";u="N"==l||"N"==f?"gray":this._strandColor,n&&(l=f)}e.fillStyle=u;var p=q.test(l);if(!this._fillbg&&U(o)&&p||(this._scaleVertical?e.fillRect(this._min+a*o,o,o,o):e.fillRect(this._min+a*o,0,o,this._height)),U(o)&&p){var d=u+"_"+l,g=D[d];if(!g){g=document.createElement("canvas"),G?(g.width=16,g.height=20):(g.width=8,g.height=10);var v=g.getContext("2d");G&&v.scale(2,2),v.fillStyle=this._fillbg?"black":u;var y=v.measureText(l).width;v.fillText(l,.5*(8-y),8),D[d]=g}var m=this._scaleVertical?o:0;G?e.drawImage(g,this._min+a*o+.5*(o-8),m,8,10):e.drawImage(g,this._min+a*o+.5*(o-8),m)}this._quals&&(e.globalAlpha=c)}}},_.prototype.toSVG=function(){for(var e=this._seq,t=this._ref,i=("mismatch"===this._scheme||"mismatch-all"===this._scheme,"mismatch-all"===this._scheme),r=(this._max-this._min+1)/this._seq.length,n=I(N,"g"),s=0;s<e.length;++s){var o=e?e.substr(s,1).toUpperCase():"N",a=this.baseColors[o];if(!a){var l=t?t.substr(s,1).toUpperCase():"N";a="N"==o||"N"==l?"gray":this._strandColor,i&&(o=l)}var u=1;if(this._quals){var h=this._quals.charCodeAt(s)-33;u=this.alphaForQual(h)}var c=q.test(o);!this._fillbg&&U(r)&&c||n.appendChild(I(N,"rect",null,{x:this._min+s*r,y:0,width:r,height:this._height,fill:a,fillOpacity:u})),U(r)&&c&&n.appendChild(I(N,"text",o,{x:this._min+(.5+s)*r,y:8,textAnchor:"middle",fill:this._fillbg?"black":a,fillOpacity:u}))}return n},T.prototype.height=function(){return this._height?this._height:this.glyph.height()+this._y},T.prototype.min=function(){return this.glyph.min()+this._x},T.prototype.max=function(){return this.glyph.max()+this._x},T.prototype.minY=function(){return this._y},T.prototype.maxY=function(){return this._y+this.glyph.height()},T.prototype.draw=function(e,t){e.save(),e.translate(this._x,this._y),this.glyph.draw(e,t),e.restore()},T.prototype.toSVG=function(){var e=this.glyph.toSVG();return e.setAttribute("transform","translate("+this._x+","+this._y+")"),e},C.prototype.min=function(){return this._x-2},C.prototype.max=function(){return this._x+2},C.prototype.height=function(){return this._height},C.prototype.draw=function(e){e.save(),e.globalAlpha=.3,e.fillStyle=this._fill,e.beginPath(),e.arc(this._x,this._y,1.5,0,6.29),e.fill(),e.restore()},C.prototype.toSVG=function(){return I(N,"circle",null,{cx:this._x,cy:this._y,r:2,fill:this._fill,stroke:"none"})},k.prototype.notSelectable=!0,k.prototype.min=function(){return-1e5},k.prototype.max=function(){return 1e5},k.prototype.height=function(){return this._height},k.prototype.draw=function(e){e.save(),e.strokeStyle="black",e.lineWidth=.1,e.beginPath();for(var t=this.yOffset;t<=this._height+this.yOffset;t+=this.spacing)e.moveTo(-5e3,t),e.lineTo(5e3,t);e.stroke(),e.restore()},k.prototype.toSVG=function(){for(var e=new F,t=0;t<=this._height;t+=10)e.moveTo(-5e3,t),e.lineTo(5e3,t);return I(N,"path",null,{d:e.toPathData(),fill:"none",stroke:"black",strokeWidth:"0.1px"})},L.prototype=Object.create(r.prototype),L.prototype.min=function(){return this._x-this._r},L.prototype.max=function(){return this._x+this._r},L.prototype.height=function(){return 2*this._r},L.prototype.drawPath=function(e){for(var t=this._x,i=this._r,r=this._r,n=0;n<this._points;++n){var s=6.28*n/this._points,o=t+r*Math.sin(s),a=i-r*Math.cos(s);0==n?e.moveTo(o,a):e.lineTo(o,a),s=6.28*(n+.5)/this._points,o=t+.4*r*Math.sin(s),a=i-.4*r*Math.cos(s),e.lineTo(o,a)}e.closePath()},O.prototype.draw=function(e){var t=this._height/2;e.fillStyle=this._stroke,e.beginPath(),e.arc(this._x,t,t-this._overhang,0,6.29),e.moveTo(this._x,0),e.lineTo(this._x,this._height),this._fill&&(e.fillStyle=this._fill,e.fill()),this._stroke&&(e.strokeStyle=this._stroke,e.stroke())},O.prototype.toSVG=function(){var e=this._hh;return I(N,"g",[I(N,"circle",null,{cx:this._x,cy:e,r:e-this._overhang}),I(N,"line",null,{x1:this._x,y1:0,x2:this._x,y2:this._height})],{fill:this._fill||"none",stroke:this._stroke||"none",strokeWidth:"1px"})},O.prototype.min=function(){return this._x-this._hh},O.prototype.max=function(){return this._x+this._hh},O.prototype.height=function(){return this._height},A.prototype.translate=function(e,t){this.ox+=e,this.oy+=t},A.prototype.registerGlyph=function(e){this.glyphs.push({x:this.ox,y:this.oy,glyph:e})},A.prototype.draw=function(e,t,i){for(var r=0;r<this.glyphs.length;++r){var n=this.glyphs[r];e.save(),e.translate(n.x,n.y),n.glyph.drawOverlay(e,t,i),e.restore()}},"undefined"!=typeof t&&(t.exports={BoxGlyph:n,GroupGlyph:s,LineGraphGlyph:o,LabelledGlyph:a,CrossGlyph:l,ExGlyph:u,TriangleGlyph:h,DotGlyph:c,PaddedGlyph:f,AArrowGlyph:p,SpanGlyph:d,LineGlyph:g,PrimersGlyph:v,ArrowGlyph:y,TooManyGlyph:m,TextGlyph:b,SequenceGlyph:_,AminoAcidGlyph:S,TranslatedGlyph:T,GridGlyph:k,StarGlyph:L,PointGlyph:C,PlimsollGlyph:O,OverlayLabelCanvas:A})},{"./spans":40,"./svg-utils":44,"./utils":55}],24:[function(e,t,i){"use strict";function r(e,t){this.base=e,this.query=t}function n(e){return e>0?"+":0>e?"-":void 0}if("undefined"!=typeof e){var s=e("./das"),o=(s.DASStylesheet,s.DASStyle,s.DASFeature),a=(s.DASGroup,e("./utils")),l=a.shallowCopy,u=e("./spans"),h=u.Range,c=u.union;u.intersection}r.prototype.features=function(e,t,i){t=t||{},url=this.base+"/features/"+e.name;var r=[];this.query&&r.push(this.query),e.isBounded&&(r.push("start="+e.start),r.push("end="+e.end)),r.length>0&&(url=url+"?"+r.join("&"));var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState)if(s.status>=300)i(null,"Error code "+s.status);else{var t=JSON.parse(s.response).features,r=[];for(fi=0;fi<t.length;++fi){var a=t[fi],f=new o;if(f.segment=e.name,f.min=(0|a.start)+1,f.max=0|a.end,a.name&&(f.label=a.name),a.strand&&(f.orientation=n(a.strand)),f.type=a.type||"unknown",a.subfeatures&&a.subfeatures.length>0){f.id=a.uniqueID;for(var p=[],d=[],g=[],v=0;v<a.subfeatures.length;++v){var y=a.subfeatures[v],m=l(f);m.min=y.start+1,m.max=y.end,m.groups=[f],g.push(m),p.push(new h(m.min,m.max)),"CDS"===y.type&&d.push(m)}if(d.length>0){u=c(p);var b=l(f);b.type="transcript",u.ranges().forEach(function(t){r.push({segment:e.name,min:t.min(),max:t.max(),orientation:f.orientation,groups:[b],type:"transcript"})});var w=l(f);d.forEach(function(e){e.type="translation",e.groups=[w],r.push(e)})}else g.forEach(function(e){r.push(e)})}else r.push(f)}i(r)}},s.open("GET",url,!0),s.responseType="text",s.send()},"undefined"!=typeof t&&(t.exports={JBrowseStore:r})},{"./das":10,"./spans":40,"./utils":55}],25:[function(e,t,i){"use strict";function r(){var e=this;this.reqs=[],this.awaitedFeatures={},this.requestsIssued=new O(function(t,i){e.notifyRequestsIssued=t})}function n(e,t,i,r,n,s,o){this.chr=e,this.min=t,this.max=i,this.coverage=o,this.scale=r,this.features=n||[],this.status=s}function s(e,t,i,r,n,s){this.tierMap=e,this.chr=t,this.min=i,this.max=r,this.scale=n,this.seqSource=s||new y,this.viewCount=0,this.featureCache={},this.latestViews={}}function o(e,t,i){for(var r=[],n={},s=0;s<e.length;++s){var o=e[s];o.min&&o.max?o.groups&&o.groups.length>0?u(n,o.groups[0].id,o):o.min<=i&&o.max>=t&&r.push(o):r.push(o)}for(var a in n){for(var l=n[a],h=1e11,c=-1e11,s=0;s<l.length;++s){var o=l[s];h=Math.min(h,o.min),c=Math.max(c,o.max)}if(i>=h||c>=t)for(var s=0;s<l.length;++s)r.push(l[s])}return r}if("undefined"!=typeof e)var a=e("./utils"),l=a.Awaited,u=a.pusho,h=e("./sourceadapters"),c=h.MappedFeatureSource,f=h.CachingFeatureSource,p=h.BWGFeatureSource,d=h.RemoteBWGFeatureSource,g=h.BAMFeatureSource,v=h.RemoteBAMFeatureSource,y=h.DummySequenceSource,m=h.DummyFeatureSource,b=e("./overlay").OverlayFeatureSource,w=e("./spans"),x=w.Range,S=(w.union,w.intersection),_=e("./sample"),T=_.downsample,C=_.getBaseCoverage,k=e("./das"),L=k.DASSequence,O=e("es6-promise").Promise;r.prototype.addRequest=function(e){this.reqs.push(e)},r.prototype.abortAll=function(){for(var e=0;e<this.reqs.length;++e)this.reqs[e].abort()},n.prototype.toString=function(){return this.chr+":"+this.min+".."+this.max+";scale="+this.scale},s.prototype.cancel=function(){this.cancelled=!0},s.prototype.bestCacheOverlapping=function(e,t,i){var r=this.featureCache[this.tierMap[0]];return r?r:null},s.prototype.retrieveFeatures=function(e,t,i,n,s){if(s!=s)throw"retrieveFeatures called with silly scale";if(t!=this.chr)throw"Can't extend Known Space to a new chromosome";1>i&&(i=1),this.min=i,this.max=n,this.scale=s,this.pool&&this.pool.abortAll(),this.pool=new r,this.awaitedSeq=new l,this.seqWasFetched=!1,this.viewCount++,this.startFetchesForTiers(e),this.pool.notifyRequestsIssued()},s.prototype.invalidate=function(e){this.pool&&(this.featureCache[e]=null,this.startFetchesForTiers([e]))},s.prototype.startFetchesForTiers=function(e){for(var t,i=this,r=this.awaitedSeq,n=!1,s=0;s<e.length;++s){var o=e[s].browser.getTierRenderer(e[s]);try{this.startFetchesFor(e[s],r)&&(n=!0)}catch(a){var l=e[s];l.currentFeatures=[],l.currentSequence=null,console.log("Error fetching tier source"),console.log(a),t=a,console.log(a.stack),o.renderTier(a,l),l.wasRendered()}}if(n&&!this.seqWasFetched){this.seqWasFetched=!0;var u=this.min,h=this.max;if(this.cs&&this.cs.start<=u&&this.cs.end>=h){var c;return c=this.cs.start==u&&this.cs.end==h?this.cs:new L(this.cs.name,u,h,this.cs.alphabet,this.cs.seq.substring(u-this.cs.start,h+1-this.cs.start)),r.provide(c)}this.seqSource.fetch(this.chr,u,h,this.pool,function(e,t){t?((!i.cs||u<=i.cs.start&&h>=i.cs.end||u>=i.cs.end||h<=i.cs.start||h-u>i.cs.end-i.cs.start)&&(i.cs=t),r.provide(t)):(console.log("Sequence loading failed",e),r.provide(null))})}if(t)throw t},s.prototype.startFetchesFor=function(e,t){var i,r=this,s=this.viewCount,a=e.getSource()||new m,l=e.needsSequence(this.scale),u=r.featureCache[e],h=e.getActiveStyleFilters(this.scale);h&&(i=h.typeList());var c=this.chr,f=this.min,p=this.max;if(void 0===i)return!1;if(u&&u.chr===this.chr&&u.min<=f&&u.max>=p){var d=u.features;(u.min<f||u.max>p)&&(d=o(d,f,p)),r.provision(e,u.chr,S(u.coverage,new x(f,p)),u.scale,i,d,u.status,l?t:null);var g=a.getScales();if(u.scale<=this.scale||!g)return l}return a.instrument&&console.log("Starting  fetch "+s+" ("+f+", "+p+")"),a.fetch(c,f,p,this.scale,i,this.pool,function(o,h,d,g){a.instrument&&console.log("Finishing fetch "+s);var v=r.latestViews[e]||-1;r.cancelled||v>s||(g||(g=new x(f,p)),(!u||f<u.min||p>u.max)&&(r.featureCache[e]=new n(c,f,p,d,h,o,g)),r.latestViews[e]=s,r.provision(e,c,g,d,i,h,o,l?t:null))},h),l},s.prototype.provision=function(e,t,i,r,n,s,o,a){var l=e.browser.getTierRenderer(e);if(o){if(e.setFeatures(t,i,r,[],null),!s){var u=new Error(o);o="Error fetching data: "+o+"; see browser console",console.log("Error fetching data for tier "+e.dasSource.name+":"),console.log(e.dasSource),console.log("Stack trace:"),console.log(u.stack)}l.renderTier(o,e),e.wasRendered()}else{for(var h=!1,y=!1,m=e.getSource();c.prototype.isPrototypeOf(m)||f.prototype.isPrototypeOf(m)||b.prototype.isPrototypeOf(m);)m=b.prototype.isPrototypeOf(m)?m.sources[0]:m.source;(p.prototype.isPrototypeOf(m)||d.prototype.isPrototypeOf(m)||g.prototype.isPrototypeOf(m)||v.prototype.isPrototypeOf(m))&&(h=!0),m.opts&&(m.opts.forceReduction||m.opts.noDownsample)||h&&n&&1==n.length&&n.indexOf("density")>=0&&(s=T(s,this.scale)),n&&1==n.length&&n.indexOf("base-coverage")>=0&&(y=!0),a?a.await(function(n){y&&(s=C(s,n,e.browser.baseColors)),e.setFeatures(t,i,r,s,n),l.renderTier(o,e),e.wasRendered()}):(e.setFeatures(t,i,r,s),l.renderTier(o,e),e.wasRendered())}},"undefined"!=typeof t&&(t.exports={KnownSpace:s})},{"./das":10,"./overlay":30,"./sample":33,"./sourceadapters":38,"./spans":40,"./utils":55,"es6-promise":59}],26:[function(e,t,i){"use strict";function r(e,t){this.block=e,this.offset=t}function n(e,t,i){var n=4294967296*(255&e[t+6])+16777216*(255&e[t+5])+65536*(255&e[t+4])+256*(255&e[t+3])+(255&e[t+2]),s=e[t+1]<<8|e[t];return 0!=n||0!=s||i?new r(n,s):null}function s(e,t){t=Math.min(t||1,e.byteLength-50);for(var i=[],r=[0],n=0;r[0]<t;){var s=new Uint8Array(e,r[0],12),o=s[11]<<8|s[10],a=h(e,12+o+r[0],Math.min(65536,e.byteLength-12-o-r[0]),r);r[0]+=8,n+=a.byteLength,i.push(a)}if(1==i.length)return i[0];for(var l=new Uint8Array(n),u=0,f=0;f<i.length;++f){var p=new Uint8Array(i[f]);c(p,0,l,u,p.length),u+=p.length}return l.buffer}function o(e,t){this.minv=e,this.maxv=t}function a(e,t){return--t,e>>14==t>>14?4681+(e>>14):e>>17==t>>17?585+(e>>17):e>>20==t>>20?73+(e>>20):e>>23==t>>23?9+(e>>23):e>>26==t>>26?1+(e>>26):0}function l(e,t){var i,r=[];for(--t,r.push(0),i=1+(e>>26);1+(t>>26)>=i;++i)r.push(i);for(i=9+(e>>23);9+(t>>23)>=i;++i)r.push(i);for(i=73+(e>>20);73+(t>>20)>=i;++i)r.push(i);for(i=585+(e>>17);585+(t>>17)>=i;++i)r.push(i);for(i=4681+(e>>14);4681+(t>>14)>=i;++i)r.push(i);return r}if("undefined"!=typeof e)var u=e("jszlib"),h=u.inflateBuffer,c=u.arrayCopy;r.prototype.toString=function(){return""+this.block+":"+this.offset};"undefined"!=typeof t&&(t.exports={unbgzf:s,readVob:n,reg2bin:a,reg2bins:l,Chunk:o})},{jszlib:60}],27:[function(e,t,i){"use strict";function r(){this.featuresByChr={},this.maxLength=1,this.chrRing=null}function n(e){if(this.source=e,l.call(this),this.storeHolder=new c,this.parser=a(e.payload),!this.parser)throw"Unsupported memstore payload: "+e.payload;var t=this;this._load(function(e,i){if(i)t.error=i,t.storeHolder.provide(null);else{for(var n=new r,s=[],o=e.split("\n"),a=t.parser.createSession(function(e){s.push(e)}),l=0;l<o.length;++l){var u=o[l];u.length>0&&a.parse(u)}a.flush(),n.addFeatures(s),t.storeHolder.provide(n)}})}if("undefined"!=typeof e)var s=e("./sourceadapters"),o=s.registerSourceAdapterFactory,a=s.makeParser,l=s.FeatureSourceBase,u=e("./das"),h=(u.DASStylesheet,u.DASStyle,u.DASFeature,u.DASGroup,e("./utils")),c=h.Awaited,f=h.textXHR;r.prototype.addFeatures=function(e){for(var t={},i=0;i<e.length;++i){var r=e[i],n=r.segment||r.chr,s=this.featuresByChr[n];s||(s=[],this.featuresByChr[n]=s),s.push(r),t[n]=!0;var o=r.max-r.min+1;o>this.maxLength&&(this.maxLength=o)}for(n in t){var s=this.featuresByChr[n];s.sort(function(e,t){var i=e.min-t.min;return 0!=i?i:e.max-t.max})}this.chrRing=null},r.prototype._indexFor=function(e,t){for(var i=0,r=e.length;r>i;){var n=(i+r)/2|0;if(n>=e.length)return e.length;var s=e[n];t<s.min?r=n:i=n+1}return r},r.prototype.fetch=function(e,t,i){var r=this.featuresByChr[e];if(r||(r=0==e.indexOf("chr")?this.featuresByChr[e.substring(3)]:this.featuresByChr["chr"+e]),!r)return[];for(var n=Math.max(0,this._indexFor(r,t-this.maxLength-1)),s=Math.min(r.length-1,this._indexFor(r,i)),o=[],a=n;s>=a;++a){var l=r[a];l.min<=i&&l.max>=t&&o.push(l)}return o},r.prototype.findNextFeature=function(e,t,i){if(null==this.chrRing){this.chrRing=[];for(var e in this.featuresByChr)this.chrRing.push(e);this.chrRing.sort()}var r=this.featuresByChr[e];if(r||(0==e.indexOf("chr")?(e=e.substring(3),r=this.featuresByChr[e]):(e="chr"+e,r=this.featuresByChr[e])),!r)return null;var n=Math.max(0,Math.min(this._indexFor(r,t),r.length-1));if(i>0){for(;n<r.length;){var s=r[n++];if(s.min>t)return s}var o=this.chrRing.indexOf(e)+1;return o>=this.chrRing.length&&(o=0),this.findNextFeature(this.chrRing[o],0,i)}for(;n>=0;){var s=r[n--];if(s.max<t)return s}var o=this.chrRing.indexOf(e)-1;return 0>o&&(o=this.chrRing.length-1),this.findNextFeature(this.chrRing[o],1e10,i)},n.prototype=Object.create(l.prototype),n.prototype._load=function(e){if(this.source.blob){var t=new FileReader;t.onloadend=function(){return e(t.result,t.error)},t.readAsText(this.source.blob)}else{if(this.source.credentials)var i={credentials:this.source.credentials};f(this.source.uri,e,i)}},n.prototype.fetch=function(e,t,i,r,n,s,o){var a=this;this.storeHolder.await(function(r){if(r){var n=r.fetch(e,t,i);return o(null,n,1e8)}return o(a.error)})},n.prototype.getStyleSheet=function(e){this.parser&&this.parser.getStyleSheet&&this.parser.getStyleSheet(e)},n.prototype.getDefaultFIPs=function(e){this.parser&&this.parser.getDefaultFIPs&&this.parser.getDefaultFIPs(e)},n.prototype.getScales=function(){return 1e8},n.prototype.findNextFeature=function(e,t,i,r){var n=this;this.storeHolder.await(function(s){return s?r(s.findNextFeature(e,t,i)):r(null,n.error)})},n.prototype.capabilities=function(){var e={leap:!0};return e},o("memstore",function(e){return{features:new n(e)}})},{"./das":10,"./sourceadapters":38,"./utils":55}],28:[function(e,t,i){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function n(e,t){s(t),t.updateStatus(e)}function s(e){var t=e.dasSource.multi,i=function(e){return e.dasSource.sub};e.padding||(e.padding=3);var r=e.viewport.getContext("2d"),n=e.browser.retina&&window.devicePixelRatio>1;n&&r.scale(2,2);var s=e.browser.tiers.filter(function(e){return"object"===a(i(e))&&i(e).multi_id===t.multi_id&&(e.currentFeatures||e.currentSequence)}),h=p.pipe(p.map(function(e){return e.dasSource.sub.offset}),p.reduce(function(e,t){return e>t?t:e},0))(s);s.forEach(function(t){t.sequenceSource?(0,l.drawSeqTier)(t,t.currentSequence):c.prepareSubtiers(t,r,i(t).offset-h,!1),e.glyphCacheOrigin||(e.glyphCacheOrigin=t.glyphCacheOrigin)});var f=p.pipe(p.map(function(e){return p.map(function(t){return t.height+i(e).offset},e.subtiers)}),p.flatten,p.reduce(function(e,t){return t>e?t:e},-(1/0)),p.add(-h))(s);if(o(e,r,n,f,!0),s.sort(function(e,t){return i(e).z>i(t).z}),t.grid&&s&&s[s.length-1]&&s[s.length-1].subtiers[0]){var d=new u.GridGlyph(f,t.grid_offset,t.grid_spacing);s[s.length-1].subtiers[0].glyphs.unshift(d)}if(s.forEach(function(e){r.save(),c.paint(e,r,n,!0),r.restore()}),e.drawOverlay(),t.quant){var g=c.createQuantOverlay(e,f+2*e.padding,n);c.paintQuant(g,e,t.quant,10)}"function"==typeof e.dasSource.drawCallback&&e.dasSource.drawCallback(r,e),e.originHaxx=0,e.browser.arrangeTiers()}function o(e,t,i,r){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:!0,s=e.browser.featurePanelWidth+2e3;i&&(s*=2);var o=0|e.viewport.width;s-50>o&&(e.viewport.width=o=s),r+=2*e.padding,r=Math.max(r,e.browser.minTierHeight),r!=e.viewport.height&&(e.viewport.height=r,i&&(e.viewport.height*=2)),e.viewportHolder.style.left="-1000px",e.viewport.style.width=i?""+o/2+"px":""+o+"px",e.viewport.style.height=""+r+"px",e.layoutHeight=Math.max(r,e.browser.minTierHeight),e.updateHeight(),e.norigin=e.browser.viewStart,n&&c.clearViewport(t,o,r),c.drawUnmapped(e,t,r)}Object.defineProperty(i,"__esModule",{value:!0}),i.drawTier=i.renderTier=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=e("./sequence-draw.js"),u=e("./glyphs.js"),h=e("./default-renderer"),c=r(h),f=e("ramda"),p=r(f);i.renderTier=n,i.drawTier=s},{"./default-renderer":11,"./glyphs.js":23,"./sequence-draw.js":35,ramda:62}],29:[function(e,t,i){"use strict";function r(e){return(0|e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function n(e){var t=""+e,i=t.indexOf(".");if(0>i)return t;var r=2;return"-"==t.substring(0,1)&&++r,i>=r?t.substring(0,i):t.substring(0,i+2)}"undefined"!=typeof t&&(t.exports={formatLongInt:r,formatQuantLabel:n})},{}],30:[function(e,t,i){"use strict";function r(e,t){this.sources=e,this.opts=t||{},this.activityListeners=[],this.readinessListeners=[],this.changeListeners=[],this.business=[],this.readiness=[];for(var i=0;i<this.sources.length;++i)this.initN(i);"function"==typeof t.merge?this.merge=t.merge:"concat"==t.merge?this.merge=o:"alternates"==t.merge?(this.merge=o,this.filterDispatchOnMethod=!0):this.merge=s}function n(e,t,i){this.source=e,this.callback=t,this.sources=i,this.count=i.length,this.returnCount=0,this.statusCount=0,this.returns=[],this.features=[],this.statuses=[],this.scale=null}function s(e){for(var t=[],i=1;i<e.length;++i){for(var r={},n=e[i],s=0;s<n.length;++s)r[this.keyForFeature(n[s])]=n[s];t.push(r)}for(var o=[],a=e[0],s=0;s<a.length;++s){for(var l=a[s],u=0;u<t.length;++u){var r=t[u];if(n=r[this.keyForFeature(l)])for(var h in n)"score"===h?l.score2=n.score:"min"===h||"max"===h||"segment"===h||"_cachedStyle"===h||(l[h]=n[h])}o.push(l)}return o}function o(e,t){for(var i=[],r=0;r<e.length;++r)for(var n=e[r],s=t[r].name,o=0;o<n.length;++o){var a=n[o];a.method=s,i.push(a)}return i}function a(e,t){return e.capabilities?e.capabilities()[t]:!1}if("undefined"!=typeof e)var l=e("./utils"),u=l.shallowCopy,h=l.arrayIndexOf;r.prototype.initN=function(e){var t=this.sources[e],i=this;this.business[e]=0,t.addActivityListener&&t.addActivityListener(function(t){i.business[e]=t,i.notifyActivity()}),t.addChangeListener&&t.addChangeListener(function(){i.notifyChange()}),t.addReadinessListener&&t.addReadinessListener(function(t){i.readiness[e]=t,i.notifyReadiness()})},r.prototype.addReadinessListener=function(e){this.readinessListeners.push(e),this.notifyReadinessListener(e)},r.prototype.removeReadinessListener=function(e){var t=h(this.readinessListeners,e);t>=0&&this.readinessListeners.splice(t,1)},r.prototype.notifyReadiness=function(){for(var e=0;e<this.readinessListeners.length;++e)this.notifyReadinessListener(this.readinessListeners[e])},r.prototype.notifyReadinessListener=function(e){for(var t=null,i=0;i<this.readiness.length;++i)if(null!=this.readiness[i]){t=this.readiness[i];break}try{e(t)}catch(r){console.log(r)}},r.prototype.addActivityListener=function(e){this.activityListeners.push(e);
},r.prototype.removeActivityListener=function(e){var t=h(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,1)},r.prototype.notifyActivity=function(){for(var e=0,t=0;t<this.business.length;++t)e+=this.business[t];for(var i=0;i<this.activityListeners.length;++i)try{this.activityListeners[i](e)}catch(r){console.log(r)}},r.prototype.addChangeListener=function(e){this.changeListeners.push(e)},r.prototype.removeChangeListener=function(e){var t=h(this.changeListeners,e);t>=0&&this.changeListeners.splice(t,1)},r.prototype.notifyChange=function(){for(var e=0;e<this.changeListeners.length;++e)try{this.changeListeners[e](this.busy)}catch(t){console.log(t)}},r.prototype.getScales=function(){return this.sources[0].getScales()},r.prototype.getStyleSheet=function(e){return this.sources[0].getStyleSheet(e)},r.prototype.capabilities=function(){var e={},t=this.sources[0];t.capabilities&&(e=u(t.capabilities()));for(var i=1;i<this.sources.length;++i){var r=this.sources[i];if(r.capabilities){var n=r.capabilities();n.search&&(e.search=n.search)}}return e},r.prototype.search=function(e,t){for(var i=0;i<this.sources.length;++i)if(a(this.sources[i],"search"))return this.sources[i].search(e,t)},r.prototype.fetch=function(e,t,i,r,s,o,a,l){var u;if(this.filterDispatchOnMethod){u=[];for(var h=l.list(),c=0;c<this.sources.length;++c)for(var f=this.sources[c],p=0;p<h.length;++p){var d=h[p];if(!d.method||d.method==f.name){u.push(f);break}}}else u=this.sources;for(var g=new n(this,a,u),c=0;c<u.length;++c)this.fetchN(g,c,u[c],e,t,i,r,s,o,l)},r.prototype.fetchN=function(e,t,i,r,n,s,o,a,l,u){i.fetch(r,n,s,o,a,l,function(i,r,n){return e.completed(t,i,r,n)},u)},r.prototype.quantFindNextFeature=function(e,t,i,r,n){return this.sources[0].quantFindNextFeature(e,t,i,r,n)},r.prototype.findNextFeature=function(e,t,i,r){return this.sources[0].findNextFeature(e,t,i,r)},n.prototype.completed=function(e,t,i,r){if((null==this.scale||0==e)&&(this.scale=r),this.returns[e])throw"Multiple returns for source "+e;if(this.returns[e]=!0,this.returnCount++,this.features[e]=i,t&&(this.statuses[e]=t,this.statusCount++),this.returnCount==this.count){if(this.statusCount>0){for(var n="",s=0;s<this.count;++s){var o=this.statuses[s];o&&(n.length>0&&(n+=", "),n+=o)}return this.callback(n,null,this.scale)}this.callback(null,this.source.merge(this.features,this.sources),this.scale)}},r.prototype.getDefaultFIPs=function(e){for(var t=0;t<this.sources.length;++t){var i=this.sources[t];i.getDefaultFIPs&&i.getDefaultFIPs(e)}},r.prototype.keyForFeature=function(e){return""+e.min+".."+e.max},"undefined"!=typeof t&&(t.exports={OverlayFeatureSource:r})},{"./utils":55}],31:[function(e,t,i){"use strict";function r(e,t,i){var s,u=new RegExp("^\\w+\\s[0-9]+\\s[0-9]+.*$"),f=/([^=]+)=\"?([^\"]+)\"?/,d=/^##\s*fileformat=VCFv4\..+/;s=e.blob?new a(e.blob):"encode"==e.transport?new b(e.uri):new o(e.uri,{credentials:e.credentials}),s.slice(0,65536).salted().fetch(function(s,o){if(!s)return i||(e.credentials=!0,r(e,t,!0)),t(e,"Couldn't fetch data");var a=new Uint8Array(s),y=new Uint32Array(s,0,1),b=y[0];if(b==h||b==c){e.tier_type="bwg";var w=new RegExp("/?([^/]+?)(.bw|.bb|.bigWig|.bigBed)?$"),x=w.exec(e.uri||e.blob.name);return x&&(e.name=x[1]),t(e,null)}if(b==v)return e.tier_type="bai",t(e,null);if(31==a[0]||139==a[1]){var S=p(s),_=new Uint8Array(S);if(b=l(_,0),b==g){e.tier_type="bam";var w=new RegExp("/?([^/]+?)(.bam)?$"),x=w.exec(e.uri||e.blob.name);return x&&(e.name=x[1]),t(e,null)}if(b==m)return e.tier_type="tabix-index",t(e,null);if(1768301347==b){e.tier_type="tabix",e.payload="vcf";var w=new RegExp("/?([^/]+?)(.vcf)?(.gz)?$"),x=w.exec(e.uri||e.blob.name);return x&&(e.name=x[1]),t(e,null)}return console.log("magic = "+b.toString(16)),t(e,"Unsupported format")}var T=String.fromCharCode.apply(null,a),C=T.split("\n");if(C.length>0&&d.test(C[0])){e.tier_type="memstore",e.payload="vcf";var w=new RegExp("/?([^/]+?)(.vcf)?$"),x=w.exec(e.uri||e.blob.name);return x&&!e.name&&(e.name=x[1]),t(e,null)}for(var k=0;k<C.length;++k){var L=C[k].replace("\r","");if(0!=L.length&&0!=L.indexOf("browser")){if(0==L.indexOf("track")){for(var O="bed",A=L.split(/\s/),E=1;E<A.length;++E){var R=f.exec(A[E]);R&&("type"==R[1]&&"wiggle_0"==R[2]?O="wig":"name"==R[0]&&(e.name=R[2]))}return n(e,O),t(e,null)}if(0==L.indexOf("fixedStep"))return n(e,"wig"),t(e,null);if(0==L.indexOf("variableStep"))return n(e,"wig"),t(e,null);if(u.test(L))return n(e,null),t(e,null);break}}return t(e,"Unsupported format")},{timeout:1500})}function n(e,t){e.tier_type="memstore";var i=new RegExp("/?([^/]+?)(.(bed|wig))?$"),r=i.exec(e.uri||e.blob.name);r&&(e.name||(e.name=r[1]),!t&&r[3]&&(t=r[3])),e.payload=t||"bed"}if("undefined"!=typeof e)var s=e("./bin"),o=s.URLFetchable,a=s.BlobFetchable,l=s.readInt,u=e("./bigwig"),h=u.BIG_WIG_MAGIC,c=u.BIG_BED_MAGIC,f=e("./lh3utils"),p=f.unbgzf,d=e("./bam"),g=d.BAM_MAGIC,v=d.BAI_MAGIC,y=e("./tabix"),m=y.TABIX_MAGIC,b=e("./encode").EncodeFetchable;"undefined"!=typeof t&&(t.exports={probeResource:r})},{"./bam":1,"./bigwig":3,"./bin":4,"./encode":14,"./lh3utils":26,"./tabix":46}],32:[function(e,t,i){"use strict";function r(e){var t=this;t.value=e.value,t.min=e.min,t.max=e.max,t.width=e.width,t.color=e.color,Object.keys(t).map(function(e){void 0===t[e]&&console.log("WARNING: Ruler option "+e+" not set")})}function n(e,t){var i=t.dasSource.rulers;i?i instanceof Array||console.log("rulers.js: 'rulers' should be an Array"):console.log("Tier uses ruler callback but has no rulers!"),i.map(function(i){var r=(i.max-i.value)*i.height,n=t.viewport.width,s=e.lineWidth;e.strokeStyle=i.color,e.beginPath(),e.moveTo(-n,r+i.offset),e.lineWidth=i.width,e.lineTo(2*n,r+i.offset),e.stroke(),e.lineWidth=s})}Object.defineProperty(i,"__esModule",{value:!0}),i.Ruler=r,i.rulerDrawCallback=n,r.prototype.constructor=r},{}],33:[function(e,t,i){"use strict";function r(e){return g[e%g.length]*Math.pow(10,e/g.length|0)}function n(e,t,i){this.scale=e,this.tot=0,this.cnt=0,this.hasScore=!1,this.min=t,this.max=i,this.features=[]}function s(e,t){return e.min<t.min?-1:e.min>t.min?1:e.max<t.max?-1:t.max>e.max?1:0}function o(e,t){for(var i=0;r(i+1)<t;)++i;for(var s=r(i),o=[],a=-1e10,l=1e10,u=0;u<e.length;++u){var h=e[u];if(h.groups&&h.groups.length>0)return e;var c=h.min/s|0,p=h.max/s|0;a=Math.max(a,p),l=Math.min(l,c);for(var d=c;p>=d;++d){var g=o[d];g||(g=new n(s,d*s,(d+1)*s-1),o[d]=g),g.feature(h)}}for(var v=[],d=l;a>=d;++d){var g=o[d];if(g){var h=new f;h.segment=e[0].segment,h.min=d*s+1,h.max=(d+1)*s,h.score=g.score(),h.type="density",v.push(h)}}Date.now();return v}function a(e){this._pos=e,this._bases={},this._totalCount=0}function l(e,t,i){for(var r=p(i),n=[],s=[],o=0,a=0;a<r.length;++a){var l=r[a];if("M"==l.op)n.push(e.substr(o,l.cnt)),s.push(t.substr(o,l.cnt)),o+=l.cnt;else if("D"==l.op)for(var u=0;u<l.cnt;++u)n.push("-"),s.push("Z");else"I"==l.op?o+=l.cnt:"S"==l.op?o+=l.cnt:console.log("unknown cigop"+l.op)}var h={seq:n.join(""),quals:s.join("")};return h}function u(e,t,i){var r=[];if(e){var n=0|e.start,s=0|e.end;if(i>=n&&s>=t){for(var o=Math.max(t,n),a=Math.min(i,s),l=0;o-t>l;l++)r.push("N");r.push(e.seq.substr(o-n,a-o+1));for(var l=0;i-a>l;l++)r.push("N")}}return r.join("")}function h(e,t,i){for(var r=null,n=null,s=[],o=0;o<e.length;++o){var h=e[o];if(h.groups&&h.groups.length>0)return e;for(var c=l(h.seq,h.quals,h.cigar),p=c.seq,g=c.quals,v=h.orientation,y=h.min||0,m=h.max||0,b=0,w=y;m>=w;++w){var x=s[w];x||(x=new a(w),s[w]=x);var S=p.charAt(b),_=g.charCodeAt(b)-33;x.recordBase(S,_,v),b++}r=r?Math.min(r,y):y,n=n?Math.max(n,m):m}for(var T=u(t,r,n),C=[],b=0,w=r;n>=w;++w){var x=s[w];if(x){var h=new f;if(h.segment=e[0].segment,h.min=x.pos(),h.max=h.min,h.notes=[],h.notes=h.notes.concat(x.infoList()),h.type="base-coverage",h.suppressScore=!0,T){var k=T.charAt(b),L="Ref="+k;h.notes.unshift(L);for(var O=x.baseScoreList(k,.2),A=0;A<O.length;A++){var S=O[A].base,E=O[A].score,R=d(h);R.score=E,(O.length>1||S!=k)&&(R.itemRgb=i[S]),C.push(R)}}else C.push(h)}b++}return C}if("undefined"!=typeof e)var c=e("./das"),f=c.DASFeature,p=e("./cigar").parseCigar,d=e("./utils").shallowCopy;var g=[1,2,5];n.prototype.score=function(){if(0==this.cnt)return 0;if(this.hasScore)return this.tot/this.cnt;var e=this.features;e.sort(s);for(var t=-1e10,i=0,r=0,n=1;n<e.length;++n){var o=e[n],a=Math.max(o.min,this.min),l=Math.min(o.max,this.max);r+=l-a+1,a>t?(i+=l-a+1,t=l):l>t&&(i+=l-t,t=l)}return i>0?1*r/i:0},n.prototype.feature=function(e){void 0!==e.score&&(this.tot+=e.score,this.hasScore=!0),++this.cnt,this.features.push(e)},a.prototype.recordBase=function(e,t,i){if(this._bases[e]){var r=this._bases[e];r.cnt++,r.totalQual+=t,r.strandCnt[i]++}else{var n={"+":0,"-":0};n[i]++,this._bases[e]={cnt:1,totalQual:t,strandCnt:n}}this._totalCount++},a.prototype.totalCount=function(){return this._totalCount},a.prototype.pos=function(){return this._pos},a.prototype.infoList=function(){var e=[],t=this._totalCount,i="Depth="+t.toString();e.push(i);for(var r in this._bases){var n=this._bases[r],s=n.cnt,o=100*s/t,a=n.strandCnt["+"],l=n.strandCnt["-"],u=n.totalQual/s,h=[r,"=",s," (",o.toFixed(0),"%, ",a," +, ",l," -, Qual: ",u.toFixed(0),")"];e.push(h.join(""))}return e},a.prototype.baseScoreList=function(e,t){var i=[],r=this._totalCount,n=t*r;for(var s in this._bases){var o=this._bases[s].cnt;if(!(n>o||s==e)){var a={base:s,score:r};i.push(a),r-=o}}return i.push({base:e,score:r}),i},"undefined"!=typeof t&&(t.exports={downsample:o,getBaseCoverage:h})},{"./cigar":8,"./das":10,"./utils":55}],34:[function(e,t,i){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function n(e,t){var i=parseFloat(e.replace(/,/g,""));return"k"===t||"K"===t?1e3*i|0:"m"==t||"M"===t?1e6*i|0:0|i}if("undefined"!=typeof e)var s=e("./cbrowser"),o=s.Browser,a=e("./bin"),l=a.URLFetchable,u=e("./trix").connectTrix;var h=/^([\d+,\w,\.,\_,\-]+)[\s:]+([0-9,\.]+?)([KkMmGg])?((-|\.\.|\s)+([0-9,\.]+)([KkMmGg])?)?$/;o.prototype.search=function(e,t,i){var s=this;i=i||{};var o=i.padding||this.defaultSearchRegionPadding,a=h.exec(e);if(a){var c,f,p=a[1];if(a[6])c=n(a[2],a[3]),f=n(a[6],a[7]);else{var d=this.viewEnd-this.viewStart+1;c=n(a[2],a[3])-d/2|0,f=c+d-1}this.setLocation(p,c,f,t)}else{if(!e||0==e.length)return!1;var g=0,v=!1,y=function(i,r){if(--g,r)return t(r);i||(i=[]);for(var n=5e8,a=-1e8,l=null,u=0;u<i.length;++u){var h=i[u];null==l&&(l=h.segment),n=Math.min(n,h.min),a=Math.max(a,h.max)}if(l){v=!0,s.highlightRegion(l,n,a);var c=Math.max(o,.3*(a-n+1)|0);s.setLocation(l,n-c,a+c,t)}else if(0==g&&!v)return t("no match for '"+e+"'")},m=function(t,i){i.lookup(e,function(i,r){if(null==i||i.length<2)return t.featureSource.search(e,y);var n=i[1].split(",")[0];return t.featureSource.search(n,y)})};if(this.searchEndpoint)return g=1,this.doDasSearch(s.searchEndpoint,e,y);for(var b=[].concat(r(this.searchOnlySourceHolders||[]),r(this.tiers)),w=0;w<b.length;++w)!function(t){if(s.sourceAdapterIsCapable(t.featureSource,"search"))if(t.dasSource.trixURI)if(++g,t.trix)m(t,t.trix);else{var i=new l(t.dasSource.trixURI,{credentials:t.dasSource.credentials,resolver:t.dasSource.resolver}),r=new l(t.dasSource.trixxURI||t.dasSource.trixURI+"x",{credentials:t.dasSource.credentials,resolver:t.dasSource.resolver});u(i,r,function(e){t.trix=e,m(t,e)})}else++g,t.featureSource.search(e,y);else t.dasSource.provides_search&&(++g,s.doDasSearch(t.dasSource,e,y))}(b[w])}},o.prototype.doDasSearch=function(e,t,i){e.features(null,{group:t,type:"transcript"},function(e){e||(e=[]);for(var r=[],n=0;n<e.length;++n){var s=e[n];s.label.toLowerCase()==t.toLowerCase()&&r.push(s)}return i(r)},!1)}},{"./bin":4,"./cbrowser":6,"./trix":53}],35:[function(e,t,i){"use strict";function r(e,t){function i(e){return d[e%d.length]*Math.pow(10,e/d.length|0)}t||(t=p);for(var r=d.length;e*i(r)<t;)++r;return i(r)}function n(e,t){var i=e.viewport.getContext("2d"),r=e.browser.retina&&window.devicePixelRatio>1,n=e.browser.featurePanelWidth+2e3;r&&(n*=2);var o=0|e.viewport.width;n-50>o&&(e.viewport.width=o=n);var a=50;t&&t.seq&&(a+=25);var l=a;r&&(l*=2),e.viewport.height=l,e.viewport.style.height=""+a+"px",e.viewport.style.width=r?""+o/2+"px":""+o+"px",e.layoutHeight=a,e.updateHeight(),e.background&&(i.fillStyle=e.background,i.fillRect(0,0,o,e.viewport.height)),r&&i.scale(2,2),i.translate(1e3,0),s(e,t,i),e.norigin=e.browser.viewStart,e.viewportHolder.style.left="-1000px"}function s(e,t,i){var n=e.browser.scale,s=e.browser.viewStart-1e3/n|0,o=e.browser.viewEnd+2e3/n,a=e.browser.currentSeqMax,u=o;a>0&&o>a&&(u=a);for(var h=r(n),c=Math.max(0,(s/h|0)*h),f=e.browser.viewStart;u>=c;)i.fillStyle=c/h%2==0?"white":"black",i.strokeStyle="black",i.fillRect((c-f)*n,8,h*n,3),i.strokeRect((c-f)*n,8,h*n,3),i.fillStyle="black",i.fillText(l(c),(c-f)*n,22),c+=h;if(t&&t.seq)for(var p=s;o>=p;++p)if(p>=t.start&&p<=t.end){var d=t.seq.substr(p-t.start,1).toUpperCase(),g=e.browser.baseColors[d];if(g||(g="gray"),i.fillStyle=g,n>=8){var v=i.measureText(d).width;i.fillText(d,(p-f)*n+.5*(n-v),52)}else i.fillRect((p-f)*n,42,n,12)}}function o(e,t){var i=e.browser.scale,n=e.browser.viewStart-1e3/i|0,s=e.browser.viewEnd+2e3/i,o=e.browser.currentSeqMax,a=(0|e.viewport.width,s);o>0&&s>o&&(a=o);for(var h=r(i),f=Math.max(0,(n/h|0)*h),p=e.browser.viewStart,d=u(c,"g",[],{fontSize:"8pt"});a>=f;)d.appendChild(u(c,"rect",null,{x:(f-p)*i,y:8,width:h*i,height:3,fill:f/h%2==0?"white":"black",stroke:"black"})),d.appendChild(u(c,"text",l(f),{x:(f-p)*i,y:28,fill:"black",stroke:"none"})),f+=h;if(t&&t.seq)for(var g=n;s>=g;++g)if(g>=t.start&&g<=t.end){var v=t.seq.substr(g-t.start,1).toUpperCase(),y=e.browser.baseColors[v];y||(y="gray"),i>=8?d.appendChild(u(c,"text",v,{x:(.5+g-p)*i,y:52,textAnchor:"middle",fill:y})):d.appendChild(u(c,"rect",null,{x:(g-p)*i,y:42,width:i,height:12,fill:y}))}return d}if("undefined"!=typeof e)var a=e("./utils"),l=a.formatLongInt,u=a.makeElementNS,h=e("./svg-utils"),c=h.NS_SVG,f=(h.NS_XLINK,h.SVGPath,e("./numformats")),l=f.formatLongInt;var p=100,d=[1,2,5],c="http://www.w3.org/2000/svg";"undefined"!=typeof t&&(t.exports={drawSeqTier:n,drawSeqTierGC:s,svgSeqTier:o})},{"./numformats":29,"./svg-utils":44,"./utils":55}],36:[function(e,t,i){"use strict";if("undefined"!=typeof e)var r=e("./cbrowser"),n=r.Browser,s=e("./sourcecompare"),o=s.sourceDataURI,a=s.sourcesAreEqual,l=e("./version"),u=e("./utils"),h=u.miniJSONify,c=e("./sha1"),f=c.hex_sha1;n.prototype.nukeStatus=function(){delete localStorage["dalliance."+this.cookieKey+".view-chr"],delete localStorage["dalliance."+this.cookieKey+".view-start"],delete localStorage["dalliance."+this.cookieKey+".view-end"],delete localStorage["dalliance."+this.cookieKey+".current-seq-length"],delete localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"],delete localStorage["dalliance."+this.cookieKey+".saved-zoom"],delete localStorage["dalliance."+this.cookieKey+".sources"],delete localStorage["dalliance."+this.cookieKey+".hubs"],delete localStorage["dalliance."+this.cookieKey+".version"],delete localStorage["dalliance."+this.cookieKey+".reverse-scrolling"],delete localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"],delete localStorage["dalliance."+this.cookieKey+".ruler-location"]},n.prototype.storeStatus=function(){this.storeViewStatus(),this.storeTierStatus()},n.prototype.storeViewStatus=function(){!this.cookieKey||this.noPersist||this.noPersistView||(localStorage["dalliance."+this.cookieKey+".view-chr"]=this.chr,localStorage["dalliance."+this.cookieKey+".view-start"]=0|this.viewStart,localStorage["dalliance."+this.cookieKey+".view-end"]=0|this.viewEnd,localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"]=""+this.isSnapZooming,localStorage["dalliance."+this.cookieKey+".saved-zoom"]=this.savedZoom,this.currentSeqMax&&(localStorage["dalliance."+this.cookieKey+".current-seq-length"]=this.currentSeqMax))},n.prototype.storeTierStatus=function(){if(this.cookieKey&&!this.noPersist){for(var e=[],t=0;t<this.tiers.length;++t){var i=this.tiers[t],r=i.dasSource;r.noPersist||e.push({source:i.dasSource,config:i.config||{}})}localStorage["dalliance."+this.cookieKey+".sources"]=JSON.stringify(e);for(var n={},s=[],o=0;o<this.hubObjects.length;++o){var a=this.hubObjects[o],u={url:a.hub.url,genome:a.genome};a.credentials&&(u.credentials=a.credentials),a.mapping&&(u.mapping=a.mapping),n[u.url]=!0,s.push(u)}for(var o=0;o<this.hubs.length;++o){var u=this.hubs[o];"string"==typeof u&&(u={url:u}),n[u.url]||s.push(u)}localStorage["dalliance."+this.cookieKey+".hubs"]=JSON.stringify(s),localStorage["dalliance."+this.cookieKey+".reverse-scrolling"]=this.reverseScrolling,localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"]=this.reverseKeyScrolling,localStorage["dalliance."+this.cookieKey+".single-base-highlight"]=this.singleBaseHighlight,localStorage["dalliance."+this.cookieKey+".ruler-location"]=this.rulerLocation,localStorage["dalliance."+this.cookieKey+".export-ruler"]=this.exportRuler,localStorage["dalliance."+this.cookieKey+".export-highlights"]=this.exportHighlights,localStorage["dalliance."+this.cookieKey+".version"]=l.CONFIG}},n.prototype.restoreStatus=function(){if(!this.noPersist){var e=localStorage["dalliance."+this.cookieKey+".version"];if(e=e?0|e:-100,l.CONFIG==e){var t=localStorage["dalliance."+this.cookieKey+".configHash"]||"",i=f(h({sources:this.sources,hubs:this.hubs,rulerLocation:this.rulerLocation}));if(i!=t)return void(localStorage["dalliance."+this.cookieKey+".configHash"]=i);for(var r={},n=0;n<this.sources.length;++n){var s=this.sources[n];if(s){var u=o(s),c=r[u];c||(r[u]=c=[]),c.push(s)}}if(!this.noPersistView){var p=localStorage["dalliance."+this.cookieKey+".view-chr"],d=0|localStorage["dalliance."+this.cookieKey+".view-start"],g=0|localStorage["dalliance."+this.cookieKey+".view-end"];if(p&&d&&g){this.chr=p,this.viewStart=d,this.viewEnd=g;var v=localStorage["dalliance."+this.cookieKey+".current-seq-length"];v&&(this.currentSeqMax=0|v),this.isSnapZooming="true"==localStorage["dalliance."+this.cookieKey+".showing-alt-zoom"];var y=parseFloat(localStorage["dalliance."+this.cookieKey+".saved-zoom"]);"number"!=typeof y||isNaN(y)||(this.savedZoom=y)}}var m=localStorage["dalliance."+this.cookieKey+".reverse-scrolling"];this.reverseScrolling=m&&"true"==m;var b=localStorage["dalliance."+this.cookieKey+".reverse-key-scrolling"];this.reverseKeyScrolling=b&&"true"==b;var w=localStorage["dalliance."+this.cookieKey+".single-base-highlight"];this.singleBaseHighlight=w&&"true"==w;var x=localStorage["dalliance."+this.cookieKey+".ruler-location"];x&&(this.rulerLocation=x);var S=localStorage["dalliance."+this.cookieKey+".export-ruler"];S&&(this.exportRuler="true"===S);var S=localStorage["dalliance."+this.cookieKey+".export-highlights"];S&&(this.exportHighlights="true"===S);var _=localStorage["dalliance."+this.cookieKey+".sources"];if(_){var T=JSON.parse(_);this.sources=[],this.restoredConfigs=[];for(var n=0;n<T.length;++n){var s=this.sources[n]=T[n].source;this.restoredConfigs[n]=T[n].config;for(var u=o(s),c=r[u]||[],C=0;C<c.length;++C){var k=c[C];if(a(s,k))for(var L in k)k.hasOwnProperty(L)&&("function"==typeof k[L]||k[L]instanceof Blob)&&(s[L]=k[L])}}}var O=localStorage["dalliance."+this.cookieKey+".hubs"];return O&&(this.hubs=JSON.parse(O)),!0}}},n.prototype.reset=function(){for(var e=this.tiers.length-1;e>=0;--e)this.removeTier({index:e},!0);for(var e=0;e<this.defaultSources.length;++e){var t=this.defaultSources[e];t.disabled||this.addTier(this.defaultSources[e])}this.highlights.splice(0,this.highlights.length),this.setLocation(this.defaultChr,this.defaultStart,this.defaultEnd)}},{"./cbrowser":6,"./sha1":37,"./sourcecompare":39,"./utils":55,"./version":57}],37:[function(e,t,i){"use strict";function r(e){return o(s(l(e)))}function n(e){return a(s(l(e)))}function s(e){return h(c(u(e),8*e.length))}function o(e){for(var t,i=v?"0123456789ABCDEF":"0123456789abcdef",r="",n=0;n<e.length;n++)t=e.charCodeAt(n),r+=i.charAt(t>>>4&15)+i.charAt(15&t);return r}function a(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",r=e.length,n=0;r>n;n+=3)for(var s=e.charCodeAt(n)<<16|(r>n+1?e.charCodeAt(n+1)<<8:0)|(r>n+2?e.charCodeAt(n+2):0),o=0;4>o;o++)i+=8*n+6*o>8*e.length?y:t.charAt(s>>>6*(3-o)&63);return i}function l(e){for(var t,i,r="",n=-1;++n<e.length;)t=e.charCodeAt(n),i=n+1<e.length?e.charCodeAt(n+1):0,t>=55296&&56319>=t&&i>=56320&&57343>=i&&(t=65536+((1023&t)<<10)+(1023&i),n++),127>=t?r+=String.fromCharCode(t):2047>=t?r+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?r+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(r+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return r}function u(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(var i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<24-i%32;return t}function h(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>24-i%32&255);return t}function c(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var i=Array(80),r=1732584193,n=-271733879,s=-1732584194,o=271733878,a=-1009589776,l=0;l<e.length;l+=16){for(var u=r,h=n,c=s,v=o,y=a,m=0;80>m;m++){16>m?i[m]=e[l+m]:i[m]=g(i[m-3]^i[m-8]^i[m-14]^i[m-16],1);var b=d(d(g(r,5),f(m,n,s,o)),d(d(a,i[m]),p(m)));a=o,o=s,s=g(n,30),n=r,r=b}r=d(r,u),n=d(n,h),s=d(s,c),o=d(o,v),a=d(a,y)}return Array(r,n,s,o,a)}function f(e,t,i,r){return 20>e?t&i|~t&r:40>e?t^i^r:60>e?t&i|t&r|i&r:t^i^r}function p(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function d(e,t){var i=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(i>>16);return r<<16|65535&i}function g(e,t){return e<<t|e>>>32-t}var v=0,y="";"undefined"!=typeof t&&(t.exports={b64_sha1:n,hex_sha1:r})},{}],38:[function(e,t,i){"use strict";function r(e,t){re[e]=t}function n(e,t){ne[e]=t}function s(e){return ne[e]?ne[e](e):void 0}function o(e){var t=this;this.source=e,this.cfsid="cfs"+ ++se,e.name&&(this.name=e.name),e.addChangeListener&&e.addChangeListener(function(){t.cfsid="cfs"+ ++se})}function a(){this.busy=0,this.activityListeners=[],this.readinessListeners=[],this.readiness=null}function l(e){this.dasSource=new B(e),this.busy=0,this.activityListeners=[]}function u(e){this.dasSource=new B(e),this.awaitedEntryPoints=new k;var t=this;this.dasSource.entryPoints(function(e){t.awaitedEntryPoints.provide(e)})}function h(e){var t=this;this.source=e,this.twoBit=new k;var i;if(e.twoBitURI)i=new G(e.twoBitURI,{credentials:e.credentials,resolver:e.resolver});else{if(!e.twoBitBlob)throw Error("No twoBitURI or twoBitBlob parameter");i=new D(e.twoBitBlob)}U(i,function(e,i){i?console.log(i):t.twoBit.provide(e)})}function c(e){this.source=e}function f(e){a.call(this);var t=this;if(this.readiness="Connecting",this.bwgSource=this.opts=e,t.bwgHolder=new k,this.opts.preflight){var i=oe[this.opts.preflight];if(!i){i=new k,oe[this.opts.preflight]=i;var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&(200==r.status?i.provide("success"):i.provide("failure"))},r.open("get",this.opts.preflight+"?"+hex_sha1("salt"+Date.now()),!0),this.opts.credentials&&(r.withCredentials=!0),r.send()}i.await(function(e){"success"===e&&t.init()})}else t.init()}function p(e,t,i){a.call(this);this.worker=t,this.readiness="Connecting",this.bwgSource=this.opts=e,this.keyHolder=new k,e.resolver&&(this.resolverKey=i.registerResolver(e.resolver)),this.init()}function d(e,t){if(!(e.flag&X.SEGMENT_UNMAPPED)){var i;if(i=e.seq?e.seq.length:e.seqLength,e.cigar){i=0;for(var r=Y(e.cigar),n=0;n<r.length;++n){var s=r[n];("M"==s.op||"D"==s.op)&&(i+=s.cnt)}}var o=new P;return o.min=e.pos+1,o.max=e.pos+i,o.segment=e.segment,o.type="bam",o.id=e.readName,o.notes=["MQ="+e.mq],o.cigar=e.cigar,o.seq=e.seq,o.quals=e.quals,o.orientation=e.flag&X.REVERSE_COMPLEMENT?"-":"+",o.bamRecord=e,t&&e.flag&X.MULTIPLE_SEGMENTS&&(o.groups=[{id:e.readName,type:"readpair"}]),o}}function g(e){a.call(this);var t=this;if(this.bamSource=e,this.opts={credentials:e.credentials,preflight:e.preflight,bamGroup:e.bamGroup},this.bamHolder=new k,this.opts.preflight){var i=oe[this.opts.preflight];if(!i){i=new k,oe[this.opts.preflight]=i;var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&(200==r.status?i.provide("success"):i.provide("failure"))},r.open("get",this.opts.preflight+"?"+hex_sha1("salt"+Date.now()),!0),this.opts.credentials&&(r.withCredentials="true"),r.send()}i.await(function(e){"success"===e&&t.init()})}else t.init()}function v(e,t){a.call(this);this.bamSource=e,this.worker=t,this.opts={credentials:e.credentials,preflight:e.preflight,bamGroup:e.bamGroup},this.keyHolder=new k,e.resolver&&(this.resolverKey=x.registerResolver(e.resolver)),this.init()}function y(e,t){this.source=e,this.mapping=t,this.activityListeners=[],this.busy=0}function m(){}function b(){}function w(e){this.store=new J(e.jbURI,e.jbQuery)}if("undefined"!=typeof e)var x=e("./cbrowser"),S=x.Browser,_=e("./tier"),T=_.DasTier,C=e("./utils"),k=C.Awaited,L=C.arrayIndexOf,O=C.shallowCopy,A=C.resolveUrlToPage,E=e("./das"),R=E.DASStylesheet,M=E.DASStyle,B=E.DASSource,I=E.DASSegment,P=E.DASFeature,H=E.DASSequence,N=E.DASLink,F=e("./bin"),G=F.URLFetchable,D=F.BlobFetchable,q=e("./twoBit"),U=q.makeTwoBit,z=e("./bigwig"),j=z.makeBwg,W=e("./bam"),V=W.makeBam,X=W.BamFlags,K=e("./spans"),Z=K.Range,Q=K.union,Y=e("./cigar").parseCigar,$=e("./overlay").OverlayFeatureSource,J=e("./jbjson").JBrowseStore,ee=e("./chainset").Chainset,te=e("./style"),ie=(te.StyleFilterSet,e("./encode").EncodeFetchable);var re={},ne={};T.prototype.initSources=function(){var e=this,t=this.browser.createSources(this.dasSource);this.featureSource=t.features||new m,this.sequenceSource=t.sequence,this.featureSource&&this.featureSource.addChangeListener&&this.featureSource.addChangeListener(function(){e.browser.refreshTier(e)})},S.prototype.createSources=function(e){var t=this.sourceCache.get(e);if(t)return t;var i,r;if("sequence"==e.tier_type||e.twoBitURI||e.twoBitBlob)r=e.twoBitURI||e.twoBitBlob?new h(e):e.ensemblURI?new c(e):new u(e);else if(e.tier_type&&re[e.tier_type]){var n=re[e.tier_type],s=n(e);i=s.features,r=s.sequence}else if(e.bwgURI||e.bwgBlob){var a=this.getWorker();i=a?new p(e,a,this):new f(e)}else if(e.bamURI||e.bamBlob){var a=this.getWorker();i=a?new v(e,a,this):new g(e)}else e.jbURI?i=new w(e):(e.uri||e.features_uri)&&(i=new l(e));if(e.overlay){var t=[];i&&t.push(new o(i));for(var d=0;d<e.overlay.length;++d){var m=this.createSources(e.overlay[d]);m&&m.features&&t.push(m.features)}i=new $(t,e)}return e.sequenceAliases&&(i=new y(i,new ee({type:"alias",sequenceAliases:e.sequenceAliases}))),e.mapping&&(i=new y(i,this.chains[e.mapping])),e.name&&i&&!i.name&&(i.name=e.name),"undefined"!=typeof i&&null!==i&&(i=new o(i)),("undefined"!=typeof i&&null!==i||"undefined"!=typeof r&&null!=r)&&(t={features:i,sequence:r},this.sourceCache.put(e,t)),t},T.prototype.fetchStylesheet=function(e){var t;t=!this.dasSource.stylesheet_uri&&(this.dasSource.tier_type||this.dasSource.bwgURI||this.dasSource.bwgBlob||this.dasSource.bamURI||this.dasSource.bamBlob||this.dasSource.twoBitURI||this.dasSource.twoBitBlob||this.dasSource.jbURI||this.dasSource.overlay)?this.getSource():new l(this.dasSource),t.getStyleSheet(e)};var se=0;o.prototype.addReadinessListener=function(e){return this.source.addReadinessListener?this.source.addReadinessListener(e):void e(null)},o.prototype.removeReadinessListener=function(e){return this.source.removeReadinessListener?this.source.removeReadinessListener(e):void 0},o.prototype.search=function(e,t){return this.source.search?this.source.search(e,t):void 0},o.prototype.getDefaultFIPs=function(e){return this.source.getDefaultFIPs?this.source.getDefaultFIPs(e):void 0},o.prototype.getStyleSheet=function(e){this.source.getStyleSheet(e)},o.prototype.getScales=function(){return this.source.getScales()},o.prototype.addActivityListener=function(e){this.source.addActivityListener&&this.source.addActivityListener(e)},o.prototype.removeActivityListener=function(e){this.source.removeActivityListener&&this.source.removeActivityListener(e)},o.prototype.addChangeListener=function(e){this.source.addChangeListener&&this.source.addChangeListener(e)},o.prototype.removeChangeListener=function(e){this.source.removeChangeListener&&this.source.removeChangeListener(e)},o.prototype.findNextFeature=function(e,t,i,r){this.source.findNextFeature(e,t,i,r)},o.prototype.quantFindNextFeature=function(e,t,i,r,n){this.source.quantFindNextFeature(e,t,i,r,n)},o.prototype.capabilities=function(){return this.source.capabilities?this.source.capabilities():{}},o.prototype.fetch=function(e,t,i,r,n,s,o,a){if(!s)throw Error("Fetch pool is null");var l=this,u=this.cfsid,h=s.awaitedFeatures[u];if(h&&h.started){if(h.styleFilters.doesNotContain(a))return void l.source.fetch(e,t,i,r,n,s,o,a)}else h?h.styleFilters.addAll(a):(h=new k,h.styleFilters=a,s.awaitedFeatures[u]=h,s.requestsIssued.then(function(){h.started=!0,l.source.fetch(e,t,i,r,h.styleFilters.typeList(),s,function(e,t,i,r){h.res||h.provide({status:e,features:t,scale:i,coverage:r})},h.styleFilters)})["catch"](function(e){console.log(e)}));h.await(function(e){o(e.status,e.features,e.scale,e.coverage)})},a.prototype.addReadinessListener=function(e){this.readinessListeners.push(e),e(this.readiness)},a.prototype.removeReadinessListener=function(e){var t=L(this.readinessListeners,e);t>=0&&this.readinessListeners.splice(t,1)},a.prototype.notifyReadiness=function(){for(var e=0;e<this.readinessListeners.length;++e)try{this.readinessListeners[e](this.readiness)}catch(t){console.log(t)}},a.prototype.addActivityListener=function(e){this.activityListeners.push(e)},a.prototype.removeActivityListener=function(e){var t=L(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,1)},a.prototype.notifyActivity=function(){for(var e=0;e<this.activityListeners.length;++e)try{this.activityListeners[e](this.busy)}catch(t){console.log(t)}},a.prototype.getScales=function(){return null},a.prototype.fetch=function(e,t,i,r,n,s,o){return o(null,[],1e9)},a.prototype.getStyleSheet=function(e){var t=new R,i=new M;return i.glyph="BOX",i.BGCOLOR="blue",i.FGCOLOR="black",t.pushStyle({type:"default"},null,i),e(t)},l.prototype.addActivityListener=function(e){this.activityListeners.push(e)},l.prototype.removeActivityListener=function(e){var t=L(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,1)},l.prototype.notifyActivity=function(){for(var e=0;e<this.activityListeners.length;++e)try{this.activityListeners[e](this.busy)}catch(t){console.log(t)}},l.prototype.getStyleSheet=function(e){this.dasSource.stylesheet(function(t){e(t)},function(){e(null,"Couldn't fetch DAS stylesheet")})},l.prototype.fetch=function(e,t,i,r,n,s,o){if(n&&0===n.length)return void o(null,[],r);if(this.dasSource.uri||this.dasSource.features_uri){if(this.dasSource.dasStaticFeatures&&this.cachedStaticFeatures)return o(null,this.cachedStaticFeatures,this.cachedStaticScale);var a=this.dasSource.maxbins!==!1,l={type:n};a&&(l.maxbins=1+((i-t)/r|0));var u=this;u.busy++,u.notifyActivity(),this.dasSource.features(new I(e,t,i),l,function(e,t){u.busy--,u.notifyActivity();var i=r;a||(i=.1),!t&&u.dasSource.dasStaticFeatures&&(u.cachedStaticFeatures=e,u.cachedStaticScale=i),o(t,e,i)})}},l.prototype.findNextFeature=function(e,t,i,r){if(this.dasSource.capabilities&&L(this.dasSource.capabilities,"das1:adjacent-feature")>=0){var n=this;if(this.dasAdjLock)return console.log("Already looking for a next feature, be patient!");this.dasAdjLock=!0;var s={adjacent:e+":"+(0|t)+":"+(i>0?"F":"B")},o=thisTier.getDesiredTypes(thisTier.browser.scale);o&&(s.types=o),thisTier.dasSource.features(null,s,function(e){n.dasAdjLock=!1,e.length>0&&null!==e[0]&&r(e[0])})}},u.prototype.fetch=function(e,t,i,r,n){this.dasSource.sequence(new I(e,t,i),function(e){return 1==e.length?n(null,e[0]):n("Didn't get sequence")})},u.prototype.getSeqInfo=function(e,t){this.awaitedEntryPoints.await(function(i){for(var r=0;r<i.length;++r)if(i[r].name==e)return t({length:i[r].end});return t()})},
h.prototype.fetch=function(e,t,i,r,n){this.twoBit.await(function(r){r.fetch(e,t,i,function(r,s){if(s)return n(s,null);var o=new H(e,t,i,"DNA",r);return n(null,o)})})},h.prototype.getSeqInfo=function(e,t){this.twoBit.await(function(i){var r=i.getSeq(e);r?i.getSeq(e).length(function(e){t({length:e})}):t()})},c.prototype.fetch=function(e,t,i,r,n){var s=this.source.ensemblURI+"/sequence/region/"+this.source.species+"/"+e+":"+t+".."+i+":1?content-type=application/json",o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState){var r;if(!(o.status>=300)){r=JSON.parse(o.response);var s=new H(e,t,i,"DNA",r.seq);return n(null,s)}var a="Error code "+o.status;try{r=JSON.parse(o.response),r.error&&(a=r.error)}finally{n(a,null)}}},o.open("GET",s,!0),o.responseType="text",o.send()},c.prototype.getSeqInfo=function(e,t){var i=this.source.ensemblURI+"/info/assembly/"+this.source.species+"/"+e+"?content-type=application/json",r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState)if(r.status>=300)t();else{var e=JSON.parse(r.response);t(e)}},r.open("GET",i,!0),r.responseType="text",r.send()},l.prototype.getScales=function(){return[]};var oe={};f.prototype=Object.create(a.prototype),f.prototype.init=function(){var e,t=this,i=this.bwgSource.uri||this.bwgSource.bwgURI;e=i?"encode"===this.bwgSource.transport?new ie(i,{credentials:this.opts.credentials}):new G(i,{credentials:this.opts.credentials,resolver:this.opts.resolver}):new D(this.bwgSource.bwgBlob),j(e,function(e,i){i?(t.error=i,t.readiness=null,t.notifyReadiness(),t.bwgHolder.provide(null)):(t.bwgHolder.provide(e),t.readiness=null,t.notifyReadiness(),"bigbed"==e.type&&e.getExtraIndices(function(e){t.extraIndices=e}))})},f.prototype.capabilities=function(){var e={leap:!0};if(this.bwgHolder.res&&"bigwig"==this.bwgHolder.res.type&&(e.quantLeap=!0),this.extraIndices&&this.extraIndices.length>0){e.search=[];for(var t=0;t<this.extraIndices.length;++t)e.search.push(this.extraIndices[t].field)}return e},f.prototype.fetch=function(e,t,i,r,n,s,o){var a=this;this.bwgHolder.await(function(s){if("undefined"==typeof s||null===s)return o(a.error||"Can't access binary file",null,null);var l,u=!n||0===n.length||L(n,"density")>=0;a.opts.clientBin&&(u=!1);var h=a.opts.scaleFactor||1;if("bigwig"==s.type||u||"undefined"!=typeof a.opts.forceReduction){for(var c=-1,f=0;f<s.zoomLevels.length&&s.zoomLevels[f].reduction<=r*h;++f)c=f;"undefined"!=typeof a.opts.forceReduction&&(c=a.opts.forceReduction),l=0>c?s.getUnzoomedView():s.getZoomedView(c)}else l=s.getUnzoomedView();a.busy++,a.notifyActivity(),l.readWigData(e,t,i,function(e){a.busy--,a.notifyActivity();var r=1e9;if("bigwig"===s.type){var n=(i-t)/e.length/2;r>n&&(r=n)}if(a.opts.link)for(var l=0;l<e.length;++l){var u=e[l];u.label&&(u.links=[new N("Link",a.opts.link.replace(/\$\$/,u.label))])}o(null,e,r)})})},f.prototype.quantFindNextFeature=function(e,t,i,r,n){var s=this;s.busy++,s.notifyActivity(),this.bwgHolder.res.thresholdSearch(e,t,i,r,function(e,t){return s.busy--,s.notifyActivity(),n(e,t)})},f.prototype.findNextFeature=function(e,t,i,r){var n=this;n.busy++,n.notifyActivity(),this.bwgHolder.res.getUnzoomedView().getFirstAdjacent(e,t,i,function(e){n.busy--,n.notifyActivity(),e.length>0&&null!==e[0]&&r(e[0])})},f.prototype.getScales=function(){var e=this.bwgHolder.res;if(e){for(var t=[1],i=0;i<e.zoomLevels.length;++i)t.push(e.zoomLevels[i].reduction);return t}return null},f.prototype.search=function(e,t){if(!this.extraIndices||0===this.extraIndices.length)return t(null,"No indices available");var i=this.extraIndices[0];return i.lookup(e,t)},f.prototype.getDefaultFIPs=function(e){return this.opts.noExtraFeatureInfo?!0:void this.bwgHolder.await(function(t){if(t&&t.schema&&t.definedFieldCount<t.schema.fields.length){var i=function(e,i){for(var r=0;r<i.hit.length;++r)if(i.hit[r].isSuperGroup)return;for(var n=t.definedFieldCount;n<t.schema.fields.length;++n){var s=t.schema.fields[n];i.add(s.comment,e[s.name])}};e(i)}})},f.prototype.getStyleSheet=function(e){this.bwgHolder.await(function(t){if(!t)return e(null,"bbi error");var i=new R;if("bigbed"==t.type){var r=new M;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="blue",r.HEIGHT=8,r.BUMP=!0,r.LABEL=!0,r.ZINDEX=20,i.pushStyle({type:"bigbed"},null,r),r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="red",r.HEIGHT=10,r.BUMP=!0,r.ZINDEX=20,i.pushStyle({type:"translation"},null,r);var n=new M;n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="white",n.HEIGHT=10,n.ZINDEX=10,n.BUMP=!0,n.LABEL=!0,i.pushStyle({type:"transcript"},null,n);var s=new M;s.glyph="HISTOGRAM",s.COLOR1="white",s.COLOR2="black",s.HEIGHT=30,i.pushStyle({type:"density"},null,s)}else{var r=new M;r.glyph="HISTOGRAM",r.COLOR1="white",r.COLOR2="black",r.HEIGHT=30,i.pushStyle({type:"default"},null,r)}return 12==t.definedFieldCount&&t.fieldCount>=14&&(i.geneHint=!0),e(i)})},p.prototype=Object.create(a.prototype),p.prototype.init=function(){var e=this,t=this.uri||this.bwgSource.uri||this.bwgSource.bwgURI,i=this.bwgSource.blob||this.bwgSource.bwgBlob,r=function(t,i){e.readiness=null,e.notifyReadiness(),t?e.worker.postCommand({command:"meta",connection:t},function(i,r){r?(e.error=r,e.keyHolder.provide(null)):(e.meta=i,e.keyHolder.provide(t))}):(e.error=i,e.keyHolder.provide(null))};i?this.worker.postCommand({command:"connectBBI",blob:i},r):this.worker.postCommand({command:"connectBBI",uri:A(t),resolver:this.resolverKey,transport:this.bwgSource.transport,credentials:this.bwgSource.credentials},r)},p.prototype.capabilities=function(){var e={leap:!0};if(this.meta&&"bigwig"==this.meta.type&&(e.quantLeap=!0),this.meta&&this.meta.extraIndices&&this.meta.extraIndices.length>0){e.search=[];for(var t=0;t<this.meta.extraIndices.length;++t)e.search.push(this.meta.extraIndices[t].field)}return e},p.prototype.fetch=function(e,t,i,r,n,s,o){var a=this;a.busy++,a.notifyActivity(),this.keyHolder.await(function(s){if(!s)return a.busy--,a.notifyActivity(),o(a.error||"Can't access binary file",null,null);var l=-1,u=!n||0===n.length||L(n,"density")>=0;if(a.opts.clientBin&&(u=!1),"bigwig"==a.meta.type||u||"undefined"!=typeof a.opts.forceReduction){for(var h=1;h<a.meta.zoomLevels.length&&a.meta.zoomLevels[h]<=r;++h)l=h-1;"undefined"!=typeof a.opts.forceReduction&&(l=a.opts.forceReduction)}a.worker.postCommand({command:"fetch",connection:s,chr:e,min:t,max:i,zoom:l},function(e,r){a.busy--,a.notifyActivity();var n=1e9;if("bigwig"===a.meta.type){var s=(i-t)/e.length/2;n>s&&(n=s)}if(a.opts.link)for(var l=0;l<e.length;++l){var u=e[l];u.label&&(u.links=[new N("Link",a.opts.link.replace(/\$\$/,u.label))])}o(r,e,n)})})},p.prototype.quantFindNextFeature=function(e,t,i,r,n){var s=this;this.busy++,this.notifyActivity(),this.worker.postCommand({command:"quantLeap",connection:this.keyHolder.res,chr:e,pos:t,dir:i,threshold:r,under:!1},function(e,t){return console.log(e,t),s.busy--,s.notifyActivity(),n(e,t)})},p.prototype.findNextFeature=function(e,t,i,r){var n=this;this.busy++,this.notifyActivity(),this.worker.postCommand({command:"leap",connection:this.keyHolder.res,chr:e,pos:t,dir:i},function(e,t){n.busy--,n.notifyActivity(),e.length>0&&null!==e[0]&&r(e[0])})},p.prototype.getScales=function(){var e=this.meta;return e?e.zoomLevels:null},p.prototype.search=function(e,t){if(!this.meta.extraIndices||0===this.meta.extraIndices.length)return t(null,"No indices available");var i=this;this.busy++,this.notifyActivity();var r=this.meta.extraIndices[0];this.worker.postCommand({command:"search",connection:this.keyHolder.res,query:e,index:r},function(e,r){i.busy--,i.notifyActivity(),t(e,r)})},p.prototype.getDefaultFIPs=function(e){if(this.opts.noExtraFeatureInfo)return!0;var t=this;this.keyHolder.await(function(i){var r=t.meta;if(r&&r.schema&&r.definedFieldCount<r.schema.fields.length){var n=function(e,t){for(var i=0;i<t.hit.length;++i)if(t.hit[i].isSuperGroup)return;for(var n=r.definedFieldCount;n<r.schema.fields.length;++n){var s=r.schema.fields[n];t.add(s.comment,e[s.name])}};e(n)}})},p.prototype.getStyleSheet=function(e){var t=this;this.keyHolder.await(function(i){var r=t.meta;if(!r)return e(null,"bbi error");var n=new R;if("bigbed"==r.type){var s=new M;s.glyph="BOX",s.FGCOLOR="black",s.BGCOLOR="blue",s.HEIGHT=8,s.BUMP=!0,s.LABEL=!0,s.ZINDEX=20,n.pushStyle({type:"bigbed"},null,s),s.glyph="BOX",s.FGCOLOR="black",s.BGCOLOR="red",s.HEIGHT=10,s.BUMP=!0,s.ZINDEX=20,n.pushStyle({type:"translation"},null,s);var o=new M;o.glyph="BOX",o.FGCOLOR="black",o.BGCOLOR="white",o.HEIGHT=10,o.ZINDEX=10,o.BUMP=!0,o.LABEL=!0,n.pushStyle({type:"transcript"},null,o);var a=new M;a.glyph="HISTOGRAM",a.COLOR1="white",a.COLOR2="black",a.HEIGHT=30,n.pushStyle({type:"density"},null,a)}else{var s=new M;s.glyph="HISTOGRAM",s.COLOR1="white",s.COLOR2="black",s.HEIGHT=30,n.pushStyle({type:"default"},null,s)}return 12==r.definedFieldCount&&r.fieldCount>=14&&(n.geneHint=!0),e(n)})},g.prototype=Object.create(a.prototype),g.prototype.init=function(){var e,t,i=this;this.bamSource.bamBlob?(e=new D(this.bamSource.bamBlob),t=new D(this.bamSource.baiBlob)):(e=new G(this.bamSource.bamURI,{credentials:this.opts.credentials,resolver:this.opts.resolver}),t=new G(this.bamSource.baiURI||this.bamSource.bamURI+".bai",{credentials:this.opts.credentials,resolver:this.opts.resolver})),V(e,t,null,function(e,t){i.readiness=null,i.notifyReadiness(),e?i.bamHolder.provide(e):(i.error=t,i.bamHolder.provide(null))})},g.prototype.fetch=function(e,t,i,r,n,s,o){var a=n&&1==n.length&&"density"==n[0],l=this;l.busy++,l.notifyActivity(),this.bamHolder.await(function(r){return r?void r.fetch(e,t,i,function(e,t){if(l.busy--,l.notifyActivity(),t)o(t,null,null);else{for(var i=[],r=0;r<e.length;++r){var n=e[r],s=d(n,l.opts.bamGroup);s&&i.push(s)}o(null,i,1e9)}},{light:a}):(l.busy--,l.notifyActivity(),o(l.error||"Couldn't fetch BAM"))})},g.prototype.getScales=function(){return 1e9},g.prototype.getStyleSheet=function(e){this.bamHolder.await(function(t){var i=new R,r=new M;r.glyph="HISTOGRAM",r.COLOR1="black",r.COLOR2="red",r.HEIGHT=30,i.pushStyle({type:"density"},"low",r),i.pushStyle({type:"density"},"medium",r);var n=new M;return n.glyph="__SEQUENCE",n.FGCOLOR="black",n.BGCOLOR="blue",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!1,n.ZINDEX=20,i.pushStyle({type:"bam"},"high",n),e(i)})},v.prototype=Object.create(a.prototype),v.prototype.init=function(){var e=this,t=this.bamSource.uri||this.bamSource.bamURI,i=this.bamSource.indexUri||this.bamSource.baiURI||t+".bai",r=this.bamSource.bamBlob||this.bamSource.blob,n=this.bamSource.baiBlob||this.bamSource.indexBlob,s=function(t,i){e.readiness=null,e.notifyReadiness(),t?e.keyHolder.provide(t):(e.error=i,e.keyHolder.provide(null))};r?this.worker.postCommand({command:"connectBAM",blob:r,indexBlob:n},s):this.worker.postCommand({command:"connectBAM",uri:A(t),resolver:this.resolverKey,indexUri:A(i),credentials:this.bamSource.credentials,indexChunks:this.bamSource.indexChunks},s)},v.prototype.fetch=function(e,t,i,r,n,s,o){var a=n&&1==n.length&&"density"==n[0],l=this;l.busy++,l.notifyActivity(),this.keyHolder.await(function(r){return r?void l.worker.postCommand({command:"fetch",connection:r,chr:e,min:t,max:i,opts:{light:a}},function(e,t){if(l.busy--,l.notifyActivity(),t)o(t,null,null);else{for(var i=[],r=0;r<e.length;++r){var n=e[r],s=d(n,l.opts.bamGroup);s&&i.push(s)}o(null,i,1e9)}}):(l.busy--,l.notifyActivity(),o(l.error||"Couldn't fetch BAM"))})},v.prototype.getScales=function(){return 1e9},v.prototype.getStyleSheet=function(e){this.keyHolder.await(function(t){var i=new R,r=new M;r.glyph="HISTOGRAM",r.COLOR1="black",r.COLOR2="red",r.HEIGHT=30,i.pushStyle({type:"density"},"low",r),i.pushStyle({type:"density"},"medium",r);var n=new M;return n.glyph="__SEQUENCE",n.FGCOLOR="black",n.BGCOLOR="blue",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!1,n.ZINDEX=20,i.pushStyle({type:"bam"},"high",n),e(i)})},y.prototype.addActivityListener=function(e){this.activityListeners.push(e)},y.prototype.removeActivityListener=function(e){var t=L(this.activityListeners,e);t>=0&&this.activityListeners.splice(t,0)},y.prototype.notifyActivity=function(){for(var e=0;e<this.activityListeners.length;++e)try{this.activityListeners[e](this.busy)}catch(t){console.log(t)}},y.prototype.getStyleSheet=function(e){return this.source.getStyleSheet(e)},y.prototype.getScales=function(){return this.source.getScales()},y.prototype.getDefaultFIPs=function(e){return this.source.getDefaultFIPs?this.source.getDefaultFIPs(e):void 0},y.prototype.simplifySegments=function(e,t){if(0===e.length)return e;e.sort(function(e,t){var i=e.name-t.name;return i?i:(i=e.start-t.start,i?i:e.end-t.end)});for(var i=[],r=e[0],n=0;n<e.length;++n){var s=e[n];s.name!=r.name||s.start>r.end+t?(i.push(r),r=s):r=new I(r.name,Math.min(r.start,s.start),Math.max(r.end,s.end))}return i.push(r),i},y.prototype.fetch=function(e,t,i,r,n,s,o,a){var l=this,u=i-t+1;l.busy++,l.notifyActivity(),this.mapping.sourceBlocksForRange(e,t,i,function(e){if(0===e.length)l.busy--,l.notifyActivity(),o("No mapping available for this regions",[],r);else{e=l.simplifySegments(e,Math.max(100,.05*u));var t,i=[],h=null,c=e.length;e.map(function(e){l.source.fetch(e.name,e.start,e.end,r,n,s,function(r,n,s){if(r&&!t&&(t=r),n)for(var a=0;a<n.length;++a){var u=n[a],f=u.segment;0===f.indexOf("chr")&&(f=f.substr(3));var p=l.mapping.mapSegment(f,u.min,u.max);if(0===p.length)u.parts&&u.parts.length>0&&i.push(u);else for(var d=0;d<p.length;++d){var g=p[d],v=O(u);v.segment=g.segment,v.min=g.min,v.max=g.max,g.partialMin&&(v.partialMin=g.partialMin),g.partialMax&&(v.partialMax=g.partialMax),g.flipped&&("-"==u.orientation?v.orientation="+":"+"==u.orientation&&(v.orientation="-")),i.push(v)}}var y=l.mapping.mapPoint(e.name,e.start),m=l.mapping.mapPoint(e.name,e.end);if(y&&m){var b=new Z(y.pos,m.pos);h=h?Q(h,b):b}--c,0===c&&(l.busy--,l.notifyActivity(),o(t,i,s,h))},a)})}})},m.prototype.getScales=function(){return null},m.prototype.fetch=function(e,t,i,r,n,s,o){return o(null,[],1e9)},m.prototype.getStyleSheet=function(e){var t=new R,i=new M;return i.glyph="BOX",i.BGCOLOR="blue",i.FGCOLOR="black",t.pushStyle({type:"default"},null,i),e(t)},b.prototype.fetch=function(e,t,i,r,n){return n(null,null)},w.prototype.getScales=function(){return null},w.prototype.getStyleSheet=function(e){var t=new R,i=new M;i.glyph="BOX",i.FGCOLOR="black",i.BGCOLOR="red",i.HEIGHT=10,i.BUMP=!0,i.ZINDEX=20,t.pushStyle({type:"translation"},null,i);var r=new M;r.glyph="BOX",r.FGCOLOR="black",r.BGCOLOR="white",r.HEIGHT=10,r.ZINDEX=10,r.BUMP=!0,r.LABEL=!0,t.pushStyle({type:"transcript"},null,r);var n=new M;return n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR="green",n.HEIGHT=8,n.BUMP=!0,n.LABEL=!0,n.ZINDEX=20,t.pushStyle({type:"default"},null,n),e(t)},w.prototype.fetch=function(e,t,i,r,n,s,o){if(n&&0===n.length)return void o(null,[],r);var a={};this.store.features(new I(e,t,i),a,function(e,t){o(t,e,1e5)})},S.prototype.sourceAdapterIsCapable=function(e,t){return e.capabilities?e.capabilities()[t]:!1},"undefined"!=typeof t&&(t.exports={FeatureSourceBase:a,TwoBitSequenceSource:h,EnsemblSequenceSource:c,DASSequenceSource:u,MappedFeatureSource:y,CachingFeatureSource:o,BWGFeatureSource:f,RemoteBWGFeatureSource:p,BAMFeatureSource:g,RemoteBAMFeatureSource:v,DummyFeatureSource:m,DummySequenceSource:b,registerSourceAdapterFactory:r,registerParserFactory:n,makeParser:s},e("./ensembljson"),e("./tabix-source"),e("./memstore"),e("./bedwig"),e("./vcf"),e("./test-source"))},{"./bam":1,"./bedwig":2,"./bigwig":3,"./bin":4,"./cbrowser":6,"./chainset":7,"./cigar":8,"./das":10,"./encode":14,"./ensembljson":15,"./jbjson":24,"./memstore":27,"./overlay":30,"./spans":40,"./style":41,"./tabix-source":45,"./test-source":47,"./tier":51,"./twoBit":54,"./utils":55,"./vcf":56}],39:[function(e,t,i){"use strict";function r(e){return e.uri?e.uri:e.blob?"file:"+e.blob.name:e.bwgBlob?"file:"+e.bwgBlob.name:e.bamBlob?"file:"+e.bamBlob.name:e.twoBitBlob?"file:"+e.twoBitBlob.name:e.bwgURI||e.bamURI||e.jbURI||e.twoBitURI||"https://www.biodalliance.org/magic/no_uri"}function n(e){return e.stylesheet_uri?e.stylesheet_uri:"sequence"==e.tier_type||e.twoBitURI||e.twoBitBlob?"https://www.biodalliance.org/magic/sequence":r(e)}function s(e,t){if(r(e)!=r(t))return!1;if(e.mapping!=t.mapping)return!1;if(e.tier_type!=t.tier_type)return!1;if(e.overlay){if(!t.overlay||t.overlay.length!=e.overlay.length)return!1;for(var i=0;i<e.overlay.length;++i)if(!s(e.overlay[i],t.overlay[i]))return!1}else if(t.overlay)return!1;return!0}function o(e,t){if(r(e)!=r(t)||n(e)!=n(t))return!1;if(e.mapping!=t.mapping)return!1;if(e.tier_type!=t.tier_type)return!1;if(e.overlay){if(!t.overlay||t.overlay.length!=e.overlay.length)return!1;for(var i=0;i<e.overlay.length;++i)if(!o(e.overlay[i],t.overlay[i]))return!1}else if(t.overlay)return!1;return!0}"undefined"!=typeof t&&(t.exports={sourcesAreEqual:o,sourcesAreEqualModuloStyle:s,sourceDataURI:r,sourceStyleURI:n})},{}],40:[function(e,t,i){"use strict";function r(e,t){if("number"!=typeof e||"number"!=typeof t)throw"Bad range "+e+","+t;this._min=e,this._max=t}function n(e){var t=e.sort(u),i=[],r=t.shift();t.forEach(function(e){e._min<=r._max?e._max>r._max&&(r._max=e._max):(i.push(r),r=e)}),i.push(r),this._ranges=i}function s(e,t){return e instanceof n||(e instanceof Array||(e=[e]),e=new n(e)),t&&e.insertRange(t),e}function o(e,t){for(var i=e.ranges(),s=t.ranges(),o=i.length,a=s.length,l=0,u=0,h=[];o>l&&a>u;){var e=i[l],t=s[u],c=Math.max(e.min(),t.min()),f=Math.min(e.max(),t.max());f>=c&&h.push(new r(c,f)),e.max()>t.max()?++u:++l}return 0==h.length?null:1==h.length?h[0]:new n(h)}function a(e){for(var t=0,i=e.ranges(),r=0;r<i.length;++r){var n=i[r];t+=n.max()-n.min()+1}return t}function l(e,t){return e.min()<t.min()?-1:e.min()>t.min()?1:e.max()<t.max()?-1:t.max()>e.max()?1:0}function u(e,t){return e._min<t._min?-1:e._min>t._min?1:e._max<t._max?-1:t._max>e._max?1:0}r.prototype.min=function(){return this._min},r.prototype.max=function(){return this._max},r.prototype.contains=function(e){return e>=this._min&&e<=this._max},r.prototype.isContiguous=function(){return!0},r.prototype.ranges=function(){return[this]},r.prototype._pushRanges=function(e){e.push(this)},r.prototype.toString=function(){return"["+this._min+"-"+this._max+"]"},n.prototype.min=function(){return this._ranges[0].min()},n.prototype.max=function(){return this._ranges[this._ranges.length-1].max()},n.prototype.lower_bound=function(e){var t=this.ranges();if(e>this.max())return t.length;if(e<this.min())return 0;for(var i=0,r=t.length-1;r>=i;){var n=Math.floor((i+r)/2);if(e>t[n]._max)i=n+1;else{if(!(e<t[n]._min))return n;r=n-1}}return i},n.prototype.contains=function(e){var t=this.lower_bound(e);return t<this._ranges.length&&this._ranges[t].contains(e)?!0:!1},n.prototype.insertRange=function(e){var t=this.lower_bound(e._min);if(t===this._ranges.length)return void this._ranges.push(e);var i=this.ranges();if(e._max<i[t]._min)return void this._ranges.splice(t,0,e);i[t]._min<e._min&&(e._min=i[t]._min);for(var r=t+1;r<i.length&&i[r]._min<=e._max;)r++;r--,i[r]._max>e._max&&(e._max=i[r]._max),this._ranges.splice(t,r-t+1,e)},n.prototype.isContiguous=function(){return this._ranges.length>1},n.prototype.ranges=function(){return this._ranges},n.prototype._pushRanges=function(e){for(var t=0;t<this._ranges.length;++t)e.push(this._ranges[t])},n.prototype.toString=function(){for(var e="",t=0;t<this._ranges.length;++t)t>0&&(e+=","),e+=this._ranges[t].toString();return e},"undefined"!=typeof t&&(t.exports={Range:r,union:s,intersection:o,coverage:a,rangeOver:l,_rangeOrder:u})},{}],41:[function(e,t,i){"use strict";function r(e,t,i){this.type=e,this.method=t,this.label=i}function n(e){if(this._filters={},e)for(var t=0;t<e.length;++t)this.add(e[t])}r.prototype.equals=function(e){return this.type==e.type&&this.method==e.method&&this.label==e.label},r.prototype.toString=function(){var e=[];return this.type&&e.push("type="+this.type),this.method&&e.push("method="+this.method),this.label&&e.push("label="+this.label),"StyleFilter<"+e.join(";")+">"},n.prototype.add=function(e){var t=e.toString();this._filters[t]||(this._filters[t]=e,this._list=null)},n.prototype.addAll=function(e){for(var t=e.list(),i=0;i<t.length;++i)this.add(t[i])},n.prototype.doesNotContain=function(e){for(var t=e.list(),i=0;i<t.length;++i)if(!this._filters[i.toString()])return!0;return!1},n.prototype.list=function(){if(!this._list){this._list=[];for(var e in this._filters)this._filters.hasOwnProperty(e)&&this._list.push(this._filters[e])}return this._list},n.prototype.typeList=function(){for(var e=[],t=this.list(),i=0;i<t.length;++i){var r=t[i],n=r.type;if(!n||"default"==n)return null;e.indexOf(n)<0&&e.push(n)}return e},"undefined"!=typeof t&&(t.exports={StyleFilter:r,StyleFilterSet:n})},{}],42:[function(e,t,i){"use strict";function r(e,t){n(t),t.updateStatus(e)}function n(e){var t=e.browser,i=t.tiers.filter(function(t){return"multi"===t.dasSource.renderer&&t.dasSource.multi.multi_id===e.dasSource.sub.multi_id});i.forEach(function(e){return t.refreshTier(e)})}Object.defineProperty(i,"__esModule",{value:!0}),i.renderTier=r,i.drawTier=n},{}],43:[function(e,t,i){"use strict";if("undefined"!=typeof e)var r=e("./cbrowser"),n=r.Browser,s=e("./utils"),o=(s.makeElement,s.makeElementNS),a=e("./version"),l=e("./sequence-draw").svgSeqTier,u=e("./svg-utils"),h=u.NS_SVG,c=u.NS_XLINK,f=u.SVGPath,p=e("./numformats"),d=p.formatQuantLabel,g=p.formatLongInt;n.prototype.makeSVG=function(e){e=e||{};var t=e.minTierHeight||20,i=3,r=e.width||this.featurePanelWidth,n=this.featurePanelWidth,s=this.scale;this.featurePanelWidth=r,this.scale=this.featurePanelWidth/(this.viewEnd-this.viewStart);var u=this,p=document.implementation.createDocument(h,"svg",null),v=o(h,"g",null,{fontFamily:"helvetica",fontSize:"8pt"});p.documentElement.appendChild(v);var y=200;if(e.banner){var m=o(h,"a",o(h,"text","Graphics from Biodalliance "+a,{x:u.featurePanelWidth+y-100,y:35,strokeWidth:0,fontSize:"12pt",textAnchor:"end",fill:"blue"}));m.setAttribute("xmlns:xlink",c),m.setAttribute("xlink:href","http://www.biodalliance.org/"),v.appendChild(m)}e.region&&v.appendChild(o(h,"text",this.chr+":"+g(this.viewStart)+".."+g(this.viewEnd),{x:y+100,y:35,strokeWidth:0,fontSize:"12pt",textAnchor:"start"}));var b=o(h,"rect",null,{x:y,y:50,width:u.featurePanelWidth,height:1e5}),w=o(h,"clipPath",b,{id:"featureClip"});v.appendChild(w);for(var x=70,S=o(h,"g",null,{}),_=0;_<u.tiers.length;++_){var T=u.tiers[_];T.backupSubtiers=T.subtiers,T.backupOriginHaxx=T.originHaxx,T.backupLayoutHeight=T.layoutHeight;var C=u.getTierRenderer(T);C&&C.prepareSubtiers&&C.prepareSubtiers(T,T.viewport.getContext("2d"));var k=o(h,"g",null,{clipPath:"url(#featureClip)",clipRule:"nonzero"}),L=o(h,"g"),O=x,A=o(h,"rect",null,{x:0,y:O,width:"10000",height:50,fill:T.background});if(k.appendChild(A),T.sequenceSource){var E=l(T,T.currentSequence);k.appendChild(o(h,"g",E,{transform:"translate("+y+", "+x+")"})),x+=80}else{if(!T.subtiers)continue;for(var R=(T.glyphCacheOrigin-u.viewStart)*u.scale,M=!1,B=0;B<T.subtiers.length;++B){x+=i;for(var I=T.subtiers[B],P=[],H=0;H<I.glyphs.length;++H){var N=I.glyphs[H];P.push(N.toSVG())}if(k.appendChild(o(h,"g",P,{transform:"translate("+(y+R)+", "+x+")"})),I.quant){M=!0;var F=I.quant,G=I.height,D=2;G>40&&(D=1+(G/20|0));var q=G/(D-1),U=(F.max-F.min)/(D-1),z=new f;z.moveTo(y+5,x),z.lineTo(y,x),z.lineTo(y,x+I.height),z.lineTo(y+5,x+I.height);for(var j=1;D-1>j;++j){var W=j*q;z.moveTo(y,x+W),z.lineTo(y+3,x+W)}L.appendChild(o(h,"path",null,{d:z.toPathData(),fill:"none",stroke:"black",strokeWidth:"2px"})),L.appendChild(o(h,"text",d(F.max),{x:y-3,y:x+7,textAnchor:"end"})),L.appendChild(o(h,"text",d(F.min),{x:y-3,y:x+I.height,textAnchor:"end"}));for(var j=1;D-1>j;++j){var W=j*q;L.appendChild(o(h,"text",d(1*F.max-j*U),{x:y-3,y:x+W+3,textAnchor:"end"}))}}x+=I.height+i}t>x-O&&(x=O+t)}var V;V="string"==typeof T.config.name?T.config.name:T.dasSource.name,L.appendChild(o(h,"text",V,{x:y-(M?20:12),y:(x+O+8)/2,fontSize:"10pt",textAnchor:"end"})),A.setAttribute("height",x-O),S.appendChild(o(h,"g",[k,L])),T.subtiers=T.backupSubtiers,T.originHaxx=T.backupOriginHaxx,T.layoutHeight=T.backupLayoutHeight}if(e.highlights)for(var X=this.highlights||[],K=0;K<X.length;++K){var G=X[K];if((G.chr==this.chr||G.chr=="chr"+this.chr)&&G.min<this.viewEnd&&G.max>this.viewStart){var Z=(Math.max(G.min,this.viewStart)-this.viewStart)*this.scale,Q=(Math.min(G.max,this.viewEnd)-this.viewStart)*this.scale;S.appendChild(o(h,"rect",null,{x:y+Z,y:70,width:Q-Z,height:x-70,stroke:"none",fill:this.defaultHighlightFill,fillOpacity:this.defaultHighlightAlpha}))}}var Y=-1;"center"==e.ruler?Y=y+(this.viewEnd-this.viewStart)*this.scale/2:"left"==e.ruler?Y=y:"right"==e.ruler&&(Y=y+(this.viewEnd-this.viewStart)*this.scale),Y>=0&&S.appendChild(o(h,"line",null,{x1:Y,y1:70,x2:Y,y2:x,stroke:"blue"})),v.appendChild(S),p.documentElement.setAttribute("width",u.featurePanelWidth+20+y),p.documentElement.setAttribute("height",x+50),this.featurePanelWidth=n,this.scale=s;var $=void 0;if("undefined"!=typeof XMLSerializer)$=(new XMLSerializer).serializeToString(p);else{var J=p.documentElement;J.setAttribute("xmlns","http://www.w3.org/2000/svg"),$=J.outerHTML}return e.output&&"string"===e.output?$:new Blob([$],{type:"image/svg+xml"})}},{"./cbrowser":6,"./numformats":29,"./sequence-draw":35,"./svg-utils":44,"./utils":55,"./version":57}],44:[function(e,t,i){"use strict";function r(){this.ops=[]}var n="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink";r.prototype.moveTo=function(e,t){this.ops.push("M "+e+" "+t)},r.prototype.lineTo=function(e,t){this.ops.push("L "+e+" "+t)},r.prototype.closePath=function(){this.ops.push("Z")},r.prototype.toPathData=function(){return this.ops.join(" ")},"undefined"!=typeof t&&(t.exports={NS_SVG:n,NS_XLINK:s,SVGPath:r})},{}],45:[function(e,t,i){"use strict";function r(e){a.call(this),this.readiness="Connecting",this.source=e,this.tabixHolder=new f;var t=this,i=o(e.payload);if(!i)throw"Unsuported tabix payload "+e.payload;this.parser=i;var r,n;this.source.blob?(r=new h(this.source.blob),n=new h(this.source.indexBlob)):(r=new u(this.source.uri,{credentials:this.source.credentials,resolver:this.source.resolver}),n=new u(this.source.indexURI||this.source.uri+".tbi",{credentials:this.source.credentials,resolver:this.source.resolver})),p(r,n,function(e,r){t.tabixHolder.provide(e),e.fetchHeader(function(e,t){if(e){for(var r=i.createSession(function(){}),n=0;n<e.length;++n)r.parse(e[n]);r.flush()}}),t.readiness=null,t.notifyReadiness()})}if("undefined"!=typeof e)var n=e("./sourceadapters"),s=n.registerSourceAdapterFactory,o=n.makeParser,a=n.FeatureSourceBase,l=e("./bin"),u=l.URLFetchable,h=l.BlobFetchable,c=e("./utils"),f=c.Awaited,p=e("./tabix").connectTabix;r.prototype=Object.create(a.prototype),r.prototype.fetch=function(e,t,i,r,n,s,o){var a=this;a.busy++,a.notifyActivity(),this.tabixHolder.await(function(r){r.fetch(e,t,i,function(e,t){a.busy--,a.notifyActivity();for(var i=[],r=a.parser.createSession(function(e){i.push(e)}),n=0;n<e.length;++n){r.parse(e[n])}r.flush(),o(null,i,1e9)})})},r.prototype.getStyleSheet=function(e){this.parser&&this.parser.getStyleSheet&&this.parser.getStyleSheet(e)},r.prototype.getDefaultFIPs=function(e){this.parser&&this.parser.getDefaultFIPs&&this.parser.getDefaultFIPs(e)},s("tabix",function(e){return{features:new r(e)}})},{"./bin":4,"./sourceadapters":38,"./tabix":46,"./utils":55}],46:[function(e,t,i){"use strict";function r(){}function n(e,t,i){var n=new r;n.data=e,n.tbi=t,n.tbi.fetch(function(e){if(!e)return i(null,"Couldn't access Tabix");var t=c(e,e.byteLength),r=new Uint8Array(t),o=l(r,0);if(o!=s)return i(null,"Not a tabix index");var a=l(r,4);n.format=l(r,8),n.colSeq=l(r,12),n.colStart=l(r,16),n.colEnd=l(r,20),n.meta=l(r,24),n.skip=l(r,28);l(r,32);n.indices=[];var u=36;n.chrToIndex={},n.indexToChr=[];for(var f=0;a>f;++f){for(var p="";;){var d=r[u++];if(0==d)break;p+=String.fromCharCode(d)}n.chrToIndex[p]=f,0==p.indexOf("chr")?n.chrToIndex[p.substring(3)]=f:n.chrToIndex["chr"+p]=f,n.indexToChr.push(p)}for(var g=1e9,v=0;a>v;++v){var y=u,m=l(r,u);u+=4;for(var b=0;m>b;++b){var w=(l(r,u),l(r,u+4));u+=8+16*w}var x=l(r,u);u+=4;for(var S=u,f=0;x>f;++f){var _=h(r,S);if(S+=8,_){var T=_.block;_.offset>0&&(T+=65536),g>T&&(g=T);break}}u+=8*x;m>0&&(n.indices[v]=new Uint8Array(t,y,u-y))}n.headerMax=g,i(n)},{timeout:5e4})}var s=21578324;if("undefined"!=typeof e)var o=e("./spans"),a=(o.Range,o.union,o.intersection,e("./bin")),l=a.readInt,u=(a.readShort,a.readByte,a.readInt64,a.readFloat,e("./lh3utils")),h=u.readVob,c=u.unbgzf,f=u.reg2bins,p=u.Chunk;r.prototype.blocksForRange=function(e,t,i){var r=this.indices[e];if(!r)return[];for(var n=f(t,i),s=[],o=0;o<n.length;++o)s[n[o]]=!0;for(var a=[],u=[],c=l(r,0),d=4,g=0;c>g;++g){var v=l(r,d),y=l(r,d+4);if(d+=8,s[v])for(var m=0;y>m;++m){var b=h(r,d,!0),w=h(r,d+8,!0);(4681>v?u:a).push(new p(b,w)),d+=16}else d+=16*y}for(var x=l(r,d),S=null,_=Math.min(t>>14,x-1),T=Math.min(i>>14,x-1),o=_;T>=o;++o){var C=h(r,d+4+8*o);C&&(!S||C.block<S.block||C.offset<S.offset)&&(S=C)}var k=[];if(null!=S)for(var o=0;o<u.length;++o){var L=u[o];L.maxv.block>=S.block&&L.maxv.offset>=S.offset&&k.push(L)}u=k;for(var O=[],o=0;o<u.length;++o)O.push(u[o]);for(var o=0;o<a.length;++o)O.push(a[o]);O.sort(function(e,t){var i=e.minv.block-t.minv.block;return 0!=i?i:e.minv.offset-t.minv.offset});var A=[];if(O.length>0){for(var E=O[0],o=1;o<O.length;++o){var R=O[o];R.minv.block==E.maxv.block?E=new p(E.minv,R.maxv):(A.push(E),E=R)}A.push(E)}return A},r.prototype.fetch=function(e,t,i,r){function n(){if(f>=a.length)return r(h);if(u){var e=new Uint8Array(u);return s.readRecords(e,a[f].minv.offset,h,t,i,l),u=null,++f,n()}var o=a[f],p=o.minv.block,d=o.maxv.block+65536;s.data.slice(p,d-p).fetch(function(e){return u=c(e,o.maxv.block-o.minv.block+1),n()})}var s=this,o=this.chrToIndex[e];if(void 0==o)return r([]);var a,l=this.indexToChr[o];void 0===o?a=[]:(a=this.blocksForRange(o,t,i),a||r(null,"Error in index fetch"));var u,h=[],f=0;n()},r.prototype.readRecords=function(e,t,i,r,n,s){e:for(;;){for(var o="";t<e.length;){var a=e[t++];if(10==a){var l=o.split("	");if(l[this.colSeq-1]==s){var u=parseInt(l[this.colStart-1]),h=u;this.colEnd>0&&(h=parseInt(l[this.colEnd-1])),65536&this.format&&++u,n>=u&&h>=r&&i.push(o)}continue e}o+=String.fromCharCode(a)}return}},r.prototype.fetchHeader=function(e){var t=this;t.data.slice(0,t.headerMax).fetch(function(i){if(!i)return e(null,"Fetch failed");for(var r=new Uint8Array(c(i,i.byteLength)),n=0,s="",o=[];n<r.length;){var a=r[n++];if(10==a){if(s.charCodeAt(0)!=t.meta)return e(o);o.push(s),s=""}else s+=String.fromCharCode(a)}e(o)})},"undefined"!=typeof t&&(t.exports={connectTabix:n,TABIX_MAGIC:s})},{"./bin":4,"./lh3utils":26,"./spans":40}],47:[function(e,t,i){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),l=e("./sourceadapters.js"),u=e("./das.js"),h=e("ramda"),c=r(h),f=function(e){function t(e){n(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.features=c.defaultTo([],e.features),i}return o(t,e),a(t,[{key:"genFeature",value:function(e){var t=new u.DASFeature;for(var i in e)t[i]=e[i]}},{key:"fetch",
value:function(e,t,i,r,n,s,o){var a=c.forEach(this.genFeature,this.features);return o(null,a,1)}}]),t}(l.FeatureSourceBase);(0,l.registerSourceAdapterFactory)("test-source",function(e){return{features:new f(e)}})},{"./das.js":10,"./sourceadapters.js":38,ramda:62}],48:[function(e,t,i){"use strict";function r(e){this.genomes={},this.url=e}function n(){}function s(e){this.hub=e}function o(e,t,i){i=i||{},i.salt=!0,u(e,function(n,o){if(o)return t(null,o);var a=n.split(v),l=new r(e);i.credentials&&(l.credentials=i.credentials);for(var c=0;c<a.length-2;c+=3)l[a[c+1]]=a[c+2];if(l.genomesFile){var f=h(e,l.genomesFile);u(f,function(e,r){if(r)return t(null,r);for(var n=e.split(g),o=0;o<n.length;++o){var a=n[o].split(v),u=new s(l);i.credentials&&(u.credentials=i.credentials);for(var c=0;c<a.length-2;c+=3)u[a[c+1]]=a[c+2];u.twoBitPath&&(u.twoBitPath=h(f,u.twoBitPath)),u.genome&&u.trackDb&&(u.absURL=h(f,u.trackDb),l.genomes[u.genome]=u)}t(l)},i)}else t(null,"No genomesFile")},i)}function a(e,t){return e.priority&&t.priority?1*e.priority-1*t.priority:e.priority?1:t.priority?-1:e.shortLabel.localeCompare(t.shortLabel)}if("undefined"!=typeof e)var l=e("./utils"),u=l.textXHR,h=l.relativeURL,c=l.shallowCopy,f=e("./das"),p=f.DASStylesheet,d=f.DASStyle;var g=/\n\s*\n/,v=/(\w+) +(.+)\n?/,y=/subGroup[1-9]/,m="http://genome.ucsc.edu/images/";n.prototype.get=function(e){return this[e]?this[e]:this._parent?this._parent.get(e):void 0},s.prototype.getTracks=function(e){var t=this;return this._tracks?e(this._tracks):void u(this.absURL,function(i,r){if(r)return e(null,r);i=i.replace("\\\n"," ");for(var s=[],o={},a=i.split(g),l=0;l<a.length;++l){var u=a[l].replace(/\#.*/g,"").split(v),h=new n;h._db=t;for(var c=0;c<u.length-2;c+=3){var f=u[c+1],p=u[c+2];if(f.match(y)){h.subgroups||(h.subgroups={});for(var d=p.split(/\s/),m=d[0],b={name:d[1],tags:[],titles:[]},w=2;w<d.length;++w){var x=d[w].split(/=/);b.tags.push(x[0]),b.titles.push(x[1])}h.subgroups[m]=b}else if("subGroups"===f){var d=p.split(/(\w+)=(\w+)/);h.sgm={};for(var w=0;w<d.length-2;w+=3)h.sgm[d[w+1]]=d[w+2]}else h[u[c+1]]=u[c+2]}h.track&&(h.type||h.container||h.view||h.bigDataUrl)&&(s.push(h),o[h.track]=h)}for(var S=[],_=[],T=0;T<s.length;++T){var h=s[T],C=!0;if(h.parent){var k=h.parent.split(/\s+/),L=o[k[0]];L?(h._parent=L,L.children||(L.children=[]),L.children.push(h),L&&(C=!1)):console.log("Couldn't find parent "+k[0]+"("+h.parent+")")}h.compositeTrack?_.push(h):C&&S.push(h)}for(var O=0;O<_.length;++O){var A=_[O];if(A.children){for(var E=!1,R=0;R<A.children.length;++R){var f=A.children[R];f.view&&(f.shortLabel=A.shortLabel+": "+f.shortLabel,S.push(f),E=!0)}E||S.push(A)}}return t._tracks=S,e(t._tracks,null)},{credentials:this.credentials,salt:!0})},n.prototype.toDallianceSource=function(){var e={name:this.shortLabel,desc:this.longLabel};this._db.mapping&&(e.mapping=this._db.mapping);var t=this.get("pennantIcon");if(t){var i=t.split(/\s+/);e.pennant=m+i[0]}var r=this.get("searchTrix");if(r&&(e.trixURI=h(this._db.absURL,r)),"multiWig"==this.container){e.merge="concat",e.overlay=[];var n=this.children||[];e.style=[],e.noDownsample=!0;for(var s=0;s<n.length;++s){var o=n[s],a=o.toDallianceSource();if(e.overlay.push(a),a.style)for(var l=0;l<a.style.length;++l){var u=a.style[l];u.method=o.shortLabel,"transparentOverlay"==this.aggregate&&(u.style.ALPHA=.5),e.style.push(u)}}return e}var c=this.type;if(!c){for(var f=this;f._parent&&!f.type;)f=f._parent;c=f.type}if(c){var p=c.split(/\s+/);if("bigBed"==p[0]&&this.bigDataUrl){var d=0|p[1],g="+"==p[2];return e.bwgURI=h(this._db.absURL,this.bigDataUrl),e.style=this.bigbedStyles(),this._db.credentials&&(e.credentials=!0),d>=12&&g&&(e.collapseSuperGroups=!0),e}return"bigWig"==p[0]&&this.bigDataUrl?(e.bwgURI=h(this._db.absURL,this.bigDataUrl),e.style=this.bigwigStyles(),e.noDownsample=!0,this.yLineOnOff&&"on"==this.yLineOnOff&&(e.quantLeapThreshold=void 0!==this.yLineMark?1*this.yLineMark:0),this._db.credentials&&(e.credentials=!0),e):"bam"==p[0]&&this.bigDataUrl?(e.bamURI=h(this._db.absURL,this.bigDataUrl),this._db.credentials&&(e.credentials=!0),e):"vcfTabix"==p[0]&&this.bigDataUrl?(e.uri=h(this._db.absURL,this.bigDataUrl),e.tier_type="tabix",e.payload="vcf",this._db.credentials&&(e.credentials=!0),e):void console.log("Unsupported "+this.type)}},n.prototype.bigwigStyles=function(){var e=this.type;if(!e){for(var t=this;t._parent&&!t.type;)t=t._parent;e=t.type}if(e){var i,r,n=e.split(/\s+/);n.length>=3&&(i=1*n[1],r=1*n[2]);var s;if(this.maxHeightPixels){var o=this.maxHeightPixels.split(/:/);3==o.length?s=0|o[1]:console.log("maxHeightPixels should be of the form max:default:min")}var a="bars";this.graphTypeDefault&&(a=this.graphTypeDefault);var l="black",u=null;this.color&&(l="rgb("+this.color+")"),this.altColor&&(u="rgb("+this.altColor+")");var h=new p,c=new d;return"points"==a?c.glyph="POINT":c.glyph="HISTOGRAM",u?(c.COLOR1=l,c.COLOR2=u):c.BGCOLOR=l,c.HEIGHT=s||30,(i||r)&&(c.MIN=i,c.MAX=r),h.pushStyle({type:"default"},null,c),h.styles}},n.prototype.bigbedStyles=function(){var e="on"==(""+this.get("itemRgb")).toLowerCase(),t=this.get("visibility")||"full",i=this.get("color");i=i?"rgb("+i+")":"blue";var r=new p,n=new d;n.glyph="BOX",n.FGCOLOR="black",n.BGCOLOR=i,n.HEIGHT="full"==t||"pack"==t?12:8,n.BUMP="full"==t||"pack"==t,n.LABEL="full"==t||"pack"==t,n.ZINDEX=20,e&&(n.BGITEM=!0);var s=this.get("colorByStrand");if(s){var o=s.split(/\s+/),a=c(n);a.BGCOLOR="rgb("+o[0]+")",r.pushStyle({type:"bigbed",orientation:"+"},null,a);var l=c(n);l.BGCOLOR="rgb("+o[1]+")",r.pushStyle({type:"bigbed",orientation:"-"},null,l)}else r.pushStyle({type:"bigbed"},null,n);var u=new d;u.glyph="BOX",u.FGCOLOR="black",e&&(u.BGITEM=!0),u.BGCOLOR="red",u.HEIGHT=10,u.BUMP=!0,u.ZINDEX=20,r.pushStyle({type:"translation"},null,u);var h=new d;return h.glyph="BOX",h.FGCOLOR="black",h.BGCOLOR="white",h.HEIGHT=10,h.ZINDEX=10,h.BUMP=!0,h.LABEL=!0,r.pushStyle({type:"transcript"},null,h),r.styles},"undefined"!=typeof t&&(t.exports={connectTrackHub:o,THUB_COMPARE:a})},{"./das":10,"./utils":55}],49:[function(e,t,i){"use strict";if("undefined"!=typeof e)var r=e("./cbrowser"),n=r.Browser,s=e("./utils"),o=s.shallowCopy;n.prototype.mergeSelectedTiers=function(){for(var e=[],t=[],i=0;i<this.selectedTiers.length;++i){var r=this.tiers[this.selectedTiers[i]];e.push(o(r.dasSource));for(var n=r.stylesheet.styles,s=0;s<n.length;++s){var a=n[s],l=o(a);l.method=r.dasSource.name.replace(/[()+*?]/g,"\\$&"),l._methodRE=null,l.style=o(a.style),void 0===l.style.ZINDEX&&(l.style.ZINDEX=i),r.forceMin&&(l.style.MIN=r.forceMin),r.forceMax&&(l.style.MAX=r.forceMax),t.push(l)}}this.addTier({name:"Merged",merge:"concat",overlay:e,noDownsample:!0,style:t}),this.setSelectedTier(this.tiers.length-1)}},{"./cbrowser":6,"./utils":55}],50:[function(e,t,i){"use strict";function r(e){for(var t=0;t<e.styles.length;++t){var i=e.styles[t].style;if("__SEQUENCE"===i.glyph)return i}}if("undefined"!=typeof e)var n=e("./cbrowser"),s=n.Browser,o=e("./utils"),a=o.makeElement,l=e("./das"),u=l.isDasBooleanTrue,h=(l.isDasBooleanNotFalse,l.copyStylesheet),c=e("./color"),f=c.dasColourForName,p=e("./sourcecompare").sourceDataURI;var d={DOT:!0,EX:!0,STAR:!0,SQUARE:!0,CROSS:!0,TRIANGLE:!0,PLIMSOLL:!0};s.prototype.openTierPanel=function(e){if("tier"===this.uiMode&&this.manipulatingTier===e)this.hideToolPanel(),this.setUiMode("none");else{if(!e)return;var t=function(e){e.BGGRAD||(1==R?("LINEPLOT"==e.glyph||d[e.glyph]?e.FGCOLOR=S.value:e.BGCOLOR=S.value,e.COLOR1=e.COLOR2=e.COLOR3=null):(e.COLOR1=S.value,e.COLOR2=_.value,R>2?e.COLOR3=T.value:e.COLOR3=null),e._gradient=null,e._plusColor=C.value,e._minusColor=k.value)},i=function(t){for(var i=h(e.stylesheet),r=e.browser.zoomForCurrentScale(),n=0;n<i.styles.length;++n){var s=i.styles[n];s.zoom&&s.zoom!=r||t(s.style)}return i},n=function(r){e.mergeStylesheet(i(t))};this.manipulatingTier=e;var s=a("div",null,{className:"tier-edit"}),o=a("div","About '"+(e.config.Name||e.dasSource.name)+"'",null,{background:"gray",paddingBottom:"5px",marginBottom:"5px",textAlign:"center"});s.appendChild(o);var l=a("div",[a("p",e.dasSource.desc)]),c=[],g=p(e.dasSource);if(!g||0!=g.indexOf("http://")&&0!=g.indexOf("https://")&&0!=g.indexOf("//")||"https://www.biodalliance.org/magic/no_uri"===g||c.push(a("li",a("a","(Download data)",{href:g}))),e.dasSource.mapping){var v=this.chains[e.dasSource.mapping].coords;c.push(a("li","Mapped from "+v.auth+v.version))}c.length>0&&l.appendChild(a("ul",c)),s.appendChild(l);var y=a("span"," (styles for current zoom level)",null,{display:"none"}),m=a("div",["Edit",y],null,{background:"gray",paddingBottom:"5px",marginBottom:"5px",textAlign:"center"});s.appendChild(m);var b=a("input",null,{type:"text"}),w=a("input",null,{type:"checkbox",disabled:this.disablePinning}),x=a("select");x.appendChild(a("option","Histogram",{value:"HISTOGRAM"})),x.appendChild(a("option","Line Plot",{value:"LINEPLOT"})),x.appendChild(a("option","Ribbon",{value:"GRADIENT"})),x.appendChild(a("option","Scatter",{value:"SCATTER"}));var S=a("input",null,{type:"text",value:"#dd00dd"}),_=a("input",null,{type:"text",value:"#dd00dd"}),T=a("input",null,{type:"text",value:"#dd00dd"}),C=a("input",null,{type:"text",value:"#ffa07a"}),k=a("input",null,{type:"text",value:"#87cefa"});try{S.type=_.type=T.type="color",C.type=k.type="color"}catch(L){}var O=[S,_,T],A=a("i",null,{className:"fa fa-plus-circle"}),E=a("i",null,{className:"fa fa-minus-circle"}),R=1,M=a("td",O),B=function(e){R=e;for(var t=0;e>t;++t)O[t].style.display="block";for(var t=e;t<O.length;++t)O[t].style.display="none"};A.addEventListener("click",function(e){3>R&&(B(R+1),n(null))},!1),E.addEventListener("click",function(e){R>1&&(B(R-1),n(null))},!1);var I=a("input",null,{type:"text",value:"0.0"}),P=a("input",null,{type:"text",value:"10.0"}),H=a("input",null,{type:"checkbox"}),N=a("input",null,{type:"checkbox"}),F=a("input",null,{type:"checkbox",checked:void 0!==e.quantLeapThreshold}),G=a("input",null,{type:"text",value:e.quantLeapThreshold,disabled:!F.checked}),D=a("input",null,{type:"text",value:"50"}),q=a("input",null,{type:"checkbox"}),U=a("input",null,{type:"text"}),z=a("input",null,{type:"checkbox"}),j=null;if(e.stylesheet.styles.length>0){j=e.stylesheet.styles[0].style}var W=function(){if("string"==typeof e.config.name?b.value=e.config.name:b.value=e.dasSource.name,w.checked=e.pinned,e.forceHeight?D.value=""+e.forceHeight:j&&j.HEIGHT&&(D.value=""+j.HEIGHT),"number"==typeof e.quantLeapThreshold?(F.checked=!0,G.disabled=!1,parseFloat(G.value)!=e.quantLeapThreshold&&(G.value=e.quantLeapThreshold)):(F.checked=!1,G.disabled=!0),"number"==typeof e.subtierMax?U.value=""+e.subtierMax:U.value=""+(e.dasSource.subtierMax||e.browser.defaultSubtierMax),e.stylesheet.styles.length>0){for(var t=null,i=!1,n=!1,s=e.browser.zoomForCurrentScale(),o=0,a=0;a<e.stylesheet.styles.length;++a){var l=e.stylesheet.styles[a];if(!l.zoom||l.zoom==s){++o;var h=e.stylesheet.styles[a].style;t||(t=j=h),("LINEPLOT"==h.glyph||"HISTOGRAM"==h.glyph||"GRADIENT"==h.glyph||u(h.SCATTER))&&(i||(t=j=h),i=!0)}}if(!t)return;y.style.display=o==e.stylesheet.styles.length?"none":"inline",n=i&&1==o;t.COLOR2||t.BGGRAD;i?(ie.style.display="table-row",re.style.display="table-row",se.style.display="none",oe.style.display="none"):(ie.style.display="none",re.style.display="none",se.style.display="table-row",q.checked=u(j.BUMP),U.disabled=!u(j.BUMP),oe.style.display="table-row",z.checked=u(j.LABEL)),n?($.style.display="table-row",J.style.display="table-row"):($.style.display="none",J.style.display="none");var c=1;t.COLOR1?(S.value=f(t.COLOR1).toHexString(),t.COLOR2&&(_.value=f(t.COLOR2).toHexString(),t.COLOR3?(T.value=f(t.COLOR3).toHexString(),c=3):c=2)):"LINEPLOT"==t.glyph||"DOT"==t.glyph&&t.FGCOLOR?S.value=f(t.FGCOLOR).toHexString():t.BGCOLOR&&(S.value=f(t.BGCOLOR).toHexString()),B(c),t._plusColor&&(C.value=f(t._plusColor).toHexString()||t._plusColor),t._minusColor&&(k.value=f(t._minusColor).toHexString()||t._minusColor),u(t.SCATTER)?x.value="SCATTER":x.value=t.glyph;var p,d;if(void 0!==t.MIN){var g=parseFloat(t.MIN);isNaN(g)||(p=g)}if(e.forceMinDynamic||void 0===t.MIN&&void 0===e.forceMin?(H.checked=!1,I.disabled=!0):(H.checked=!0,I.disabled=!1),void 0!==t.MAX){var g=parseFloat(t.MAX);isNaN(g)||(d=g)}e.forceMaxDynamic||void 0===t.MAX&&void 0===e.forceMax?(N.checked=!1,P.disabled=!0):(N.checked=!0,P.disabled=!1),void 0!=e.forceMin&&(p=e.forceMin),void 0!=e.forceMax&&(d=e.forceMax),"number"==typeof p&&p!=parseFloat(I.value)&&(I.value=p),"number"==typeof d&&d!=parseFloat(P.value)&&(P.value=d);var v=r(e.stylesheet);v?(X.style.display="table-row",V.checked="mismatch"===v.__SEQCOLOR,Z.style.display="table-row",K.checked=u(v.__INSERTIONS),Y.style.display="table-row",Q.checked=void 0===v.__disableQuals||v.__disableQuals===!1,console.log(v.__disableQuals)):(X.style.display="none",Z.style.display="none",Y.style.display="none"),v&&V.checked&&!n?(ee.style.display="table-row",te.style.display="table-row"):(ee.style.display="none",te.style.display="none")}i&&e.browser.sourceAdapterIsCapable(e.featureSource,"quantLeap")?ne.style.display="table-row":ne.style.display="none"},V=a("input",null,{type:"checkbox"}),X=a("tr",[a("th","Highlight mismatches & strands"),a("td",V)]);V.addEventListener("change",function(t){var i=h(e.stylesheet),n=r(i);n.__SEQCOLOR=V.checked?"mismatch":"base",e.mergeStylesheet(i)});var K=a("input",null,{type:"checkbox"}),Z=a("tr",[a("th","Show insertions"),a("td",K)]);K.addEventListener("change",function(t){var i=h(e.stylesheet),n=r(i);n.__INSERTIONS=K.checked?"yes":"no",e.mergeStylesheet(i)});var Q=a("input",null,{type:"checkbox"}),Y=a("tr",[a("th","Reflect base quality as base color transparency"),a("td",Q)]);Q.addEventListener("change",function(t){var i=h(e.stylesheet),n=r(i);n.__disableQuals=!Q.checked,console.log(n.__disableQuals),e.mergeStylesheet(i)});var $=a("tr",[a("th","Style"),a("td",x)]),J=a("tr",[a("th",["Colour(s)",A,E]),M]),ee=a("tr",[a("th","Plus Strand Color"),a("td",C)]),te=a("tr",[a("th","Minus Strand Color"),a("td",k)]),ie=a("tr",[a("th","Min value"),a("td",[H," ",I])]),re=a("tr",[a("th","Max value"),a("td",[N," ",P])]),ne=a("tr",[a("th","Threshold leap:"),a("td",[F," ",G])]),se=a("tr",[a("th","Bump overlaps"),a("td",[q," limit: ",U])]),oe=a("tr",[a("th","Label features"),a("td",z)]),ae=a("table",[a("tr",[a("th","Name",{},{width:"150px",textAlign:"right"}),b]),a("tr",[a("th","Pin to top"),w]),a("tr",[a("th","Height"),a("td",D)]),$,J,ee,te,ie,re,ne,se,oe,X,Z,Y]);W(),s.appendChild(ae);var le=a("button","Reset track",{className:"btn"},{marginLeft:"auto",marginRight:"auto",display:"block"});le.addEventListener("click",function(t){e.setConfig({})},!1),s.appendChild(le),b.addEventListener("input",function(t){e.mergeConfig({name:b.value})},!1),w.addEventListener("change",function(t){e.mergeConfig({pinned:w.checked})},!1);for(var ue=0;ue<O.length;++ue)O[ue].addEventListener("change",n,!1);C.addEventListener("change",n,!1),k.addEventListener("change",n,!1),x.addEventListener("change",function(r){var n=i(function(e){"SCATTER"===x.value?(e.SCATTER=!0,e.glyph="DOT",e.SIZE="3"):(e.glyph=x.value,e.SCATTER=void 0),t(e)});e.mergeStylesheet(n)},!1),H.addEventListener("change",function(t){var i={forceMinDynamic:!H.checked};I.disabled=!H.checked;var r=parseFloat(I.value);H.checked&&"number"==typeof r&&!isNaN(r)&&(i.forceMin=parseFloat(r)),e.mergeConfig(i)}),I.addEventListener("input",function(t){var i=parseFloat(I.value);"number"!=typeof i||isNaN(i)||e.mergeConfig({forceMin:i})},!1),N.addEventListener("change",function(t){var i={forceMaxDynamic:!N.checked};P.disabled=!N.checked;var r=parseFloat(P.value);N.checked&&"number"==typeof r&&!isNaN(r)&&(i.forceMax=parseFloat(r)),e.mergeConfig(i)}),P.addEventListener("input",function(t){var i=parseFloat(P.value);"number"!=typeof i||isNaN(i)||e.mergeConfig({forceMax:i})},!1),D.addEventListener("input",function(t){var i=parseFloat(D.value);"number"!=typeof i||isNaN(i)||e.mergeConfig({height:Math.min(500,0|i)})},!1);var he=function(){if(G.disabled=!F.checked,F.checked){var t=parseFloat(G.value);"number"!=typeof t||isNaN(t)||e.mergeConfig({quantLeapThreshold:parseFloat(G.value)})}else e.mergeConfig({quantLeapThreshold:null})};F.addEventListener("change",function(e){he()},!1),G.addEventListener("input",function(e){he()},!1),z.addEventListener("change",function(t){var r=i(function(e){e.LABEL=z.checked?"yes":"no"});e.mergeStylesheet(r)},!1),q.addEventListener("change",function(t){var r=i(function(e){e.BUMP=q.checked?"yes":"no"});e.mergeStylesheet(r)},!1),U.addEventListener("input",function(t){var i=parseInt(U.value);"number"==typeof i&&i>0&&e.mergeConfig({subtierMax:i})},!1),this.showToolPanel(s),this.setUiMode("tier"),e.addTierListener(W);var ce=e.browser.scale;e.browser.addViewListener(function(){e.browser.scale!=ce&&(ce=e.browser.scale,W())})}}},{"./cbrowser":6,"./color":9,"./das":10,"./sourcecompare":39,"./utils":55}],51:[function(e,t,i){"use strict";function r(e,t,i,r){var n=this;if(this.config=i||{},this.id="tier"+ ++_,this.browser=e,this.dasSource=l(t),this.background=r,this.viewport=o("canvas",null,{width:""+((0|this.browser.featurePanelWidth)+2e3),height:"30",className:"viewport_12_5"},{position:"inline-block",margin:"0px",border:"0px"}),this.viewportHolder=o("div",this.viewport,{className:"viewport-holder_12_5"},{background:r,position:"absolute",padding:"0px",margin:"0px",border:"0px",left:"-1000px",minHeight:"200px"}),this.overlay=o("canvas",null,{width:+(0|this.browser.featurePanelWidth),height:"30",className:"viewport-overlay"}),this.notifier=o("div","",{className:"notifier"}),this.notifierHolder=o("div",this.notifier,{className:"notifier-holder"}),this.quantOverlay=o("canvas",null,{width:"50",height:"56",className:"quant-overlay"}),this.removeButton=o("i",null,{className:"fa fa-times"}),this.bumpButton=o("i",null,{className:"fa fa-plus-circle"}),this.loaderButton=e.makeLoader(16),this.loaderButton.style.display="none",this.infoElement=o("div",this.dasSource.desc,{className:"track-label-info"}),this.nameButton=o("div",[],{className:"tier-tab"}),this.nameButton.appendChild(this.removeButton),t.pennant)this.nameButton.appendChild(o("img",null,{src:t.pennant,width:"16",height:"16"}));else if(t.mapping){var s=null;this.browser.chains[t.mapping]&&(s=this.browser.chains[t.mapping].coords.version),s&&this.nameButton.appendChild(o("span",""+s,null,{fontSize:"8pt",background:"black",color:"white",paddingLeft:"3px",paddingRight:"3px",paddingTop:"1px",paddingBottom:"1px",marginLeft:"2px",borderRadius:"10px"}))}this.nameElement=o("span",t.name),this.nameButton.appendChild(o("span",[this.nameElement,this.infoElement],{className:"track-name-holder"})),this.nameButton.appendChild(this.bumpButton),this.nameButton.appendChild(this.loaderButton),this.label=o("span",[this.nameButton],{className:"btn-group track-label"});var a="tier"+(t.className?" "+t.className:"");this.row=o("div",[this.viewportHolder,this.overlay,this.quantOverlay],{className:a}),r||(this.row.style.background="none"),e.noDefaultLabels||this.row.appendChild(this.label),this.row.appendChild(this.notifierHolder),this.layoutHeight=25,this.bumped=!0,this.styleIdSeed=0,t.quantLeapThreshold&&(this.quantLeapThreshold=t.quantLeapThreshold),this.dasSource.collapseSuperGroups&&(this.bumped=!1),this.layoutWasDone=!1,t.featureInfoPlugin&&this.addFeatureInfoPlugin(t.featureInfoPlugin),this.initSources();var u=this;this.featureSource&&this.featureSource.getDefaultFIPs&&!t.noSourceFeatureInfo&&this.featureSource.getDefaultFIPs(function(e){e&&u.addFeatureInfoPlugin(e)}),this.featureSource&&this.featureSource.addReadinessListener&&(this.readinessListener=function(e){u.notify(e,-1)},this.featureSource.addReadinessListener(this.readinessListener)),this.featureSource&&this.featureSource.addActivityListener&&(this.activityListener=function(e){e>0?u.loaderButton.style.display="inline-block":u.loaderButton.style.display="none",u.browser.pingActivity()},this.featureSource.addActivityListener(this.activityListener)),this.listeners=[],this.featuresLoadedListeners=[],this.firstRenderPromise=new x(function(e,t){return n._resolveFirstRenderPromise=e})}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if("undefined"!=typeof e)var s=e("./utils"),o=s.makeElement,a=s.removeChildren,l=s.shallowCopy,u=(s.pushnew,s.miniJSONify),h=s.arrayIndexOf,c=e("./das"),f=c.DASStylesheet,p=c.DASStyle,d=e("./sha1"),g=d.b64_sha1,v=e("./style"),y=v.StyleFilter,m=v.StyleFilterSet,b=e("./sourcecompare"),w=b.sourceDataURI,x=e("es6-promise").Promise,S=e("./features").sortFeatures;var _=0;if(r.prototype.destroy=function(){this.featureSource.removeReadinessListener&&this.featureSource.removeReadinessListener(this.readinessListener),this.featureSource.removeActivityListener&&this.featureSource.removeActivityListener(this.activityListener)},r.prototype.setBackground=function(e){this.background=e,this.viewportHolder.style.background=e},r.prototype.toString=function(){return this.id},r.prototype.addFeatureInfoPlugin=function(e){this.featureInfoPlugins||(this.featureInfoPlugins=[]),this.featureInfoPlugins.push(e)},r.prototype.init=function(){var e=this;return new x(function(t,i){e.dasSource.style?(e.setStylesheet({styles:e.dasSource.style}),t(e)):(e.status="Fetching stylesheet",e.fetchStylesheet(function(i,r){if(r||!i){e.error="No stylesheet";var i=new f,n=new p;n.glyph="BOX",n.BGCOLOR="blue",n.FGCOLOR="black",i.pushStyle({type:"default"},null,n),e.setStylesheet(i)}else e.setStylesheet(i),i.geneHint&&(e.dasSource.collapseSuperGroups=!0,e.bumped=!1,e.updateLabel()),e._updateFromConfig();t(e)}))})},r.prototype.setStylesheet=function(e){this.baseStylesheet=l(e);for(var t=0;t<this.baseStylesheet.styles.length;++t){var i=this.baseStylesheet.styles[t]=l(this.baseStylesheet.styles[t]);i._methodRE=i._labelRE=i._typeRE=null,i.style=l(i.style),i.style.id="style"+ ++this.styleIdSeed}this.baseStylesheetValidity=g(u(this.baseStylesheet)),this._updateFromConfig()},r.prototype.getSource=function(){return this.featureSource},r.prototype.getDesiredTypes=function(e){var t=this.getActiveStyleFilters(e);return t?t.typeList():void 0},r.prototype.getActiveStyleFilters=function(e){var t=this.browser.zoomForCurrentScale();if(this.stylesheet){for(var i=new m,r=this.stylesheet.styles,n=0;n<r.length;++n){var s=r[n];s.zoom&&s.zoom!=t||i.add(new y(s.type,s.method,s.label))}return i}},r.prototype.needsSequence=function(e){var t=function i(e){return e.bamURI||e.bamBlob||e.bwgURI||e.bwgBlob?!0:e.overlay?e.overlay.some(i):!1};return this.sequenceSource&&5>e?!0:t(this.dasSource)&&20>e?!0:!1},r.prototype.setFeatures=function(e,t,i,r,n){this.currentFeatures=r,this.currentSequence=n,this.knownChr=e,this.knownCoverage=t,r&&(S(this),this.notifyFeaturesLoaded())},r.prototype.draw=function(){console.log("Use browser.getTierRenderer(tier).drawTier(tier)")},r.prototype.findNextFeature=function(e,t,i,r,n){if(this.quantLeapThreshold){var s=this.browser.viewEnd-this.browser.viewStart+1;t=t+s*i/2|0,this.featureSource.quantFindNextFeature(e,t,i,this.quantLeapThreshold,n)}else{if(this.knownCoverage&&t>=this.knownCoverage.min()&&t<=this.knownCoverage.max()&&this.currentFeatures){for(var o=null,a=0;a<this.currentFeatures.length;++a){var l=this.currentFeatures[a];l.min&&l.max&&(l.parents&&l.parents.length>0||(0>i?1==r&&l.max>=t&&l.min<t?(!o||l.min>o.min||l.min==o.min&&l.max<o.max)&&(o=l):l.max<t&&(!o||l.max>o.max||l.max==o.max&&l.min<o.min||l.min==o.mmin&&o.max>=t)&&(o=l):1==r&&l.min<=t&&l.max>t?(!o||l.max<o.max||l.max==o.max&&l.min>o.min)&&(o=l):l.min>t&&(!o||l.min<o.min||l.min==o.min&&l.max>o.max||l.max==o.max&&o.min<=t)&&(o=l)))}if(o)return n(o);t=0>i?this.browser.knownSpace.min:this.browser.knownSpace.max}this.trySourceFNF(e,t,i,n)}},r.prototype.trySourceFNF=function(e,t,i,r){var n=this;this.featureSource.findNextFeature(e,t,i,function(e){e||r(e);var t=n.browser.getSequenceSource();t||r(e),t.getSeqInfo(e.segment,function(t){t?r(e):n.trySourceFNF(e.segment,i>0?1e10:0,i,r)})})},r.prototype.updateLabel=function(){this.bumpButton.className=this.bumped?"fa fa-minus-circle":"fa fa-plus-circle",this.dasSource.collapseSuperGroups?this.bumpButton.style.display="inline-block":this.bumpButton.style.display="none"},r.prototype.updateHeight=function(){this.currentHeight=Math.max(Math.max(this.layoutHeight,this.label.clientHeight+2),this.browser.minTierHeight),this.row.style.height=""+this.currentHeight+"px",this.browser.updateHeight()},r.prototype.drawOverlay=function(){var e=this,t=this.browser,i=t.retina&&window.devicePixelRatio>1;e.overlay.height=e.viewport.height,e.overlay.width=i?2*t.featurePanelWidth:t.featurePanelWidth;var r=e.overlay.getContext("2d");i&&r.scale(2,2);var n=t.viewStart,s=t.viewStart,o=t.viewEnd;if(this.overlayLabelCanvas){var a=(this.glyphCacheOrigin-this.browser.viewStart)*this.browser.scale;r.save(),r.translate(a,0);var l=-a+2;this.dasSource.tierGroup&&(l+=15),this.overlayLabelCanvas.draw(r,l,t.featurePanelWidth-a),r.restore()}for(var u=0;u<t.highlights.length;++u){var h=t.highlights[u];(h.chr===t.chr||h.chr==="chr"+t.chr)&&h.min<o&&h.max>s&&(r.globalAlpha=t.defaultHighlightAlpha,r.fillStyle=t.defaultHighlightFill,r.fillRect((h.min-n)*t.scale,0,(h.max-h.min)*t.scale,e.overlay.height))}e.overlay.style.width=t.featurePanelWidth,e.overlay.style.height=e.viewport.style.height,e.overlay.style.left="0px"},r.prototype.updateStatus=function(e){var t=this;if(e){this.status=e,this._notifierToStatus();w(this.dasSource);"https:"!==window.location.protocol||0!=w(this.dasSource).indexOf("http:")||this.checkedHTTP||(this.checkedHTTP=!0,this.browser.canFetchPlainHTTP().then(function(e){e||(t.warnHTTP=!0,t._notifierToStatus())}))}else this.status&&(this.status=null,this._notifierToStatus())},r.prototype.notify=function(e,t){if("number"!=typeof t&&(t=2e3),this.notifierFadeTimeout&&(clearTimeout(this.notifierFadeTimeout),this.notifierFadeTimeout=null),e){if(this._notifierOn(e),t>0){var i=this;this.notifierFadeTimeout=setTimeout(function(){i._notifierToStatus()},t)}}else this._notifierToStatus()},r.prototype._notifierOn=function(e,t){a(this.notifier),t?this.notifier.appendChild(o("span",[o("a","[HTTP Warning] ",{href:this.browser.httpWarningURL,target:"_blank"}),e])):this.notifier.textContent=e,this.notifier.style.opacity=.8},r.prototype._notifierOff=function(){this.notifier.style.opacity=0},r.prototype._notifierToStatus=function(){this.status?this._notifierOn(this.status,this.warnHTTP):this._notifierOff()},r.prototype.setConfig=function(e){this.config=e||{},this._updateFromConfig(),this.notifyTierListeners()},r.prototype.mergeStylesheet=function(e){this.mergeConfig({stylesheet:e,stylesheetValidity:this.baseStylesheetValidity})},r.prototype.mergeConfig=function(e){for(var t in e)this.config[t]=e[t];this._updateFromConfig(),this.notifyTierListeners()},r.prototype._updateFromConfig=function(){var e=!1,t=!1;"string"==typeof this.config.name?this.nameElement.textContent=this.config.name:this.nameElement.textContent=this.dasSource.name;var i=this.config.height||this.dasSource.forceHeight;i!=this.forceHeight&&(this.forceHeight=i,e=!0),this.forceMinDynamic!=this.config.forceMinDynamic&&(this.forceMinDynamic=this.config.forceMinDynamic,e=!0);var r=void 0!=this.config.forceMin?this.config.forceMin:this.dasSource.forceMin;this.forceMin!=r&&(this.forceMin=r,e=!0),this.forceMaxDynamic!=this.config.forceMaxDynamic&&(this.forceMaxDynamic=this.config.forceMaxDynamic,e=!0);var s=void 0!=this.config.forceMax?this.config.forceMax:this.dasSource.forceMax;this.forceMax!=s&&(this.forceMax=s,e=!0);var o=null;void 0!==this.config.quantLeapThreshold?o=this.config.quantLeapThreshold:void 0!==this.dasSource.quantLeapThreshold&&(o=this.dasSource.quantLeapThreshold),o!=this.quantLeapThreshold&&(this.quantLeapThreshold=o,e=!0);var a=null;this.config.stylesheetValidity==this.baseStylesheetValidity&&(a=this.config.stylesheet),a=a||this.baseStylesheet,this.stylesheet!==a&&(this.stylesheet=a,e=!0);var l=void 0!==this.config.pinned?this.config.pinned:this.dasSource.pinned;l!==this.pinned&&(this.pinned=l,t=!0);var u=n("number"===this.config.subtierMax)?this.config.subtierMax:this.dasSource.subtierMax||this.browser.defaultSubtierMax;u!=this.subtierMax&&(this.subtierMax=u,e=!0);var h;h=void 0!==this.config.bumped?this.config.bumped:void 0!==this.dasSource.bumped?this.dasSource.bumped:this.dasSource.collapseSuperGroups?!1:!0,h!==this.bumped&&(this.bumped=h,e=!0,this.updateLabel()),e&&this.scheduleRedraw(),t&&this.browser.reorderTiers()},r.prototype.scheduleRedraw=function(){if(this.currentFeatures){var e=this;this.redrawTimeout||(this.redrawTimeout=setTimeout(function(){S(e);var t=e.browser.getTierRenderer(e);t.drawTier(e),e.redrawTimeout=null},10))}},r.prototype.clearTierListeners=function(){this.listeners=[]},r.prototype.addTierListener=function(e){this.listeners.push(e)},r.prototype.removeTierListener=function(e){var t=h(this.listeners,e);t>=0&&this.listeners.splice(t,1)},r.prototype.notifyTierListeners=function(e){for(var t=0;t<this.listeners.length;++t)try{this.listeners[t](e)}catch(i){console.log(i)}this.browser.notifyTier()},r.prototype.clearFeaturesLoadedListeners=function(){this.featuresLoadedListeners=[]},r.prototype.addFeaturesLoadedListener=function(e){this.featuresLoadedListeners.push(e)},r.prototype.removeFeaturesLoadedListener=function(e){var t=h(this.featuresLoadedListeners,e);t>=0&&this.featuresLoadedListeners.splice(t,1)},r.prototype.notifyFeaturesLoaded=function(){for(var e=0;e<this.featuresLoadedListeners.length;++e)try{this.featuresLoadedListeners[e].call(this)}catch(t){console.log(t)}},r.prototype.wasRendered=function(){this._resolveFirstRenderPromise()},"undefined"!=typeof t){t.exports={DasTier:r};e("./feature-draw")}},{"./das":10,"./feature-draw":20,"./features":22,"./sha1":37,"./sourcecompare":39,"./style":41,"./utils":55,"es6-promise":59}],52:[function(e,t,i){"use strict";function r(e,t){for(var i=0;i<e.length;++i){var r=e[i];r===t?r.classList.add("active"):r.classList.remove("active")}}if("undefined"!=typeof e)var n=e("./cbrowser"),s=n.Browser,o=e("./sourcecompare"),a=o.sourcesAreEqual,l=e("./utils"),u=l.makeElement,h=l.removeChildren,c=l.Observed,f=e("./thub"),p=f.THUB_COMPARE,d=f.connectTrackHub,g=e("./domui"),v=g.makeTreeTableSection,y=e("./probe").probeResource,m=e("./bin"),b=m.URLFetchable,w=m.BlobFetchable,x=m.readInt,S=e("./lh3utils"),_=S.unbgzf,T=e("./bam"),C=(T.BAM_MAGIC,T.BAI_MAGIC),k=e("./tabix"),L=k.TABIX_MAGIC,O=e("./das"),A=O.DASSource,E=O.DASSegment,R=O.DASRegistry,M=O.coordsMatch,B=e("./encode").EncodeFetchable;s.prototype.currentlyActive=function(e){for(var t=0;t<this.tiers.length;++t)if(a(this.tiers[t].dasSource,e))return this.tiers[t];return!1},s.prototype.makeButton=function(e,t){var i=u("a",e,{href:"#"});return t&&this.makeTooltip(i,t),u("li",i)},s.prototype.showTrackAdder=function(e){function t(e){Se.style.display="none",fe.style.display="none",xe.style.display="none",oe=!1,h(ue);for(var t=0,i=u("div",null,{},{width:"100%"}),r=[],n=0;n<e.length;++n)r.push(e[n]);r.sort(function(e,t){return e.shortLabel.toLowerCase().trim().localeCompare(t.shortLabel.toLowerCase().trim())});for(var s=[],o=[],a=0;a<r.length;++a){var l=r[a];l.children&&l.children.length>0&&"multiWig"!=l.container?s.push(l):o.push(l)}o.length>0&&s.push({shortLabel:"Others",priority:-1e8,children:o}),s.sort(p);for(var c=[],f=0;f<s.length;++f){var d=s[f],g=d;!g.dimensions&&g._parent&&g._parent.dimensions&&(g=g._parent);var y={};if(g.dimensions)for(var m=g.dimensions.split(/(\w+)=(\w+)/),b=0;b<m.length-2;b+=3)y[m[b+1]]=m[b+2];if(y.dimX&&y.dimY){for(var w=y.dimX,x=y.dimY,S=g.subgroups[w],_=g.subgroups[x],T={},C=0;C<d.children.length;++C){var k=d.children[C],L=k.sgm[w],O=k.sgm[x];T[L]||(T[L]={}),T[L][O]=k}var A=u("table",null,{className:"table table-striped table-condensed"},{tableLayout:"fixed"}),E=u("tr");E.appendChild(u("th",null,{},{width:"150px",height:"100px"}));for(var R=0;R<S.titles.length;++R){
var M=u("th",u("div",S.titles[R],{},{transform:"rotate(-60deg)",transformOrigin:"0% 100%",webkitTransform:"rotate(-60deg) translate(20px,10px)",webkitTransformOrigin:"0% 100%",textAlign:"left"}),{},{width:"35px",height:"100px",verticalAlign:"bottom"});E.appendChild(M)}A.appendChild(E);for(var B=u("tbody",null,{className:"table table-striped table-condensed"}),P=0;P<_.titles.length;++P){var O=_.tags[P],H=u("tr");H.appendChild(u("th",_.titles[P]),{});for(var N=0;N<S.titles.length;++N){var L=S.tags[N],F=u("td");if(T[L]&&T[L][O]){var l=T[L][O],G=l.toDallianceSource();if(!G)continue;var D=u("tr"),q=u("td");q.style.textAlign="center";var U=u("input");U.type="checkbox",U.dalliance_source=G,he&&(U.dalliance_mapping=he),c.push(U),F.appendChild(U),U.addEventListener("change",function(e){e.target.checked?I.addTier(e.target.dalliance_source):I.removeTier(e.target.dalliance_source)})}H.appendChild(F)}B.appendChild(H)}A.appendChild(B),i.appendChild(v(d.shortLabel,A,0==f))}else{var z=u("tbody",null,{className:"table table-striped table-condensed"}),j=u("table",z,{className:"table table-striped table-condensed"},{width:"100%",tableLayout:"fixed"}),W=0;d.children.sort(p);for(var n=0;n<d.children.length;++n){var V="hb"+ ++t,l=d.children[n],G=l.toDallianceSource();if(G){var D=u("tr"),q=u("td",null,{},{width:"30px"});q.style.textAlign="center";var U=u("input");U.type="checkbox",U.dalliance_source=G,U.id=V,he&&(U.dalliance_mapping=he),c.push(U),q.appendChild(U),U.addEventListener("change",function(e){e.target.checked?I.addTier(e.target.dalliance_source):I.removeTier(e.target.dalliance_source)}),D.appendChild(q);var X=u("label",null,{htmlFor:V});X.appendChild(document.createTextNode(l.shortLabel)),l.longLabel&&l.longLabel.length>0&&I.makeTooltip(X,l.longLabel),D.appendChild(u("td",X)),z.appendChild(D),++W}}s.length>1||"Others"!==d.shortLabel?i.appendChild(v(d.shortLabel,j,0==f)):i.appendChild(j)}}var K=function(){for(var e=0;e<c.length;++e){var t=c[e],i=I.currentlyActive(t.dalliance_source);i?(t.checked=!0,t.disabled=null!=i.sequenceSource):t.checked=!1}};K(),I.addTierListener(function(e){K()}),ue.appendChild(i)}function i(){r(H,K),oe="bin",Se.style.display="none",fe.style.display="inline",xe.style.display="none",h(ue);var e=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});e.appendChild(u("h3","Add custom URL-based data")),e.appendChild(u("p",["You can add indexed binary data hosted on an web server that supports CORS (",u("a","full details",{href:"http://www.biodalliance.org/bin.html"}),").  Currently supported formats are bigwig, bigbed, and indexed BAM."])),e.appendChild(u("br")),e.appendChild(document.createTextNode("URL: ")),J=u("input","",{size:80,value:"http://www.biodalliance.org/datasets/ensGene.bb"},{width:"100%"}),e.appendChild(J),e.appendChild(u("br")),e.appendChild(u("b","- or -")),e.appendChild(u("br")),e.appendChild(document.createTextNode("File: ")),re=u("input",null,{type:"file",multiple:"multiple"}),e.appendChild(re),e.appendChild(u("p",'Clicking the "Add" button below will initiate a series of test queries.')),ue.appendChild(e),J.focus()}function n(){r(H,Y),Se.style.display="none",fe.style.display="inline",xe.style.display="none",oe="hub-connect",Se.style.visibility="hidden",h(ue);var e=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});e.appendChild(u("h3","Connect to a track hub.")),e.appendChild(u("p",['Enter the top-level URL (usually points to a file called "hub.txt") of a UCSC-style track hub'])),J=u("input","",{size:120,value:"http://www.biodalliance.org/datasets/testhub/hub.txt"},{width:"100%"}),e.appendChild(J),ue.appendChild(e),J.focus()}function s(){r(H,X),Se.style.display="none",fe.style.display="inline",xe.style.display="none",oe="das",h(ue);var e=u("div",null,{},{paddingLeft:"10px",paddingRight:"10px"});e.appendChild(u("h3","Add custom DAS data")),e.appendChild(u("p","This interface is intended for adding custom or lab-specific data.  Public data can be added more easily via the registry interface.")),e.appendChild(document.createTextNode("URL: ")),e.appendChild(u("br")),J=u("input","",{size:80,value:"http://www.derkholm.net:8080/das/medipseq_reads/"},{width:"100%"}),e.appendChild(J),e.appendChild(u("p",'Clicking the "Add" button below will initiate a series of test queries.  If the source is password-protected, you may be prompted to enter credentials.')),ue.appendChild(e),J.focus()}function o(){if(oe){if("das"===oe){var e=J.value.trim();/^.+:\/\//.exec(e)||(e="http://"+e);var t=new A({name:"temporary",uri:e});pe(t)}else if("bin"===oe){var r=re.files;if(r&&r.length>0)me(r);else{var e=J.value.trim();/^.+:\/\//.exec(e)||(e="http://"+e);var o={uri:e},l=e.toLowerCase();0==l.indexOf("https://www.encodeproject.org/")&&l.indexOf("@@download")>=0&&(o.transport="encode"),ge(o)}}else if("reset"===oe)s();else if("reset-bin"===oe)i();else if("reset-hub"===oe)n();else if("prompt-bai"===oe){var r=re.files;r&&r.length>0&&r[0]?(ae.baiBlob=r[0],m(ae)):f(ae)}else if("prompt-tbi"===oe){var r=re.files;r&&r.length>0&&r[0]?(ae.indexBlob=r[0],S(ae)):g(ae)}else if("finalize"===oe||"finalize-bin"===oe){ae.name=ee.value;var u=te.value;"__default__"!=u?ae.mapping=u:ae.mapping=void 0,ie&&(ae.maxbins=ie.checked),ne.value.length>1&&se.value.length>1&&(ae.xUser=ne.value,ae.xPass=se.value),I.addTier(ae),"finalize-bin"==oe?i():s()}else if("hub-connect"===oe){var e=J.value.trim();/^.+:\/\//.exec(e)||(e="http://"+e),a(e)}else if("multiple"===oe){for(var h=0;h<ye.length;++h){var c=ye[h];if(!c.hidden&&("bam"!=c.tier_type||c.indexBlob||c.indexUri)&&("tabix"!=c.tier_type||c.indexBlob||c.indexUri)){var t=de(c);t&&(t.noPersist=!0,I.addTier(t))}}i()}}else I.removeAllPopups()}function a(e,i,n){i=i||{};for(var s=0;s<I.hubObjects.length;++s){var o=I.hubObjects[s];if(o.hub.url==e){for(var l=0;l<H.length;++l)H[l].hub==o&&r(H,H[l]);return void o.getTracks(function(e,i){i&&console.log(i),t(e)})}}d(e,function(s,o){if(o)return n?(h(ue),ue.appendChild(u("h2","Error connecting to track hub")),ue.appendChild(u("p",o)),void(oe="reset-hub")):a(e,{credentials:!0},!0);var l=null,c=null;for(var f in s.genomes){var p=null,d=!1;if(f==I.coordSystem.ucscName)d=!0;else for(var g in I.chains){var v=I.chains[g];f==v.coords.ucscName&&(p=g,d=!0)}if(d){var y={url:e,genome:f};i.credentials&&(y.credentials=!0),p&&(y.mapping=p,s.genomes[f].mapping=p),I.hubs.push(y),I.hubObjects.push(s.genomes[f]);var m=j(s.genomes[f]);$.appendChild(m),p&&l||(l=s.genomes[f],c=m)}}return l?(I.notifyTier(),r(H,c),l.getTracks(function(e,i){t(e)}),void 0):(h(ue),ue.appendChild(u("h2","No data for this genome")),ue.appendChild(u("p","This URL appears to be a valid track-hub, but it doesn't contain any data for the coordinate system of this browser")),ue.appendChild(u("p","coordSystem.ucscName = "+I.coordSystem.ucscName)),void(oe="reset-hub"))},i)}function l(e,t){function i(){return t?ve(e):l(e,!0)}var r=e.uri;if(t){var n=/(.+)\/[^\/]+\/?/.exec(r);n&&(r=n[1]+"/sources")}new R(r,{credentials:e.credentials}).sources(function(t){if(!t||0==t.length)return i();var r=null;if(1==t.length)r=t[0];else for(var n=0;n<t.length;++n)if(t[n].uri===e.uri){r=t[n];break}var s=!1,o=!1;if(r&&(e.name=r.name,e.desc=r.desc,r.maxbins?e.maxbins=!0:e.maxbins=!1,r.capabilities&&(e.capabilities=r.capabilities),o=!0,r.coords&&1==r.coords.length)){var a=r.coords[0];if(M(a,I.coordSystem))s=!0;else if(I.chains)for(var l in I.chains)M(a,I.chains[l].coords)&&(e.mapping=l,s=!0)}return ve(e,s,o)},function(){return i()})}function f(e){Se.style.display="none",fe.style.display="inline",xe.style.display="inline",h(ue),oe="prompt-bai",ue.appendChild(u("h2","Select an index file")),ue.appendChild(u("p","Dalliance requires a BAM index (.bai) file when displaying BAM data.  These normally accompany BAM files.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate BAI file")),ue.appendChild(document.createTextNode("Index file: ")),re=u("input",null,{type:"file"}),ue.appendChild(re),ae=e}function g(e){Se.style.display="none",fe.style.display="inline",xe.style.display="inline",h(ue),oe="prompt-tbi",ue.appendChild(u("h2","Select an index file")),ue.appendChild(u("p","Dalliance requires a Tabix index (.tbi) file when displaying VCF data.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate BAI file")),ue.appendChild(document.createTextNode("Index file: ")),re=u("input",null,{type:"file"}),ue.appendChild(re),ae=e}function m(e){var t;t=e.baiBlob?new w(e.baiBlob):"encode"==e.transport?new B(e.bamURI+".bai"):new b(e.bamURI+".bai",{credentials:e.credentials}),t.slice(0,256).fetch(function(t){var i=!1;if(t){var r=new Uint8Array(t),n=x(r,0);i=n==C}return i?ve(e,!1,!1,!0):T("You have selected a valid BAM file, but a corresponding index (.bai) file was not found.  Please index your BAM (samtools index) and place the BAI file in the same directory")})}function S(e){var t;t=e.indexBlob?new w(e.indexBlob):new b(e.uri+".tbi"),t.slice(0,65536).fetch(function(t){var i=!1;if(t){var r=new Uint8Array(t);if(31==r[0]||139==r[1]){var n=_(t);r=new Uint8Array(n);var s=x(r,0);i=s==L}}return i?ve(e,!1,!1,!0):T('You have selected a valid VCF file, but a corresponding index (.tbi) file was not found.  Please index your VCF ("tabix -p vcf -f myfile.vcf.gz") and place the .tbi file in the same directory')})}function T(e){Se.style.display="none",fe.style.display="inline",xe.style.display="inline",h(ue),e=e||"Custom data format not recognized",ue.appendChild(u("h2","Error adding custom data")),ue.appendChild(u("p",e)),ue.appendChild(u("p","Currently supported formats are bigBed, bigWig, and BAM.")),oe="reset-bin"}if("add"===this.uiMode)return this.hideToolPanel(),void this.setUiMode("none");var k,O,I=this,P=u("div",null,{className:"dalliance"},{width:"100%",display:"inline-block",boxSizing:"border-box",MozBoxSizing:"border-box",verticalAlign:"top",paddingRight:"15px"}),H=[];if(!this.noRegistryTabs){var N=this.makeButton("Registry","Browse compatible datasources from the DAS registry");H.push(N);for(var F in this.mappableSources){var G=function(e){var t=I.makeButton(I.chains[e].srcTag,"Browse datasources mapped from "+I.chains[e].srcTag);H.push(t),t.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation(),r(H,t),k(I.mappableSources[e],e)},!1)};G(F)}}for(var D={},q=0;q<this.defaultSources.length;++q){var U=this.defaultSources[q],z=U.group||"Defaults";D[z]?D[z].push(U):D[z]=[U]}var j=function(e){var i=e.hub,s=u("i",null,{className:"fa fa-list-alt"},{cursor:"context-menu"}),o=i.altLabel||i.shortLabel||"Unknown";e.mapping&&(o=o+" ("+e.genome+")");var a=u("span",[o," ",s]),l=I.makeButton(a,i.longLabel);return l.hub=e,H.push(l),l.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation(),r(H,l),h(ue);var n=I.makeLoader(24);n.style.marginLeft="auto",n.style.marginRight="auto",n.style.marginTop="100px",ue.appendChild(u("div",n,null,{textAlign:"center"})),Se.style.display="none",fe.style.display="none",xe.style.display="none",e.getTracks(function(e,i){i&&console.log(i),t(e)})},!1),s.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var i=u("li",u("a","Remove hub")),s=u("li",u("a","Enable all")),o=u("li",u("a","Disable all")),a=u("ul",[i,s,o],{className:"dropdown-menu"},{display:"block"}),h=t.clientX,c=t.clientY;h+=document.documentElement.scrollLeft||document.body.scrollLeft,c+=document.documentElement.scrollTop||document.body.scrollTop,a.style.position="absolute",a.style.top=""+(c+10)+"px",a.style.left=""+(h-30)+"px",I.hPopupHolder.appendChild(a);var f=function p(e){console.log("cc"),document.body.removeEventListener("click",p,!0),I.hPopupHolder.removeChild(a)};document.body.addEventListener("click",f,!0),i.addEventListener("click",function(t){for(var i=0;i<I.hubObjects.length;++i)if(I.hubObjects[i].absURL==e.absURL){I.hubObjects.splice(i,1);break}for(var i=0;i<I.hubs.length;++i){var s=I.hubs[i];if("string"==typeof s&&(s={url:s}),s.url==e.hub.url&&!s.genome||s.genome==e.genome){I.hubs.splice(i,1);break}}I.notifyTier(),$.removeChild(l),r(H,Y),n()},!1),s.addEventListener("click",function(t){e.getTracks(function(e,t){t&&console.log(t);for(var i=0;i<e.length;++i){var r=e[i].toDallianceSource();I.currentlyActive(r)||I.addTier(r)}})},!1),o.addEventListener("click",function(t){e.getTracks(function(e,t){t&&console.log(t);for(var i=0;i<e.length;++i){var r=e[i].toDallianceSource();I.currentlyActive(r)&&I.removeTier(r)}})},!1)},!1),l},W=null,V=null;for(var z in D)!function(e,t){var i=I.makeButton(e,"Browse the default set of data for this browser");i.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r(H,i),k(new c(t))},!1),H.push(i),(!W||I.defaultTrackAdderTab&&I.defaultTrackAdderTab==e)&&(W=i,V=t)}(z,D[z]);var X=this.makeButton("DAS","Add data using the DAS protocol");H.push(X);var K=this.makeButton("Files","Add data from files on disk or the web");H.push(K);for(var Z=0;Z<this.hubObjects.length;++Z){var Q=this.hubObjects[Z];j(Q)}var Y=this.makeButton("+","Connect to a new track-hub");H.push(Y);var $=u("ul",H,{className:"nav nav-tabs"},{marginBottom:"0px"});P.appendChild($);var J,ee,te,ie,re,ne,se,oe=!1,ae=null,le=u("form",null,{},{display:"inline-block",width:"100%"});le.addEventListener("submit",function(e){return e.stopPropagation(),e.preventDefault(),o(),!1},!0);var ue=u("div");ue.style.position="relative",ue.style.overflow="scroll",le.appendChild(ue);var he,ce;k=function(e,t){Se.style.display="none",fe.style.display="none",xe.style.display="none",ce&&ce.removeListener(O),he=t,ce=e,ce.addListenerAndFire(O)},O=function(e){oe=!1;var t=[];if(h(ue),!e)return void ue.appendChild(u("p","Dalliance was unable to retrieve data source information from the DAS registry, please try again later"));for(var i=u("tbody",null,{className:"table table-striped table-condensed"},{width:"100%"}),r=u("table",i,{className:"table table-striped table-condensed"},{width:"100%",tableLayout:"fixed"}),n=0,s=[],o=0;o<e.length;++o)s.push(e[o]);s.sort(function(e,t){return e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())});for(var o=0;o<s.length;++o){var a=s[o],l=u("tr"),c=u("td",null,{},{width:"30px"});if(c.style.textAlign="center",!a.props||a.props.cors){var f=u("input");f.type="checkbox",f.dalliance_source=a,f.id="sourcecb"+o,he&&(f.dalliance_mapping=he),c.appendChild(f),t.push(f),f.addEventListener("change",function(e){e.target.checked?I.addTier(e.target.dalliance_source):I.removeTier(e.target.dalliance_source)})}else c.appendChild(document.createTextNode("!")),I.makeTooltip(c,u("span",["This data source isn't accessible because it doesn't support ",u("a","CORS",{href:"http://www.w3.org/TR/cors/"}),"."]));l.appendChild(c);var p=u("label",null,{htmlFor:"sourcecb"+o});p.appendChild(document.createTextNode(a.name)),a.desc&&a.desc.length>0&&I.makeTooltip(p,a.desc),l.appendChild(u("td",p)),i.appendChild(l),++n}var d=function(){for(var e=0;e<t.length;++e){var i=t[e],r=I.currentlyActive(i.dalliance_source);r?i.checked=!0:i.checked=!1}};d(),I.addTierListener(function(e){d()}),ue.appendChild(r)},N&&N.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r(H,N),k(I.availableSources)},!1),K.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),i()},!1),Y.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),n()},!1),X.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),s()},!1);var fe=u("button","Add",{className:"btn btn-primary"});fe.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),o()},!1);var pe=function Te(e,t){var i=I.knownSpace;if(!i)return void alert("Can't confirm track-addition to an uninit browser.");var r=0|Math.max(i.min,(i.min+i.max-100)/2),n=new E(i.chr,r,Math.min(r+99,i.max));e.features(n,{},function(i,r){if(!r){var n=new RegExp("/([^/]+)/?$"),s=n.exec(e.uri);return s&&(e.name=s[1]),void l(e)}return t?(h(ue),ue.appendChild(u("h2","Custom data not found")),ue.appendChild(u("p","DAS uri: "+e.uri+" is not answering features requests")),void(oe="reset")):(e.credentials=!0,void Te(e,!0))})},de=function(e){var t={name:e.name};return e.credentials&&(t.credentials=e.credentials),e.mapping&&"__default__"!=e.mapping&&(t.mapping=e.mapping),e.transport&&(t.transport=e.transport),"bwg"==e.tier_type?(e.blob?t.bwgBlob=e.blob:e.uri&&(t.bwgURI=e.uri),t):"bam"==e.tier_type?(e.blob?(t.bamBlob=e.blob,t.baiBlob=e.indexBlob):(t.bamURI=e.uri,t.baiURI=e.indexUri),t):"tabix"==e.tier_type?(t.tier_type="tabix",t.payload=e.payload,e.blob?(t.blob=e.blob,t.indexBlob=e.indexBlob):(t.uri=e.uri,t.indexUri=e.indexUri),t):"memstore"==e.tier_type?(t.tier_type="memstore",t.payload=e.payload,e.blob?t.blob=e.blob:t.uri=e.uri,t):void 0},ge=function(e){y(e,function(e,t){if(!t){var i=de(e);return"bam"==e.tier_type?m(i):"tabix"==e.tier_type?S(i):ve(i,!1,!1,!0)}h(ue);var r=u("div");r.appendChild(u("h2","Couldn't access custom data")),r.appendChild(u("p",""+t)),ue.appendChild(r),console.log(e),"https:"===window.location.protocol&&0==e.uri.indexOf("http:")&&I.canFetchPlainHTTP().then(function(e){e||r.appendChild(u("p",[u("strong","HTTP warning: "),"you may not be able to access HTTP resources from an instance of Biodalliance which you are accessing via HTTPS.",u("a","[More info]",{href:I.httpWarningURL,target:"_blank"})]))}),oe="reset-bin"})},ve=function(e,t,i,r){if(Se.style.display="none",fe.style.display="inline",xe.style.display="inline",h(ue),ue.appendChild(u("h2","Add custom data: step 2")),ue.appendChild(document.createTextNode("Label: ")),ee=u("input","",{value:e.name}),ue.appendChild(ee),ne=u("input",""),se=u("input",""),ue.appendChild(u("br")),ue.appendChild(u("br")),ue.appendChild(u("h4","Coordinate system: ")),te=u("select",null),te.appendChild(u("option",I.nameForCoordSystem(I.coordSystem),{value:"__default__"})),I.chains)for(var n in I.chains){var s=I.chains[n].coords;te.appendChild(u("option",I.nameForCoordSystem(s),{value:n}))}te.value=e.mapping||"__default__",ue.appendChild(te),t?ue.appendChild(u("p","(Based on server response, probably doesn't need changing.)")):(ue.appendChild(u("p",[u("b","Warning: "),"unable to determine the correct value from server responses.  Please check carefully."])),ue.appendChild(u("p","If you don't see the mapping you're looking for, please contact thomas@biodalliance.org"))),r||(ue.appendChild(document.createTextNode("Quantitative: ")),ie=u("input",null,{type:"checkbox",checked:!0}),"undefined"!=typeof e.maxbins&&(ie.checked=e.maxbins),ue.appendChild(ie),i?ue.appendChild(u("p","(Based on server response, probably doesn't need changing.)")):ue.appendChild(u("p",[u("b","Warning: "),"unable to determine correct value.  If in doubt, leave checked."]))),e.bwgBlob&&ue.appendChild(u("p",[u("b","Warning: "),"data added from local file.  Due to the browser security model, the track will disappear if you reload Dalliance."])),ee.focus(),oe="bin"===oe||"prompt-bai"===oe||"prompt-tbi"===oe?"finalize-bin":"finalize",ae=e},ye=null,me=function(e){var t=ye=[];oe="multiple";for(var i=0;i<e.length;++i){var r=e[i];r&&t.push({blob:r})}for(var i=0;i<t.length;++i)be(t[i]);we()},be=function(e){y(e,function(e,t){t&&(e.error=t);for(var i=[],r={},n={},s=0;s<ye.length;++s){var o=ye[s];"bam"!=o.tier_type||o.indexBlob||(r[o.blob.name]=o),"tabix"!=o.tier_type||o.indexBlob||(n[o.blob.name]=o)}for(var s=0;s<ye.length;++s){var o=ye[s];if("bai"===o.tier_type){var a=new RegExp("(.+)\\.bai$"),l=a.exec(o.blob.name);l&&r[l[1]]&&(r[l[1]].indexBlob=o.blob,i.push(s))}else if("tabix-index"===o.tier_type){var u=new RegExp("(.+)\\.tbi$"),l=u.exec(o.blob.name);l&&n[l[1]]&&(n[l[1]].indexBlob=o.blob,i.push(s))}}for(var h=i.length-1;h>=0;--h)ye.splice(i[h],1);we()})},we=function(){h(ue);var e=!1,t=u("table",ye.filter(function(e){return!e.hidden}).map(function(t){var i=u("tr");i.appendChild(u("td",t.name||t.blob.name));var r;r=t.error?u("span","Error",null,{color:"red"}):t.tier_type?t.payload||t.tier_type:I.makeLoader(16);var n,s="unknown";if("bwg"==t.tier_type||"memstore"==t.tier_type?s="okay":"bam"==t.tier_type?s=t.indexBlob?"okay":"needs-index":"tabix"==t.tier_type&&(s=t.indexBlob?"okay":"needs-index"),"okay"==s){if(n=u("select",null,null,{width:"150px"}),n.appendChild(u("option",I.nameForCoordSystem(I.coordSystem),{value:"__default__"})),I.chains)for(var o in I.chains){var a=I.chains[o].coords;n.appendChild(u("option",I.nameForCoordSystem(a),{value:o}))}n.value=t.mapping||"__default__",n.addEventListener("change",function(e){t.mapping=n.value,console.log(t)},!1)}else"needs-index"==s&&(n=u("span","Needs index",{},{color:"red"}),e=!0);return u("tr",[u("td",t.name||t.blob.name),u("td",r),u("td",n)])}),{className:"table table-striped table-condensed"});if(ue.appendChild(t),e){ue.appendChild(u("p","Some of these files are missing required index (.bai or .tbi) files.  For security reasons, web applications like Dalliance can only access local files which you have explicity selected.  Please use the file chooser below to select the appropriate index file")),ue.appendChild(document.createTextNode("Index file(s): "));var i=u("input",null,{type:"file",multiple:"multiple"});ue.appendChild(i),i.addEventListener("change",function(e){console.log("fileset changed");for(var t=i.files||[],r=0;r<t.length;++r){var n=t[r];if(n){var s={blob:n,hidden:!0};ye.push(s),be(s)}}},!1)}},xe=u("button","Cancel",{className:"btn"});xe.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),"finalize-bin"===oe?i():s()},!1);var Se=u("button","Refresh",{className:"btn"});Se.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),I.queryRegistry(he)},!1),this.makeTooltip(Se,"Click to re-fetch data from the DAS registry");var _e=u("div",[fe," ",xe," ",Se]);_e.style.margin="10px",le.appendChild(_e),P.appendChild(le),k(I.availableSources),this.showToolPanel(P),this.setUiMode("add"),W&&(r(H,W),k(new c(V)))}},{"./bam":1,"./bin":4,"./cbrowser":6,"./das":10,"./domui":12,"./encode":14,"./lh3utils":26,"./probe":31,"./sourcecompare":39,"./tabix":46,"./thub":48,"./utils":55}],53:[function(e,t,i){"use strict";function r(e,t,i){t.fetchAsText(function(t){if(!t)return i(null,"Couldn't fetch index-index");for(var r=t.split(/(.+)([0-9A-F]{10})\n/),s=[],o=[],a=1;a<r.length;a+=3)s.push(r[a]),o.push(parseInt(r[a+1],16));return i(new n(s,o,e))})}function n(e,t,i){this.keys=e,this.offsets=t,this.ix=i}n.prototype.lookup=function(e,t){for(var i,r=(e+"     ").substring(0,5).toLowerCase(),n=0;n<this.keys.length;++n)if(r.localeCompare(this.keys[n])<0){i=this.ix.slice(this.offsets[n-1],this.offsets[n]-this.offsets[n-1]);break}i||(i=this.ix.slice(this.offsets[this.offsets.length-1])),i.fetchAsText(function(i){for(var r=i.split("\n"),n=0;n<r.length;++n)if(0==r[n].indexOf(e.toLowerCase()+" "))return t(r[n].split(" "));return t(null)})},"undefined"!=typeof t&&(t.exports={connectTrix:r})},{}],54:[function(e,t,i){"use strict";function r(){}function n(e,t){var i=new r;i.data=e;var n=g,o=0;i.data.slice(0,n).fetch(function(e){if(!e)return t(null,"Couldn't access data");var r=new Uint8Array(e),u=a(r,0);if(u==p)i.readInt=a;else{if(u!=d)return t(null,"Not a .2bit file, magic=0x"+u.toString(16));i.readInt=l}var h=i.readInt(r,4);if(0!=h)return t(null,"Unsupported version "+h);i.seqCount=i.readInt(r,8),i.seqDict={};var c=16,f=0,v=0,y=function m(){for(;f<i.seqCount;){var e=r[c];if(c+e+6>=r.length)return o+=n,n=Math.max(g,Math.floor(o*i.seqCount/f)),i.data.slice(v+c,n).fetch(function(e){v+=c,c=0,r=new Uint8Array(e),m()});++c;for(var a="",l=1;e>=l;++l)a+=String.fromCharCode(r[c++]);var u=i.readInt(r,c);c+=4,i.seqDict[a]=new s(i,u),++f}return t(i)};y()})}function s(e,t){this.tbf=e,this.offset=t}if("undefined"!=typeof e)var o=e("./bin"),a=o.readInt,l=o.readIntBE,u=e("./spans"),h=u.Range,c=u.union,f=u.intersection;var p=440477507,d=1126646042,g=12500;r.prototype.getSeq=function(e){var t=this.seqDict[e];return t||(t=this.seqDict["chr"+e]),t},r.prototype.fetch=function(e,t,i,r){var n=this.getSeq(e);return n?t>=i?r(""):void n.fetch(t,i,r):r(null,"Couldn't find "+e)},s.prototype.init=function(e){if(this.seqOffset)return e();var t=this;t.tbf.data.slice(t.offset,8).fetch(function(i){if(!i)return e("Fetch failed");var r=new Uint8Array(i);t._length=t.tbf.readInt(r,0),t.nBlockCnt=t.tbf.readInt(r,4),t.tbf.data.slice(t.offset+8,8*t.nBlockCnt+4).fetch(function(i){if(!i)return e("Fetch failed");for(var r=new Uint8Array(i),n=null,s=0;s<t.nBlockCnt;++s){var o=t.tbf.readInt(r,4*s),a=t.tbf.readInt(r,4*(s+t.nBlockCnt)),l=new h(o,o+a-1);n=n?c(n,l):l}return t.nBlocks=n,t.mBlockCnt=t.tbf.readInt(r,8*t.nBlockCnt),t.seqLength=(t._length+3)/4|0,t.seqOffset=t.offset+16+8*(t.nBlockCnt+t.mBlockCnt),e()})})};var v=["T","C","A","G"];s.prototype.fetch=function(e,t,i){--e,--t;var r=this;this.init(function(n){if(n)return i(null,n);var s=e>>2,o=t+3>>2;return 0>s||o>r.seqLength?i("Coordinates out of bounds: "+e+":"+t):void r.tbf.data.slice(r.seqOffset+s,o-s).salted().fetch(function(n){function o(e){for(;e>=p;){var t,i=(p>>2)-s,r=3&p,n=a[i];t=0==r?n>>6&3:1==r?n>>4&3:2==r?n>>2&3:3&n,c+=v[t],++p}}if(null==n)return i("SeqFetch failed");var a=new Uint8Array(n),l=[];if(r.nBlocks){var u=f(new h(e,t),r.nBlocks);u&&(l=u.ranges())}for(var c="",p=e,d=0;d<l.length;++d){var g=l[d];if(p>g.min())throw"N mismatch...";for(p<g.min()&&o(g.min()-1);p<=g.max();)c+="N",++p}return t>=p&&o(t),i(c)})})},s.prototype.length=function(e){var t=this;this.init(function(i){return i?e(null,i):e(t._length)})},"undefined"!=typeof t&&(t.exports={makeTwoBit:n})},{"./bin":4,"./spans":40}],55:[function(e,t,i){"use strict";function r(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return;e.push(t)}function n(e,t,i){e[t]?e[t].push(i):e[t]=[i]}function s(e,t,i){var r=e[t];if(r){for(var n=0;n<r.length;++n)if(r[n]==i)return;r.push(i)}else e[t]=[i]}function o(e,t,i,r){return e?e:t?t:i?i:r?r:void 0}function r(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return;e.push(t)}function a(e,t){if(!e)return-1;for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}function l(e,t){var i=a(e,t);return i>=0?(e.splice(i,1),!0):!1}function u(e,t,i,r){var n=document.createElement(e);if(t){t instanceof Array||(t=[t]);for(var s=0;s<t.length;++s){var o=t[s];o&&("string"==typeof o?o=document.createTextNode(o):"number"==typeof o&&(o=document.createTextNode(""+o)),n.appendChild(o))}}if(i)for(var a in i)try{n[a]=i[a]}catch(l){throw console.log("error setting "+a),l}if(r)for(var a in r)n.style[a]=r[a];return n}function h(e,t,i,r){var n=document.createElementNS(e,t);if(i){i instanceof Array||(i=[i]);for(var s=0;s<i.length;++s){var o=i[s];"string"==typeof o&&(o=document.createTextNode(o)),n.appendChild(o)}}return f(n,r),n}function c(e,t,i){var r=C[t];if(!r){for(var n="",s=0;s<t.length;++s){var o=t.substring(s,s+1),a=o.toLowerCase();a!=o?n=n+"-"+a:n+=o}C[t]=n,r=n}e.setAttribute(r,i)}function f(e,t){if(t)for(var i in t)c(e,i,t[i])}function p(e){if(e&&e.childNodes)for(;e.childNodes.length>0;)e.removeChild(e.firstChild)}function d(e,t){if("undefined"==typeof e)return"undefined";if(null==e)return"null";if("string"==typeof e)return"'"+e+"'";if("number"==typeof e)return""+e;if("boolean"==typeof e)return""+e;if("object"==("undefined"==typeof e?"undefined":S(e))){if(e instanceof Array){for(var i=null,r=0;r<e.length;++r)i=(null==i?"":i+", ")+d(e[r],t);return"["+(i?i:"")+"]"}t=t||{};var i=null;for(var n in e)t[n]||void 0!=n&&"function"!=typeof e[n]&&(i=(null==i?"":i+", ")+n+": "+d(e[n],t));return"{"+(i?i:"")+"}"}return"undefined"==typeof e?"undefined":S(e)}function g(e){var t={};for(var i in e)t[i]=e[i];return t}function v(e){this.value=e,this.listeners=[]}function y(){this.queue=[]}function m(e){return e+"?salt="+T(""+Date.now()+","+ ++k)}function b(e,t,i){i&&i.salt&&(e=m(e));try{var r;i&&i.timeout&&(r=setTimeout(function(){return console.log("timing out "+e),n.abort(),t(null,"Timeout")},i.timeout));var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&(r&&clearTimeout(r),n.status<200||n.status>=300?t(null,"Error code "+n.status):t(n.responseText))},n.open("GET",e,!0),n.responseType="text",i&&i.credentials&&(n.withCredentials=!0),n.send()}catch(s){t(null,"Exception "+s)}}function w(e,t){if(0==t.indexOf("http:")||0==t.indexOf("https:"))return t;var i=e.lastIndexOf("/");return i>=0?e.substr(0,i+1)+t:t}function x(e){return u("a",null,{href:e}).href}var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if("undefined"!=typeof e)var _=e("./sha1"),T=_.b64_sha1;var C=(new RegExp("[0-9]+"),new RegExp("^[0-9]+$"),{});v.prototype.addListener=function(e){this.listeners.push(e)},v.prototype.addListenerAndFire=function(e){this.listeners.push(e),e(this.value)},v.prototype.removeListener=function(e){l(this.listeners,e)},v.prototype.get=function(){return this.value},v.prototype.set=function(e){this.value=e;for(var t=0;t<this.listeners.length;++t)this.listeners[t](e)},y.prototype.provide=function(e){if(void 0!==this.res)throw"Resource has already been provided.";this.res=e;for(var t=0;t<this.queue.length;++t)this.queue[t](e);this.queue=null},y.prototype.await=function(e){return void 0!==this.res?(e(this.res),this.res):void this.queue.push(e)};var k=0,L={TTT:"F",TTC:"F",TTA:"L",TTG:"L",CTT:"L",CTC:"L",CTA:"L",CTG:"L",ATT:"I",ATC:"I",ATA:"I",ATG:"M",GTT:"V",GTC:"V",GTA:"V",GTG:"V",TCT:"S",TCC:"S",TCA:"S",TCG:"S",CCT:"P",CCC:"P",CCA:"P",CCG:"P",ACT:"T",ACC:"T",ACA:"T",ACG:"T",GCT:"A",GCC:"A",GCA:"A",GCG:"A",TAT:"Y",TAC:"Y",TAA:"*",TAG:"*",CAT:"H",CAC:"H",CAA:"Q",CAG:"Q",AAT:"N",AAC:"N",AAA:"K",AAG:"K",GAT:"D",GAC:"D",GAA:"E",GAG:"E",TGT:"C",TGC:"C",TGA:"*",TGG:"W",CGT:"R",CGC:"R",CGA:"R",CGG:"R",AGT:"S",AGC:"S",AGA:"R",AGG:"R",GGT:"G",GGC:"G",GGA:"G",GGG:"G"};"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"undefined"!=typeof t&&(t.exports={textXHR:b,relativeURL:w,resolveUrlToPage:x,shallowCopy:g,pusho:n,pushnew:r,pushnewo:s,arrayIndexOf:a,pick:o,makeElement:u,makeElementNS:h,removeChildren:p,miniJSONify:d,Observed:v,Awaited:y,AMINO_ACID_TRANSLATION:L})},{"./sha1":37}],56:[function(e,t,i){"use strict";function r(){this.info=[]}function n(e,t){this.parser=e,this.sink=t}if("undefined"!=typeof e){var s=e("./sourceadapters"),o=s.registerParserFactory,a=e("./das"),l=a.DASStylesheet,u=a.DASStyle,h=a.DASFeature;a.DASGroup}var c=/([^;=]+)(=([^;]+))?;?/,f=/##INFO=<([^>]+)>/,p=/([^,=]+)=([^,]+|"[^"]+"),?/;r.prototype.createSession=function(e){return new n(this,e)},n.prototype.parse=function(e){if(0!=e.length)if("#"!=e[0]){var t=e.split("	"),i=new h;i.segment=t[0],i.id=t[2],i.refAllele=t[3],i.altAlleles=t[4].split(","),i.min=parseInt(t[1]),i.max=i.min+i.refAllele.length-1;var r=t[7].split(c);i.info={};for(var n=0;n<r.length;n+=4)i.info[r[n+1]]=r[n+3];var s=i.altAlleles[0],o=i.refAllele;s.length>o.length?(i.type="insertion",0==s.indexOf(o)?(i.insertion=s.substr(o.length),i.min+=o.length,i.max=i.min-1):i.insertion=s):s.length<o.length?i.type="deletion":i.type="substitution",this.sink(i)}else if(e.length>1&&"#"==e[1]){var a=f.exec(e);if(a){for(var t=a[1].split(p),l=null,u=null,n=0;n<t.length-1;n+=3){var d=t[n+1],g=t[n+2].replace(/"/g,"");"ID"==d?l=g:"Description"==d&&(u=g)}l&&u&&this.parser.info.push({id:l,desc:u})}return}},n.prototype.flush=function(){},r.prototype.getStyleSheet=function(e){var t=new l,i=new u;i.glyph="__INSERTION",i.BUMP="yes",i.LABEL="no",i.FGCOLOR="rgb(50,80,255)",i.BGCOLOR="#888888",i.STROKECOLOR="black",t.pushStyle({type:"insertion"},null,i);var i=new u;i.glyph="PLIMSOLL",i.BUMP="yes",i.LABEL="no",i.FGCOLOR="rgb(255, 60, 60)",i.BGCOLOR="#888888",i.STROKECOLOR="black",t.pushStyle({type:"deletion"},null,i);var i=new u;return i.glyph="PLIMSOLL",i.BUMP="yes",i.LABEL="no",i.FGCOLOR="rgb(50,80,255)",
i.BGCOLOR="#888888",i.STROKECOLOR="black",t.pushStyle({type:"default"},null,i),e(t)},r.prototype.getDefaultFIPs=function(e){var t=this,i=function(e,i){if(i.add("Ref. allele",e.refAllele),i.add("Alt. alleles",e.altAlleles.join(",")),e.info)for(var r=0;r<t.info.length;++r){var n=t.info[r],s=e.info[n.id];void 0!==s&&i.add(n.desc,s)}};e(i)},o("vcf",function(){return new r})},{"./das":10,"./sourceadapters":38}],57:[function(e,t,i){"use strict";var r={CONFIG:5,MAJOR:0,MINOR:13,MICRO:7,BRANCH:"dev"};r.toString=function(){var e=""+this.MAJOR+"."+this.MINOR+"."+this.MICRO;return this.PATCH&&(e+=this.PATCH),this.BRANCH&&""!=this.BRANCH&&(e=e+"-"+this.BRANCH),e},"undefined"!=typeof t&&(t.exports=r)},{}],58:[function(e,t,i){"use strict";function r(e){function t(e){e=Math.min(e,n),e=Math.max(e,r),l=e,f.style.left=""+l+"px"}function i(e){e=Math.min(e,n),e=Math.max(e,r),u=e,p.style.left=""+u+"px"}e=e||{};var r=0,n=e.width||200,o=0,a=200,l=50,u=100,h=[],c=s("hr",null,{className:"slider-track"},{width:""+(0|n)+"px"}),f=s("hr",null,{className:"slider-thumb active"}),p=s("hr",null,{className:"slider-thumb"}),d=s("div",[c,f,p],{className:"slider"},{width:""+((0|n)+10)+"px"});d.removeLabels=function(){for(var e=0;e<h.length;++e)d.removeChild(h[e]);h=[]},d.addLabel=function(e,t){var i=s("div",t,{className:"slider-label"},{left:""+(r+(e-o)*(n-r)/(a-o)|0)+"px"});d.appendChild(i),h.push(i)};var g=document.createEvent("HTMLEvents");g.initEvent("change",!0,!1),Object.defineProperty(d,"value",{get:function(){return o+(l-r)*(a-o)/(n-r)},set:function(e){var i=r+(e-o)*(n-r)/(a-o);t(i)}}),Object.defineProperty(d,"value2",{get:function(){return o+(u-r)*(a-o)/(n-r)},set:function(e){var t=r+(e-o)*(n-r)/(a-o);i(t)}}),Object.defineProperty(d,"active",{get:function(){return f.classList.contains("active")?1:2},set:function(e){1==e?(f.classList.add("active"),p.classList.remove("active")):(p.classList.add("active"),f.classList.remove("active"))}}),Object.defineProperty(d,"min",{get:function(){return o},set:function(e){o=e}}),Object.defineProperty(d,"max",{get:function(){return a},set:function(e){a=e}});var v,y,m=function(e){y=this==f?1:2,y!=d.active&&(d.active=y,d.dispatchEvent(g)),e.stopPropagation(),e.preventDefault(),window.addEventListener("mousemove",b,!1),window.addEventListener("mouseup",w,!1),v=e.clientX-(1==y?l:u)};f.addEventListener("mousedown",m,!1),p.addEventListener("mousedown",m,!1);var b=function(e){1==y?t(e.clientX-v):i(e.clientX-v),d.dispatchEvent(g)},w=function x(e){window.removeEventListener("mousemove",b,!1),window.removeEventListener("mouseup",x,!1)};return d}if("undefined"!=typeof e)var n=e("./utils"),s=n.makeElement;"undefined"!=typeof t&&(t.exports=r)},{"./utils":55}],59:[function(e,t,i){(function(i,r){(function(){"use strict";function n(e){return"function"==typeof e||"object"==typeof e&&null!==e}function s(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){W=e}function l(e){Z=e}function u(){return function(){i.nextTick(d)}}function h(){return function(){j(d)}}function c(){var e=0,t=new $(d),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}function f(){var e=new MessageChannel;return e.port1.onmessage=d,function(){e.port2.postMessage(0)}}function p(){return function(){setTimeout(d,1)}}function d(){for(var e=0;K>e;e+=2){var t=te[e],i=te[e+1];t(i),te[e]=void 0,te[e+1]=void 0}K=0}function g(){try{var t=e,i=t("vertx");return j=i.runOnLoop||i.runOnContext,h()}catch(r){return p()}}function v(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function m(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(t){return se.error=t,se}}function w(e,t,i,r){try{e.call(t,i,r)}catch(n){return n}}function x(e,t,i){Z(function(e){var r=!1,n=w(i,t,function(i){r||(r=!0,t!==i?T(e,i):k(e,i))},function(t){r||(r=!0,L(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&n&&(r=!0,L(e,n))},e)}function S(e,t){t._state===re?k(e,t._result):t._state===ne?L(e,t._result):O(t,void 0,function(t){T(e,t)},function(t){L(e,t)})}function _(e,t){if(t.constructor===e.constructor)S(e,t);else{var i=b(t);i===se?L(e,se.error):void 0===i?k(e,t):s(i)?x(e,t,i):k(e,t)}}function T(e,t){e===t?L(e,y()):n(t)?_(e,t):k(e,t)}function C(e){e._onerror&&e._onerror(e._result),A(e)}function k(e,t){e._state===ie&&(e._result=t,e._state=re,0!==e._subscribers.length&&Z(A,e))}function L(e,t){e._state===ie&&(e._state=ne,e._result=t,Z(C,e))}function O(e,t,i,r){var n=e._subscribers,s=n.length;e._onerror=null,n[s]=t,n[s+re]=i,n[s+ne]=r,0===s&&e._state&&Z(A,e)}function A(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var r,n,s=e._result,o=0;o<t.length;o+=3)r=t[o],n=t[o+i],r?M(i,r,n,s):n(s);e._subscribers.length=0}}function E(){this.error=null}function R(e,t){try{return e(t)}catch(i){return oe.error=i,oe}}function M(e,t,i,r){var n,o,a,l,u=s(i);if(u){if(n=R(i,r),n===oe?(l=!0,o=n.error,n=null):a=!0,t===n)return void L(t,m())}else n=r,a=!0;t._state!==ie||(u&&a?T(t,n):l?L(t,o):e===re?k(t,n):e===ne&&L(t,n))}function B(e,t){try{t(function(t){T(e,t)},function(t){L(e,t)})}catch(i){L(e,i)}}function I(e,t){var i=this;i._instanceConstructor=e,i.promise=new e(v),i._validateInput(t)?(i._input=t,i.length=t.length,i._remaining=t.length,i._init(),0===i.length?k(i.promise,i._result):(i.length=i.length||0,i._enumerate(),0===i._remaining&&k(i.promise,i._result))):L(i.promise,i._validationError())}function P(e){return new ae(this,e).promise}function H(e){function t(e){T(n,e)}function i(e){L(n,e)}var r=this,n=new r(v);if(!X(e))return L(n,new TypeError("You must pass an array to race.")),n;for(var s=e.length,o=0;n._state===ie&&s>o;o++)O(r.resolve(e[o]),void 0,t,i);return n}function N(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var i=new t(v);return T(i,e),i}function F(e){var t=this,i=new t(v);return L(i,e),i}function G(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function D(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(e){this._id=fe++,this._state=void 0,this._result=void 0,this._subscribers=[],v!==e&&(s(e)||G(),this instanceof q||D(),B(this,e))}function U(){var e;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=e.Promise;(!i||"[object Promise]"!==Object.prototype.toString.call(i.resolve())||i.cast)&&(e.Promise=pe)}var z;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var j,W,V,X=z,K=0,Z=({}.toString,function(e,t){te[K]=e,te[K+1]=t,K+=2,2===K&&(W?W(d):V())}),Q="undefined"!=typeof window?window:void 0,Y=Q||{},$=Y.MutationObserver||Y.WebKitMutationObserver,J="undefined"!=typeof i&&"[object process]"==={}.toString.call(i),ee="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,te=new Array(1e3);V=J?u():$?c():ee?f():void 0===Q&&"function"==typeof e?g():p();var ie=void 0,re=1,ne=2,se=new E,oe=new E;I.prototype._validateInput=function(e){return X(e)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var ae=I;I.prototype._enumerate=function(){for(var e=this,t=e.length,i=e.promise,r=e._input,n=0;i._state===ie&&t>n;n++)e._eachEntry(r[n],n)},I.prototype._eachEntry=function(e,t){var i=this,r=i._instanceConstructor;o(e)?e.constructor===r&&e._state!==ie?(e._onerror=null,i._settledAt(e._state,t,e._result)):i._willSettleAt(r.resolve(e),t):(i._remaining--,i._result[t]=e)},I.prototype._settledAt=function(e,t,i){var r=this,n=r.promise;n._state===ie&&(r._remaining--,e===ne?L(n,i):r._result[t]=i),0===r._remaining&&k(n,r._result)},I.prototype._willSettleAt=function(e,t){var i=this;O(e,void 0,function(e){i._settledAt(re,t,e)},function(e){i._settledAt(ne,t,e)})};var le=P,ue=H,he=N,ce=F,fe=0,pe=q;q.all=le,q.race=ue,q.resolve=he,q.reject=ce,q._setScheduler=a,q._setAsap=l,q._asap=Z,q.prototype={constructor:q,then:function(e,t){var i=this,r=i._state;if(r===re&&!e||r===ne&&!t)return this;var n=new this.constructor(v),s=i._result;if(r){var o=arguments[r-1];Z(function(){M(r,n,o,s)})}else O(i,n,e,t);return n},"catch":function(e){return this.then(null,e)}};var de=U,ge={Promise:pe,polyfill:de};"function"==typeof define&&define.amd?define(function(){return ge}):"undefined"!=typeof t&&t.exports?t.exports=ge:"undefined"!=typeof this&&(this.ES6Promise=ge),de()}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:61}],60:[function(e,t,i){function r(){}function n(){this.was=[0]}function s(e,t,i){this.hufts=new Int32Array(3*g),this.window=new Uint8Array(i),this.end=i,this.checkfn=t,this.mode=z,this.reset(e,null),this.left=0,this.table=0,this.index=0,this.blens=null,this.bb=new Int32Array(1),this.tb=new Int32Array(1),this.codes=new o,this.last=0,this.bitk=0,this.bitb=0,this.read=0,this.write=0,this.check=0,this.inftree=new a}function o(){}function a(){}function l(e,t,i,r,n){return e[0]=J,t[0]=ee,i[0]=te,r[0]=ie,x}function u(e,t,i,r,n){if(0!=n){if(!e)throw"Undef src";if(!i)throw"Undef dest";0==t&&n==e.length?c(e,i,r):we?c(e.subarray(t,t+n),i,r):1==e.BYTES_PER_ELEMENT&&n>100?c(new Uint8Array(e.buffer,e.byteOffset+t,n),i,r):h(e,t,i,r,n)}}function h(e,t,i,r,n){for(var s=0;n>s;++s)i[r+s]=e[t+s]}function c(e,t,i){t.set(e,i)}function f(e,t,i,n){e=t?i?new Uint8Array(e,t,i):new Uint8Array(e,t,e.byteLength-t):new Uint8Array(e);var s=new r;s.inflateInit(d,!0),s.next_in=e,s.next_in_index=0,s.avail_in=e.length;for(var o=[],a=0;;){var l=new Uint8Array(32e3);s.next_out=l,s.next_out_index=0,s.avail_out=l.length;var h=s.inflate(m);if(h!=x&&h!=S&&h!=L)throw s.msg;if(0!=s.avail_out){var c=new Uint8Array(l.length-s.avail_out);u(l,0,c,0,l.length-s.avail_out),l=c}if(o.push(l),a+=l.length,h==S||h==L)break}if(n&&(n[0]=(t||0)+s.next_in_index),1==o.length)return o[0].buffer;for(var f=new Uint8Array(a),p=0,g=0;g<o.length;++g){var v=o[g];u(v,0,f,p,v.length),p+=v.length}return f.buffer}var p=15,d=p,g=1440,v=15,y=32,m=0,b=4,w=8,x=0,S=1,_=2,T=-2,C=-3,k=-4,L=-5,O=0,A=1,E=2,R=3,M=4,B=5,I=6,P=7,H=8,N=9,F=10,G=11,D=12,q=13,U=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],z=0,j=1,W=2,V=3,X=4,K=5,Z=6,Q=7,Y=8,$=9,J=9,ee=5,te=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],ie=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ne=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],oe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];r.prototype.inflateInit=function(e,t){return e||(e=d),t&&(t=!1),this.istate=new n,this.istate.inflateInit(this,t?-e:e)},r.prototype.inflate=function(e){return null==this.istate?T:this.istate.inflate(this,e)},r.prototype.inflateEnd=function(){if(null==this.istate)return T;var e=istate.inflateEnd(this);return this.istate=null,e},r.prototype.inflateSync=function(){return istate.inflateSync(this)},r.prototype.inflateSetDictionary=function(e,t){return istate.inflateSetDictionary(this,e,t)},n.prototype.inflateReset=function(e){return null==e||null==e.istate?T:(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=0!=e.istate.nowrap?P:O,e.istate.blocks.reset(e,null),x)},n.prototype.inflateEnd=function(e){return null!=this.blocks&&this.blocks.free(e),this.blocks=null,x},n.prototype.inflateInit=function(e,t){return e.msg=null,this.blocks=null,nowrap=0,0>t&&(t=-t,nowrap=1),8>t||t>15?(this.inflateEnd(e),T):(this.wbits=t,e.istate.blocks=new s(e,0!=e.istate.nowrap?null:this,1<<t),this.inflateReset(e),x)},n.prototype.inflate=function(e,t){var i,r;if(null==e||null==e.istate||null==e.next_in)return T;for(t=t==b?L:x,i=L;;)switch(e.istate.mode){case O:if(0==e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,(15&(e.istate.method=e.next_in[e.next_in_index++]))!=w){e.istate.mode=q,e.msg="unknown compression method",e.istate.marker=5;break}if((e.istate.method>>4)+8>e.istate.wbits){e.istate.mode=q,e.msg="invalid window size",e.istate.marker=5;break}e.istate.mode=A;case A:if(0==e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,r=255&e.next_in[e.next_in_index++],((e.istate.method<<8)+r)%31!=0){e.istate.mode=q,e.msg="incorrect header check",e.istate.marker=5;break}if(0==(r&y)){e.istate.mode=P;break}e.istate.mode=E;case E:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=R;case R:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=M;case M:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=B;case B:return 0==e.avail_in?i:(i=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.adler=e.istate.need,e.istate.mode=I,_);case I:return e.istate.mode=q,e.msg="need dictionary",e.istate.marker=0,T;case P:if(i=e.istate.blocks.proc(e,i),i==C){e.istate.mode=q,e.istate.marker=0;break}if(i==x&&(i=t),i!=S)return i;if(i=t,e.istate.blocks.reset(e,e.istate.was),0!=e.istate.nowrap){e.istate.mode=D;break}e.istate.mode=H;case H:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.next_in[e.next_in_index++])<<24&4278190080,e.istate.mode=N;case N:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<16&16711680,e.istate.mode=F;case F:if(0==e.avail_in)return i;i=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.next_in[e.next_in_index++])<<8&65280,e.istate.mode=G;case G:if(0==e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.next_in[e.next_in_index++],e.istate.was[0]!=e.istate.need){e.istate.mode=q,e.msg="incorrect data check",e.istate.marker=5;break}e.istate.mode=D;case D:return S;case q:return C;default:return T}},n.prototype.inflateSetDictionary=function(e,t,i){var r=0,n=i;return null==e||null==e.istate||e.istate.mode!=I?T:e._adler.adler32(1,t,0,i)!=e.adler?C:(e.adler=e._adler.adler32(0,null,0,0),n>=1<<e.istate.wbits&&(n=(1<<e.istate.wbits)-1,r=i-n),e.istate.blocks.set_dictionary(t,r,n),e.istate.mode=P,x)};var ae=[0,0,255,255];n.prototype.inflateSync=function(e){var t,i,r,n,s;if(null==e||null==e.istate)return T;if(e.istate.mode!=q&&(e.istate.mode=q,e.istate.marker=0),0==(t=e.avail_in))return L;for(i=e.next_in_index,r=e.istate.marker;0!=t&&4>r;)e.next_in[i]==ae[r]?r++:r=0!=e.next_in[i]?0:4-r,i++,t--;return e.total_in+=i-e.next_in_index,e.next_in_index=i,e.avail_in=t,e.istate.marker=r,4!=r?C:(n=e.total_in,s=e.total_out,this.inflateReset(e),e.total_in=n,e.total_out=s,e.istate.mode=P,x)},n.prototype.inflateSyncPoint=function(e){return null==e||null==e.istate||null==e.istate.blocks?T:e.istate.blocks.sync_point()};var le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];s.prototype.reset=function(e,t){t&&(t[0]=this.check),this.mode==Z&&this.codes.free(e),this.mode=z,this.bitk=0,this.bitb=0,this.read=this.write=0,this.checkfn&&(e.adler=this.check=e._adler.adler32(0,null,0,0))},s.prototype.proc=function(e,t){var i,r,n,s,o,a,h;for(s=e.next_in_index,o=e.avail_in,r=this.bitb,n=this.bitk,a=this.write,h=a<this.read?this.read-a-1:this.end-a;;)switch(this.mode){case z:for(;3>n;){if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);t=x,o--,r|=(255&e.next_in[s++])<<n,n+=8}switch(i=7&r,this.last=1&i,i>>>1){case 0:r>>>=3,n-=3,i=7&n,r>>>=i,n-=i,this.mode=j;break;case 1:var c=new Int32Array(1),f=new Int32Array(1),p=[],d=[];l(c,f,p,d,e),this.codes.init(c[0],f[0],p[0],0,d[0],0,e),r>>>=3,n-=3,this.mode=Z;break;case 2:r>>>=3,n-=3,this.mode=V;break;case 3:return r>>>=3,n-=3,this.mode=q,e.msg="invalid block type",t=C,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t)}break;case j:for(;32>n;){if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);t=x,o--,r|=(255&e.next_in[s++])<<n,n+=8}if((~r>>>16&65535)!=(65535&r))return this.mode=q,e.msg="invalid stored block lengths",t=C,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);this.left=65535&r,r=n=0,this.mode=0!=this.left?W:0!=this.last?Q:z;break;case W:if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,write=a,this.inflate_flush(e,t);if(0==h&&(a==end&&0!=read&&(a=0,h=a<this.read?this.read-a-1:this.end-a),0==h&&(this.write=a,t=this.inflate_flush(e,t),a=this.write,h=a<this.read?this.read-a-1:this.end-a,a==this.end&&0!=this.read&&(a=0,h=a<this.read?this.read-a-1:this.end-a),0==h)))return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);if(t=x,i=this.left,i>o&&(i=o),i>h&&(i=h),u(e.next_in,s,this.window,a,i),s+=i,o-=i,a+=i,h-=i,0!=(this.left-=i))break;this.mode=0!=this.last?Q:z;break;case V:for(;14>n;){if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);t=x,o--,r|=(255&e.next_in[s++])<<n,n+=8}if(this.table=i=16383&r,(31&i)>29||(i>>5&31)>29)return this.mode=$,e.msg="too many length or distance symbols",t=C,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);if(i=258+(31&i)+(i>>5&31),null==this.blens||this.blens.length<i)this.blens=new Int32Array(i);else for(var g=0;i>g;g++)this.blens[g]=0;r>>>=14,n-=14,this.index=0,mode=X;case X:for(;this.index<4+(this.table>>>10);){for(;3>n;){if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);t=x,o--,r|=(255&e.next_in[s++])<<n,n+=8}this.blens[le[this.index++]]=7&r,r>>>=3,n-=3}for(;this.index<19;)this.blens[le[this.index++]]=0;if(this.bb[0]=7,i=this.inftree.inflate_trees_bits(this.blens,this.bb,this.tb,this.hufts,e),i!=x)return t=i,t==C&&(this.blens=null,this.mode=$),this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,write=a,this.inflate_flush(e,t);this.index=0,this.mode=K;case K:for(;;){if(i=this.table,!(this.index<258+(31&i)+(i>>5&31)))break;var g,v,y;for(i=this.bb[0];i>n;){if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);t=x,o--,r|=(255&e.next_in[s++])<<n,n+=8}if(i=this.hufts[3*(this.tb[0]+(r&U[i]))+1],y=this.hufts[3*(this.tb[0]+(r&U[i]))+2],16>y)r>>>=i,n-=i,this.blens[this.index++]=y;else{for(g=18==y?7:y-14,v=18==y?11:3;i+g>n;){if(0==o)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);t=x,o--,r|=(255&e.next_in[s++])<<n,n+=8}if(r>>>=i,n-=i,v+=r&U[g],r>>>=g,n-=g,g=this.index,i=this.table,g+v>258+(31&i)+(i>>5&31)||16==y&&1>g)return this.blens=null,this.mode=$,e.msg="invalid bit length repeat",t=C,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);y=16==y?this.blens[g-1]:0;do this.blens[g++]=y;while(0!=--v);this.index=g}}this.tb[0]=-1;var c=new Int32Array(1),f=new Int32Array(1),p=new Int32Array(1),d=new Int32Array(1);if(c[0]=9,f[0]=6,i=this.table,i=this.inftree.inflate_trees_dynamic(257+(31&i),1+(i>>5&31),this.blens,c,f,p,d,this.hufts,e),i!=x)return i==C&&(this.blens=null,this.mode=q),t=i,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);this.codes.init(c[0],f[0],this.hufts,p[0],this.hufts,d[0],e),this.mode=Z;case Z:if(this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,(t=this.codes.proc(this,e,t))!=S)return this.inflate_flush(e,t);if(t=x,this.codes.free(e),s=e.next_in_index,o=e.avail_in,r=this.bitb,n=this.bitk,a=this.write,h=a<this.read?this.read-a-1:this.end-a,0==this.last){this.mode=z;break}this.mode=Q;case Q:if(this.write=a,t=this.inflate_flush(e,t),a=this.write,h=a<this.read?this.read-a-1:this.end-a,this.read!=this.write)return this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);mode=D;case Y:return t=S,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);case $:return t=C,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t);default:return t=T,this.bitb=r,this.bitk=n,e.avail_in=o,e.total_in+=s-e.next_in_index,e.next_in_index=s,this.write=a,this.inflate_flush(e,t)}},s.prototype.free=function(e){this.reset(e,null),this.window=null,this.hufts=null},s.prototype.set_dictionary=function(e,t,i){u(e,t,window,0,i),this.read=this.write=i},s.prototype.sync_point=function(){return this.mode==j},s.prototype.inflate_flush=function(e,t){var i,r,n;return r=e.next_out_index,n=this.read,i=(n<=this.write?this.write:this.end)-n,i>e.avail_out&&(i=e.avail_out),0!=i&&t==L&&(t=x),e.avail_out-=i,e.total_out+=i,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,n,i)),u(this.window,n,e.next_out,r,i),r+=i,n+=i,n==this.end&&(n=0,this.write==this.end&&(this.write=0),i=this.write-n,i>e.avail_out&&(i=e.avail_out),0!=i&&t==L&&(t=x),e.avail_out-=i,e.total_out+=i,null!=this.checkfn&&(e.adler=this.check=e._adler.adler32(this.check,this.window,n,i)),u(this.window,n,e.next_out,r,i),r+=i,n+=i),e.next_out_index=r,this.read=n,t};var ue=0,he=1,ce=2,fe=3,pe=4,de=5,ge=6,ve=7,ye=8,me=9;o.prototype.init=function(e,t,i,r,n,s,o){this.mode=ue,this.lbits=e,this.dbits=t,this.ltree=i,this.ltree_index=r,this.dtree=n,this.dtree_index=s,this.tree=null},o.prototype.proc=function(e,t,i){var r,n,s,o,a,l,u,h=0,c=0,f=0;for(f=t.next_in_index,o=t.avail_in,h=e.bitb,c=e.bitk,a=e.write,l=a<e.read?e.read-a-1:e.end-a;;)switch(this.mode){case ue:if(l>=258&&o>=10&&(e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,i=this.inflate_fast(this.lbits,this.dbits,this.ltree,this.ltree_index,this.dtree,this.dtree_index,e,t),f=t.next_in_index,o=t.avail_in,h=e.bitb,c=e.bitk,a=e.write,l=a<e.read?e.read-a-1:e.end-a,i!=x)){this.mode=i==S?ve:me;break}this.need=this.lbits,this.tree=this.ltree,this.tree_index=this.ltree_index,this.mode=he;case he:for(r=this.need;r>c;){if(0==o)return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);i=x,o--,h|=(255&t.next_in[f++])<<c,c+=8}if(n=3*(this.tree_index+(h&U[r])),h>>>=this.tree[n+1],c-=this.tree[n+1],s=this.tree[n],0==s){this.lit=this.tree[n+2],this.mode=ge;break}if(0!=(16&s)){this.get=15&s,this.len=this.tree[n+2],this.mode=ce;break}if(0==(64&s)){this.need=s,this.tree_index=n/3+this.tree[n+2];break}if(0!=(32&s)){this.mode=ve;break}return this.mode=me,t.msg="invalid literal/length code",i=C,e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);case ce:for(r=this.get;r>c;){if(0==o)return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);i=x,o--,h|=(255&t.next_in[f++])<<c,c+=8}this.len+=h&U[r],h>>=r,c-=r,this.need=this.dbits,this.tree=this.dtree,this.tree_index=this.dtree_index,this.mode=fe;case fe:for(r=this.need;r>c;){if(0==o)return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);i=x,o--,h|=(255&t.next_in[f++])<<c,c+=8}if(n=3*(this.tree_index+(h&U[r])),h>>=this.tree[n+1],c-=this.tree[n+1],s=this.tree[n],0!=(16&s)){this.get=15&s,this.dist=this.tree[n+2],this.mode=pe;break}if(0==(64&s)){this.need=s,this.tree_index=n/3+this.tree[n+2];break}return this.mode=me,t.msg="invalid distance code",i=C,e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);case pe:for(r=this.get;r>c;){if(0==o)return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);i=x,o--,h|=(255&t.next_in[f++])<<c,c+=8}this.dist+=h&U[r],h>>=r,c-=r,this.mode=de;case de:for(u=a-this.dist;0>u;)u+=e.end;for(;0!=this.len;){if(0==l&&(a==e.end&&0!=e.read&&(a=0,l=a<e.read?e.read-a-1:e.end-a),0==l&&(e.write=a,i=e.inflate_flush(t,i),a=e.write,l=a<e.read?e.read-a-1:e.end-a,a==e.end&&0!=e.read&&(a=0,l=a<e.read?e.read-a-1:e.end-a),0==l)))return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);e.window[a++]=e.window[u++],l--,u==e.end&&(u=0),this.len--}this.mode=ue;break;case ge:if(0==l&&(a==e.end&&0!=e.read&&(a=0,l=a<e.read?e.read-a-1:e.end-a),0==l&&(e.write=a,i=e.inflate_flush(t,i),a=e.write,l=a<e.read?e.read-a-1:e.end-a,a==e.end&&0!=e.read&&(a=0,l=a<e.read?e.read-a-1:e.end-a),0==l)))return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);i=x,e.window[a++]=this.lit,l--,this.mode=ue;break;case ve:if(c>7&&(c-=8,o++,f--),e.write=a,i=e.inflate_flush(t,i),a=e.write,l=a<e.read?e.read-a-1:e.end-a,e.read!=e.write)return e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);this.mode=ye;case ye:return i=S,e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);case me:return i=C,e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i);default:return i=T,e.bitb=h,e.bitk=c,t.avail_in=o,t.total_in+=f-t.next_in_index,t.next_in_index=f,e.write=a,e.inflate_flush(t,i)}},o.prototype.free=function(e){},o.prototype.inflate_fast=function(e,t,i,r,n,s,o,a){var l,h,c,f,p,d,g,v,y,m,b,w,_,T,k,L;g=a.next_in_index,v=a.avail_in,p=o.bitb,d=o.bitk,y=o.write,m=y<o.read?o.read-y-1:o.end-y,b=U[e],w=U[t];do{for(;20>d;)v--,p|=(255&a.next_in[g++])<<d,d+=8;if(l=p&b,h=i,c=r,L=3*(c+l),0!=(f=h[L]))for(;;){if(p>>=h[L+1],d-=h[L+1],0!=(16&f)){for(f&=15,_=h[L+2]+(p&U[f]),p>>=f,d-=f;15>d;)v--,p|=(255&a.next_in[g++])<<d,d+=8;for(l=p&w,h=n,c=s,L=3*(c+l),f=h[L];;){if(p>>=h[L+1],d-=h[L+1],0!=(16&f)){for(f&=15;f>d;)v--,p|=(255&a.next_in[g++])<<d,d+=8;if(T=h[L+2]+(p&U[f]),p>>=f,d-=f,m-=_,y>=T)k=y-T,y-k>0&&2>y-k?(o.window[y++]=o.window[k++],o.window[y++]=o.window[k++],_-=2):(o.window[y++]=o.window[k++],o.window[y++]=o.window[k++],_-=2);else{k=y-T;do k+=o.end;while(0>k);if(f=o.end-k,_>f){if(_-=f,y-k>0&&f>y-k){do o.window[y++]=o.window[k++];while(0!=--f)}else u(o.window,k,o.window,y,f),y+=f,k+=f,f=0;k=0}}do o.window[y++]=o.window[k++];while(0!=--_);break}if(0!=(64&f))return a.msg="invalid distance code",_=a.avail_in-v,_=_>d>>3?d>>3:_,v+=_,g-=_,d-=_<<3,o.bitb=p,o.bitk=d,a.avail_in=v,a.total_in+=g-a.next_in_index,a.next_in_index=g,o.write=y,C;l+=h[L+2],l+=p&U[f],L=3*(c+l),f=h[L]}break}if(0!=(64&f))return 0!=(32&f)?(_=a.avail_in-v,_=_>d>>3?d>>3:_,v+=_,g-=_,d-=_<<3,o.bitb=p,o.bitk=d,a.avail_in=v,a.total_in+=g-a.next_in_index,a.next_in_index=g,o.write=y,S):(a.msg="invalid literal/length code",_=a.avail_in-v,_=_>d>>3?d>>3:_,v+=_,g-=_,d-=_<<3,o.bitb=p,o.bitk=d,a.avail_in=v,a.total_in+=g-a.next_in_index,a.next_in_index=g,o.write=y,C);if(l+=h[L+2],l+=p&U[f],L=3*(c+l),0==(f=h[L])){p>>=h[L+1],d-=h[L+1],o.window[y++]=h[L+2],m--;break}}else p>>=h[L+1],d-=h[L+1],o.window[y++]=h[L+2],m--}while(m>=258&&v>=10);
return _=a.avail_in-v,_=_>d>>3?d>>3:_,v+=_,g-=_,d-=_<<3,o.bitb=p,o.bitk=d,a.avail_in=v,a.total_in+=g-a.next_in_index,a.next_in_index=g,o.write=y,x},a.prototype.huft_build=function(e,t,i,r,n,s,o,a,l,h,c){var f,p,d,y,m,b,w,S,_,T,k,O,A,E,R;T=0,m=i;do this.c[e[t+T]]++,T++,m--;while(0!=m);if(this.c[0]==i)return o[0]=-1,a[0]=0,x;for(S=a[0],b=1;v>=b&&0==this.c[b];b++);for(w=b,b>S&&(S=b),m=v;0!=m&&0==this.c[m];m--);for(d=m,S>m&&(S=m),a[0]=S,E=1<<b;m>b;b++,E<<=1)if((E-=this.c[b])<0)return C;if((E-=this.c[m])<0)return C;for(this.c[m]+=E,this.x[1]=b=0,T=1,A=2;0!=--m;)this.x[A]=b+=this.c[T],A++,T++;m=0,T=0;do 0!=(b=e[t+T])&&(this.v[this.x[b]++]=m),T++;while(++m<i);for(i=this.x[d],this.x[0]=m=0,T=0,y=-1,O=-S,this.u[0]=0,k=0,R=0;d>=w;w++)for(f=this.c[w];0!=f--;){for(;w>O+S;){if(y++,O+=S,R=d-O,R=R>S?S:R,(p=1<<(b=w-O))>f+1&&(p-=f+1,A=w,R>b))for(;++b<R&&!((p<<=1)<=this.c[++A]);)p-=this.c[A];if(R=1<<b,this.hn[0]+R>g)return C;this.u[y]=k=this.hn[0],this.hn[0]+=R,0!=y?(this.x[y]=m,this.r[0]=b,this.r[1]=S,b=m>>>O-S,this.r[2]=k-this.u[y-1]-b,u(this.r,0,l,3*(this.u[y-1]+b),3)):o[0]=k}for(this.r[1]=w-O,T>=i?this.r[0]=192:c[T]<r?(this.r[0]=this.v[T]<256?0:96,this.r[2]=this.v[T++]):(this.r[0]=s[this.v[T]-r]+16+64,this.r[2]=n[this.v[T++]-r]),p=1<<w-O,b=m>>>O;R>b;b+=p)u(this.r,0,l,3*(k+b),3);for(b=1<<w-1;0!=(m&b);b>>>=1)m^=b;for(m^=b,_=(1<<O)-1;(m&_)!=this.x[y];)y--,O-=S,_=(1<<O)-1}return 0!=E&&1!=d?L:x},a.prototype.inflate_trees_bits=function(e,t,i,r,n){var s;return this.initWorkArea(19),this.hn[0]=0,s=this.huft_build(e,0,19,19,null,null,i,t,r,this.hn,this.v),s==C?n.msg="oversubscribed dynamic bit lengths tree":(s==L||0==t[0])&&(n.msg="incomplete dynamic bit lengths tree",s=C),s},a.prototype.inflate_trees_dynamic=function(e,t,i,r,n,s,o,a,l){var u;return this.initWorkArea(288),this.hn[0]=0,u=this.huft_build(i,0,e,257,re,ne,s,r,a,this.hn,this.v),u!=x||0==r[0]?(u==C?l.msg="oversubscribed literal/length tree":u!=k&&(l.msg="incomplete literal/length tree",u=C),u):(this.initWorkArea(288),u=this.huft_build(i,e,t,0,se,oe,o,n,a,this.hn,this.v),u!=x||0==n[0]&&e>257?(u==C?l.msg="oversubscribed distance tree":u==L?(l.msg="incomplete distance tree",u=C):u!=k&&(l.msg="empty distance tree with lengths",u=C),u):x)},a.prototype.initWorkArea=function(e){null==this.hn&&(this.hn=new Int32Array(1),this.v=new Int32Array(e),this.c=new Int32Array(v+1),this.r=new Int32Array(3),this.u=new Int32Array(v),this.x=new Int32Array(v+1)),this.v.length<e&&(this.v=new Int32Array(e));for(var t=0;e>t;t++)this.v[t]=0;for(var t=0;v+1>t;t++)this.c[t]=0;for(var t=0;3>t;t++)this.r[t]=0;u(this.c,0,this.u,0,v),u(this.c,0,this.x,0,v+1)};var be=new Uint8Array(1),we="function"==typeof be.subarray;"undefined"!=typeof t&&(t.exports={inflateBuffer:f,arrayCopy:u})},{}],61:[function(e,t,i){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function s(e){if(c===setTimeout)return setTimeout(e,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?g=d.concat(g):y=-1,g.length&&l())}function l(){if(!v){var e=s(a);v=!0;for(var t=g.length;t;){for(d=g,g=[];++y<t;)d&&d[y].run();y=-1,t=g.length}d=null,v=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function h(){}var c,f,p=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(e){c=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var d,g=[],v=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];g.push(new u(e,t)),1!==g.length||v||s(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=h,p.addListener=h,p.once=h,p.off=h,p.removeListener=h,p.removeAllListeners=h,p.emit=h,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],62:[function(e,t,i){(function(){"use strict";var e={"@@functional/placeholder":!0},r=function(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,i){return t.apply(this,arguments)};case 3:return function(e,i,r){return t.apply(this,arguments)};case 4:return function(e,i,r,n){return t.apply(this,arguments)};case 5:return function(e,i,r,n,s){return t.apply(this,arguments)};case 6:return function(e,i,r,n,s,o){return t.apply(this,arguments)};case 7:return function(e,i,r,n,s,o,a){return t.apply(this,arguments)};case 8:return function(e,i,r,n,s,o,a,l){return t.apply(this,arguments)};case 9:return function(e,i,r,n,s,o,a,l,u){return t.apply(this,arguments)};case 10:return function(e,i,r,n,s,o,a,l,u,h){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},n=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},s=function(){return Array.prototype.slice.call(arguments)},o=function(e){return new RegExp(e.source,(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":""))},a=function(e){return function(){return!e.apply(this,arguments)}},l=function(e,t){e=e||[],t=t||[];var i,r=e.length,n=t.length,s=[];for(i=0;r>i;)s[s.length]=e[i],i+=1;for(i=0;n>i;)s[s.length]=t[i],i+=1;return s},u=function(e,t,i){for(var r=0,n=i.length;n>r;){if(e(t,i[r]))return!0;r+=1}return!1},h=function(e,t){for(var i=0,r=t.length,n=[];r>i;)e(t[i])&&(n[n.length]=t[i]),i+=1;return n},c=function(e){return{"@@transducer/value":e,"@@transducer/reduced":!0}},f=function(e){var t=String(e).match(/^function (\w*)/);return null==t?"":t[1]},p=function(e,t){return Object.prototype.hasOwnProperty.call(t,e)},d=function(e){return e},g=function(){var e=Object.prototype.toString;return"[object Arguments]"===e.call(arguments)?function(t){return"[object Arguments]"===e.call(t)}:function(e){return p("callee",e)}}(),v=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)},y=function(e){return"[object Function]"===Object.prototype.toString.call(e)},m=Number.isInteger||function(e){return e<<0===e},b=function(e){return"[object Number]"===Object.prototype.toString.call(e)},w=function(e){return"[object Object]"===Object.prototype.toString.call(e)},x=function(e){return null!=e&&"object"==typeof e&&e["@@functional/placeholder"]===!0},S=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},_=function(e){return"[object String]"===Object.prototype.toString.call(e)},T=function(e){return"function"==typeof e["@@transducer/step"]},C=function(e,t){for(var i=0,r=t.length,n=Array(r);r>i;)n[i]=e(t[i]),i+=1;return n},k=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1,r=arguments.length;r>i;){var n=arguments[i];if(null!=n)for(var s in n)p(s,n)&&(t[s]=n[s]);i+=1}return t},L=function(e){return[e]},O=function(e,t){return function(){return t.call(this,e.apply(this,arguments))}},A=function(e,t){return function(){var i=this;return e.apply(i,arguments).then(function(e){return t.call(i,e)})}},E=function(e){var t=e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return'"'+t.replace(/"/g,'\\"')+'"'},R=function(e){return e&&e["@@transducer/reduced"]?e:{"@@transducer/value":e,"@@transducer/reduced":!0}},M=function qn(e,t,i){switch(arguments.length){case 1:return qn(e,0,e.length);case 2:return qn(e,t,e.length);default:for(var r=[],n=0,s=Math.max(0,Math.min(e.length,i)-t);s>n;)r[n]=e[t+n],n+=1;return r}},B=function(){var e=function(e){return(10>e?"0":"")+e};return"function"==typeof Date.prototype.toISOString?function(e){return e.toISOString()}:function(t){return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),I={init:function(){return this.xf["@@transducer/init"]()},result:function(e){return this.xf["@@transducer/result"](e)}},P=function(){function e(e){this.f=e}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(e){return e},e.prototype["@@transducer/step"]=function(e,t){return this.f(e,t)},function(t){return new e(t)}}(),H=function(e,t){for(var i=0,r=t.length-(e-1),n=new Array(r>=0?r:0);r>i;)n[i]=M(t,i,i+e),i+=1;return n},N="function"==typeof Object.assign?Object.assign:k,F=function(e,t){return function(){var i=arguments.length;if(0===i)return t();var r=arguments[i-1];return v(r)||"function"!=typeof r[e]?t.apply(this,arguments):r[e].apply(r,M(arguments,0,i-1))}},G=function(e){return function t(i){return 0===arguments.length||x(i)?t:e.apply(this,arguments)}},D=function(e){return function t(i,r){switch(arguments.length){case 0:return t;case 1:return x(i)?t:G(function(t){return e(i,t)});default:return x(i)&&x(r)?t:x(i)?G(function(t){return e(t,r)}):x(r)?G(function(t){return e(i,t)}):e(i,r)}}},q=function(e){return function t(i,r,n){switch(arguments.length){case 0:return t;case 1:return x(i)?t:D(function(t,r){return e(i,t,r)});case 2:return x(i)&&x(r)?t:x(i)?D(function(t,i){return e(t,r,i)}):x(r)?D(function(t,r){return e(i,t,r)}):G(function(t){return e(i,r,t)});default:return x(i)&&x(r)&&x(n)?t:x(i)&&x(r)?D(function(t,i){return e(t,i,n)}):x(i)&&x(n)?D(function(t,i){return e(t,r,i)}):x(r)&&x(n)?D(function(t,r){return e(i,t,r)}):x(i)?G(function(t){return e(t,r,n)}):x(r)?G(function(t){return e(i,t,n)}):x(n)?G(function(t){return e(i,r,t)}):e(i,r,n)}}},U=function Un(e,t,i){return function(){for(var n=[],s=0,o=e,a=0;a<t.length||s<arguments.length;){var l;a<t.length&&(!x(t[a])||s>=arguments.length)?l=t[a]:(l=arguments[s],s+=1),n[a]=l,x(l)||(o-=1),a+=1}return 0>=o?i.apply(this,n):r(o,Un(e,n,i))}},z=function(e,t,i){return function(){var r=arguments.length;if(0===r)return i();var n=arguments[r-1];if(!v(n)){var s=M(arguments,0,r-1);if("function"==typeof n[e])return n[e].apply(n,s);if(T(n)){var o=t.apply(null,s);return o(n)}}return i.apply(this,arguments)}},j=function(e,t){for(var i=t.length-1;i>=0&&e(t[i]);)i-=1;return M(t,0,i+1)},W=function(){function e(e,t){this.xf=t,this.f=e,this.all=!0}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.all&&(e=this.xf["@@transducer/step"](e,!0)),this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.f(t)||(this.all=!1,e=R(this.xf["@@transducer/step"](e,!1))),e},D(function(t,i){return new e(t,i)})}(),V=function(){function e(e,t){this.xf=t,this.f=e,this.any=!1}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.any||(e=this.xf["@@transducer/step"](e,!1)),this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.f(t)&&(this.any=!0,e=R(this.xf["@@transducer/step"](e,!0))),e},D(function(t,i){return new e(t,i)})}(),X=function(){function e(e,t){this.xf=t,this.pos=0,this.full=!1,this.acc=new Array(e)}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.acc=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.store(t),this.full?this.xf["@@transducer/step"](e,this.getCopy()):e},e.prototype.store=function(e){this.acc[this.pos]=e,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},e.prototype.getCopy=function(){return l(M(this.acc,this.pos),M(this.acc,0,this.pos))},D(function(t,i){return new e(t,i)})}(),K=function(){function e(e,t){this.xf=t,this.n=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=I.result,e.prototype["@@transducer/step"]=function(e,t){return this.n>0?(this.n-=1,e):this.xf["@@transducer/step"](e,t)},D(function(t,i){return new e(t,i)})}(),Z=function(){function e(e,t){this.xf=t,this.pos=0,this.full=!1,this.acc=new Array(e)}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.acc=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.full&&(e=this.xf["@@transducer/step"](e,this.acc[this.pos])),this.store(t),e},e.prototype.store=function(e){this.acc[this.pos]=e,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},D(function(t,i){return new e(t,i)})}(),Q=function(){function e(e,t){this.xf=t,this.pred=e,this.lastValue=void 0,this.seenFirstValue=!1}return e.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},e.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){var i=!1;return this.seenFirstValue?this.pred(this.lastValue,t)&&(i=!0):this.seenFirstValue=!0,this.lastValue=t,i?e:this.xf["@@transducer/step"](e,t)},D(function(t,i){return new e(t,i)})}(),Y=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=I.result,e.prototype["@@transducer/step"]=function(e,t){if(this.f){if(this.f(t))return e;this.f=null}return this.xf["@@transducer/step"](e,t)},D(function(t,i){return new e(t,i)})}(),$=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=I.result,e.prototype["@@transducer/step"]=function(e,t){return this.f(t)?this.xf["@@transducer/step"](e,t):e},D(function(t,i){return new e(t,i)})}(),J=function(){function e(e,t){this.xf=t,this.f=e,this.found=!1}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.found||(e=this.xf["@@transducer/step"](e,void 0)),this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.f(t)&&(this.found=!0,e=R(this.xf["@@transducer/step"](e,t))),e},D(function(t,i){return new e(t,i)})}(),ee=function(){function e(e,t){this.xf=t,this.f=e,this.idx=-1,this.found=!1}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.found||(e=this.xf["@@transducer/step"](e,-1)),this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.idx+=1,this.f(t)&&(this.found=!0,e=R(this.xf["@@transducer/step"](e,this.idx))),e},D(function(t,i){return new e(t,i)})}(),te=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.last))},e.prototype["@@transducer/step"]=function(e,t){return this.f(t)&&(this.last=t),e},D(function(t,i){return new e(t,i)})}(),ie=function(){function e(e,t){this.xf=t,this.f=e,this.idx=-1,this.lastIdx=-1}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](e,this.lastIdx))},e.prototype["@@transducer/step"]=function(e,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),e},D(function(t,i){return new e(t,i)})}(),re=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=I.result,e.prototype["@@transducer/step"]=function(e,t){return this.xf["@@transducer/step"](e,this.f(t))},D(function(t,i){return new e(t,i)})}(),ne=function(){function e(e,t){this.xf=t,this.n=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=I.result,e.prototype["@@transducer/step"]=function(e,t){return 0===this.n?R(e):(this.n-=1,this.xf["@@transducer/step"](e,t))},D(function(t,i){return new e(t,i)})}(),se=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=I.result,e.prototype["@@transducer/step"]=function(e,t){return this.f(t)?this.xf["@@transducer/step"](e,t):R(e)},D(function(t,i){return new e(t,i)})}(),oe=D(function(e,t){return Number(e)+Number(t)}),ae=q(function(e,t,i){if(t>=i.length||t<-i.length)return i;var r=0>t?i.length:0,n=r+t,s=l(i);return s[n]=e(i[n]),s}),le=D(z("all",W,function(e,t){for(var i=0;i<t.length;){if(!e(t[i]))return!1;i+=1}return!0})),ue=G(function(e){return function(){return e}}),he=D(function(e,t){return e&&t}),ce=D(z("any",V,function(e,t){for(var i=0;i<t.length;){if(e(t[i]))return!0;i+=1}return!1})),fe=D(z("aperture",X,H)),pe=D(function(e,t){return l(t,[e])}),de=D(function(e,t){return e.apply(this,t)}),ge=q(function(e,t,i){var r={};for(var n in i)r[n]=i[n];return r[e]=t,r}),ve=q(function zn(e,t,i){switch(e.length){case 0:return t;case 1:return ge(e[0],t,i);default:return ge(e[0],zn(M(e,1),t,Object(i[e[0]])),i)}}),ye=D(function(e,t){return r(e.length,function(){return e.apply(t,arguments)})}),me=q(function(e,t,i){if(e>t)throw new Error("min must not be greater than max in clamp(min, max, value)");return e>i?e:i>t?t:i}),be=G(function(e){return function(t,i){return e(t,i)?-1:e(i,t)?1:0}}),we=D(function(e,t){return 1===e?G(t):r(e,U(e,[],t))}),xe=oe(-1),Se=D(function(e,t){return null==t||t!==t?e:t}),_e=q(function(e,t,i){for(var r=[],n=0,s=t.length;s>n;)u(e,t[n],i)||u(e,t[n],r)||r.push(t[n]),n+=1;return r}),Te=D(function(e,t){var i={};for(var r in t)r!==e&&(i[r]=t[r]);return i}),Ce=D(function jn(e,t){switch(e.length){case 0:return t;case 1:return Te(e[0],t);default:var i=e[0],r=M(e,1);return null==t[i]?t:ge(i,jn(r,t[i]),t)}}),ke=D(function(e,t){return e/t}),Le=D(z("dropWhile",Y,function(e,t){for(var i=0,r=t.length;r>i&&e(t[i]);)i+=1;return M(t,i)})),Oe=G(function(e){return null!=e&&"function"==typeof e.empty?e.empty():null!=e&&null!=e.constructor&&"function"==typeof e.constructor.empty?e.constructor.empty():v(e)?[]:_(e)?"":w(e)?{}:g(e)?function(){return arguments}():void 0}),Ae=D(function Wn(e,t){var i,r,n,s={};for(r in t)i=e[r],n=typeof i,s[r]="function"===n?i(t[r]):"object"===n?Wn(e[r],t[r]):t[r];return s}),Ee=D(z("find",J,function(e,t){for(var i=0,r=t.length;r>i;){if(e(t[i]))return t[i];i+=1}})),Re=D(z("findIndex",ee,function(e,t){for(var i=0,r=t.length;r>i;){if(e(t[i]))return i;i+=1}return-1})),Me=D(z("findLast",te,function(e,t){for(var i=t.length-1;i>=0;){if(e(t[i]))return t[i];i-=1}})),Be=D(z("findLastIndex",ie,function(e,t){for(var i=t.length-1;i>=0;){if(e(t[i]))return i;i-=1}return-1})),Ie=D(F("forEach",function(e,t){for(var i=t.length,r=0;i>r;)e(t[r]),r+=1;return t})),Pe=G(function(e){for(var t=0,i=e.length,r={};i>t;)v(e[t])&&e[t].length&&(r[e[t][0]]=e[t][1]),t+=1;return r}),He=D(function(e,t){for(var i=[],r=0,n=t.length;n>r;){for(var s=r+1;n>s&&e(t[r],t[s]);)s+=1;i.push(t.slice(r,s)),r=s}return i}),Ne=D(function(e,t){return e>t}),Fe=D(function(e,t){return e>=t}),Ge=D(p),De=D(function(e,t){return e in t}),qe=D(function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}),Ue=G(d),ze=q(function(e,t,i){return we(Math.max(e.length,t.length,i.length),function(){return e.apply(this,arguments)?t.apply(this,arguments):i.apply(this,arguments)})}),je=oe(1),We=q(function(e,t,i){e=e<i.length&&e>=0?e:i.length;var r=M(i);return r.splice(e,0,t),r}),Ve=q(function(e,t,i){return e=e<i.length&&e>=0?e:i.length,l(l(M(i,0,e),t),M(i,e))}),Xe=D(F("intersperse",function(e,t){for(var i=[],r=0,n=t.length;n>r;)r===n-1?i.push(t[r]):i.push(t[r],e),r+=1;return i})),Ke=D(function(e,t){return null!=t&&t.constructor===e||t instanceof e}),Ze=G(function(e){return v(e)?!0:e?"object"!=typeof e?!1:e instanceof String?!1:1===e.nodeType?!!e.length:0===e.length?!0:e.length>0?e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1):!1:!1}),Qe=G(function(e){return null==e}),Ye=function(){var e=!{toString:null}.propertyIsEnumerable("toString"),t=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],i=function(){return arguments.propertyIsEnumerable("length")}(),r=function(e,t){for(var i=0;i<e.length;){if(e[i]===t)return!0;i+=1}return!1};return G("function"!=typeof Object.keys||i?function(n){if(Object(n)!==n)return[];var s,o,a=[],l=i&&g(n);for(s in n)!p(s,n)||l&&"length"===s||(a[a.length]=s);if(e)for(o=t.length-1;o>=0;)s=t[o],p(s,n)&&!r(a,s)&&(a[a.length]=s),o-=1;return a}:function(e){return Object(e)!==e?[]:Object.keys(e)})}(),$e=G(function(e){var t,i=[];for(t in e)i[i.length]=t;return i}),Je=G(function(e){return null!=e&&Ke(Number,e.length)?e.length:NaN}),et=D(function(e,t){return t>e}),tt=D(function(e,t){return t>=e}),it=q(function(e,t,i){for(var r=0,n=i.length,s=[],o=[t];n>r;)o=e(o[0],i[r]),s[r]=o[1],r+=1;return[o[0],s]}),rt=q(function(e,t,i){for(var r=i.length-1,n=[],s=[t];r>=0;)s=e(s[0],i[r]),n[r]=s[1],r-=1;return[s[0],n]}),nt=D(function(e,t){return t.match(e)||[]}),st=D(function(e,t){return m(e)?!m(t)||1>t?NaN:(e%t+t)%t:NaN}),ot=D(function(e,t){return t>e?t:e}),at=q(function(e,t,i){return e(i)>e(t)?i:t}),lt=D(function(e,t){return N({},e,t)}),ut=G(function(e){return N.apply(null,[{}].concat(e))}),ht=q(function(e,t,i){var r,n={};for(r in t)p(r,t)&&(n[r]=p(r,i)?e(r,t[r],i[r]):t[r]);for(r in i)p(r,i)&&!p(r,n)&&(n[r]=i[r]);return n}),ct=D(function(e,t){return e>t?t:e}),ft=q(function(e,t,i){return e(i)<e(t)?i:t}),pt=D(function(e,t){return e%t}),dt=D(function(e,t){return e*t}),gt=D(function(e,t){switch(e){case 0:return function(){return t.call(this)};case 1:return function(e){return t.call(this,e)};case 2:return function(e,i){return t.call(this,e,i)};case 3:return function(e,i,r){return t.call(this,e,i,r)};case 4:return function(e,i,r,n){return t.call(this,e,i,r,n)};case 5:return function(e,i,r,n,s){return t.call(this,e,i,r,n,s)};case 6:return function(e,i,r,n,s,o){return t.call(this,e,i,r,n,s,o)};case 7:return function(e,i,r,n,s,o,a){return t.call(this,e,i,r,n,s,o,a)};case 8:return function(e,i,r,n,s,o,a,l){return t.call(this,e,i,r,n,s,o,a,l)};case 9:return function(e,i,r,n,s,o,a,l,u){return t.call(this,e,i,r,n,s,o,a,l,u)};case 10:return function(e,i,r,n,s,o,a,l,u,h){return t.call(this,e,i,r,n,s,o,a,l,u,h)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),vt=G(function(e){return-e}),yt=D(a(z("any",V,ce))),mt=G(function(e){return!e}),bt=D(function(e,t){var i=0>e?t.length+e:e;return _(t)?t.charAt(i):t[i]}),wt=G(function(e){return function(){return bt(e,arguments)}}),xt=D(function(e,t){var i={};return i[e]=t,i}),St=G(L),_t=G(function(e){var t,i=!1;return r(e.length,function(){return i?t:(i=!0,t=e.apply(this,arguments))})}),Tt=D(function(e,t){return e||t}),Ct=function(){var e=function(t){return{value:t,map:function(i){return e(i(t))}}};return q(function(t,i,r){return t(function(t){return e(i(t))})(r).value})}(),kt=D(function(e,t){return[e,t]}),Lt=D(function(e,t){for(var i=t,r=0;r<e.length;){if(null==i)return;i=i[e[r]],r+=1}return i}),Ot=q(function(e,t,i){return Se(e,Lt(t,i))}),At=q(function(e,t,i){return t.length>0&&e(Lt(t,i))}),Et=D(function(e,t){for(var i={},r=0;r<e.length;)e[r]in t&&(i[e[r]]=t[e[r]]),r+=1;return i}),Rt=D(function(e,t){for(var i={},r=0,n=e.length;n>r;){var s=e[r];i[s]=t[s],r+=1}return i}),Mt=D(function(e,t){var i={};for(var r in t)e(t[r],r,t)&&(i[r]=t[r]);return i}),Bt=D(function(e,t){return l([e],t)}),It=D(function(e,t){return t[e]}),Pt=q(function(e,t,i){return null!=i&&p(t,i)?i[t]:e}),Ht=q(function(e,t,i){return e(i[t])}),Nt=D(function(e,t){for(var i=e.length,r=[],n=0;i>n;)r[n]=t[e[n]],n+=1;return r}),Ft=D(function(e,t){if(!b(e)||!b(t))throw new TypeError("Both arguments to range must be numbers");for(var i=[],r=e;t>r;)i.push(r),r+=1;return i}),Gt=q(function(e,t,i){for(var r=i.length-1;r>=0;)t=e(t,i[r]),r-=1;return t}),Dt=G(R),qt=q(function(e,t,i){return l(M(i,0,Math.min(e,i.length)),M(i,Math.min(i.length,e+t)))}),Ut=q(function(e,t,i){return i.replace(e,t)}),zt=G(function(e){return _(e)?e.split("").reverse().join(""):M(e).reverse()}),jt=q(function(e,t,i){for(var r=0,n=i.length,s=[t];n>r;)t=e(t,i[r]),s[r+1]=t,r+=1;return s}),Wt=q(function(e,t,i){return Ct(e,ue(t),i)}),Vt=q(F("slice",function(e,t,i){return Array.prototype.slice.call(i,e,t)})),Xt=D(function(e,t){return M(t).sort(e)}),Kt=D(function(e,t){return M(t).sort(function(t,i){var r=e(t),n=e(i);return n>r?-1:r>n?1:0})}),Zt=D(function(e,t){return[Vt(0,e,t),Vt(e,Je(t),t)]}),Qt=D(function(e,t){if(0>=e)throw new Error("First argument to splitEvery must be a positive integer");for(var i=[],r=0;r<t.length;)i.push(Vt(r,r+=e,t));return i}),Yt=D(function(e,t){for(var i=0,r=t.length,n=[];r>i&&!e(t[i]);)n.push(t[i]),i+=1;return[n,M(t,i)]}),$t=D(function(e,t){return Number(e)-Number(t)}),Jt=F("tail",Vt(1,1/0)),ei=D(z("take",ne,function(e,t){return Vt(0,0>e?1/0:e,t)})),ti=D(function(e,t){for(var i=t.length-1;i>=0&&e(t[i]);)i-=1;return M(t,i+1,1/0)}),ii=D(z("takeWhile",se,function(e,t){for(var i=0,r=t.length;r>i&&e(t[i]);)i+=1;return M(t,0,i)})),ri=D(function(e,t){return e(t),t}),ni=D(function(e,t){var i,r=Number(t),n=0;if(0>r||isNaN(r))throw new RangeError("n must be a non-negative number");for(i=new Array(r);r>n;)i[n]=e(n),n+=1;return i}),si=G(function(e){var t=[];for(var i in e)p(i,e)&&(t[t.length]=[i,e[i]]);return t}),oi=G(function(e){var t=[];for(var i in e)t[t.length]=[i,e[i]];return t}),ai=G(function(e){for(var t=0,i=[];t<e.length;){for(var r=e[t],n=0;n<r.length;)"undefined"==typeof i[n]&&(i[n]=[]),i[n].push(r[n]),n+=1;t+=1}return i}),li=function(){var e="	\n\x0B\f\r   \u2028\u2029\ufeff",t="",i="function"==typeof String.prototype.trim;return G(i&&!e.trim()&&t.trim()?function(e){return e.trim()}:function(t){var i=new RegExp("^["+e+"]["+e+"]*"),r=new RegExp("["+e+"]["+e+"]*$");return t.replace(i,"").replace(r,"")})}(),ui=D(function(e,t){return r(e.length,function(){try{return e.apply(this,arguments)}catch(i){return t.apply(this,l([i],arguments))}})}),hi=G(function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)}),ci=G(function(e){return function(){return e(M(arguments))}}),fi=G(function(e){return gt(1,e)}),pi=D(function(e,t){return we(e,function(){for(var i,r=1,n=t,s=0;e>=r&&"function"==typeof n;)i=r===e?arguments.length:s+n.length,n=n.apply(this,M(arguments,s,i)),r+=1,s=i;return n})}),di=D(function(e,t){for(var i=e(t),r=[];i&&i.length;)r[r.length]=i[0],i=e(i[1]);return r}),gi=D(function(e,t){for(var i,r=0,n=t.length,s=[];n>r;)i=t[r],u(e,i,s)||(s[s.length]=i),r+=1;return s}),vi=q(function(e,t,i){return e(i)?i:t(i)}),yi=q(function(e,t,i){for(var r=i;!e(r);)r=t(r);return r}),mi=q(function(e,t,i){return ae(ue(t),e,i)}),bi=D(function(e,t){return we(t.length,function(){for(var i=[],r=0;r<t.length;)i.push(t[r].call(this,arguments[r])),r+=1;return e.apply(this,i.concat(M(arguments,t.length)))})}),wi=G(function(e){for(var t=Ye(e),i=t.length,r=[],n=0;i>n;)r[n]=e[t[n]],n+=1;return r}),xi=G(function(e){var t,i=[];for(t in e)i[i.length]=e[t];return i}),Si=function(){var e=function(e){return{value:e,map:function(){return this}}};return D(function(t,i){return t(e)(i).value})}(),_i=q(function(e,t,i){return e(i)?t(i):i}),Ti=D(function(e,t){for(var i in e)if(p(i,e)&&!e[i](t[i]))return!1;return!0}),Ci=D(function(e,t){return we(e.length,function(){return t.apply(this,l([e],arguments))})}),ki=D(function(e,t){for(var i,r=0,n=e.length,s=t.length,o=[];n>r;){for(i=0;s>i;)o[o.length]=[e[r],t[i]],i+=1;r+=1}return o}),Li=D(function(e,t){for(var i=[],r=0,n=Math.min(e.length,t.length);n>r;)i[r]=[e[r],t[r]],r+=1;return i}),Oi=D(function(e,t){for(var i=0,r=Math.min(e.length,t.length),n={};r>i;)n[e[i]]=t[i],i+=1;return n}),Ai=q(function(e,t,i){for(var r=[],n=0,s=Math.min(t.length,i.length);s>n;)r[n]=e(t[n],i[n]),n+=1;return r}),Ei=ue(!1),Ri=ue(!0),Mi=function Vn(e,t,i,r){var n=function(n){for(var s=t.length,o=0;s>o;){if(e===t[o])return i[o];o+=1}t[o+1]=e,i[o+1]=n;for(var a in e)n[a]=r?Vn(e[a],t,i,!0):e[a];return n};switch(hi(e)){case"Object":return n({});case"Array":return n([]);case"Date":return new Date(e.valueOf());case"RegExp":return o(e);default:return e}},Bi=function(e){return D(function(t,i){return r(Math.max(0,t.length-i.length),function(){return t.apply(this,e(i,arguments))})})},Ii=function(e,t){return ei(e<t.length?t.length-e:0,t)},Pi=function Xn(e,t,i,r){if(qe(e,t))return!0;if(hi(e)!==hi(t))return!1;if(null==e||null==t)return!1;if("function"==typeof e.equals||"function"==typeof t.equals)return"function"==typeof e.equals&&e.equals(t)&&"function"==typeof t.equals&&t.equals(e);switch(hi(e)){case"Arguments":case"Array":case"Object":if("function"==typeof e.constructor&&"Promise"===f(e.constructor))return e===t;break;case"Boolean":case"Number":case"String":if(typeof e!=typeof t||!qe(e.valueOf(),t.valueOf()))return!1;break;case"Date":if(!qe(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(e.source!==t.source||e.global!==t.global||e.ignoreCase!==t.ignoreCase||e.multiline!==t.multiline||e.sticky!==t.sticky||e.unicode!==t.unicode)return!1;break;case"Map":case"Set":if(!Xn(n(e.entries()),n(t.entries()),i,r))return!1;break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":break;case"ArrayBuffer":break;default:return!1}var s=Ye(e);if(s.length!==Ye(t).length)return!1;for(var o=i.length-1;o>=0;){if(i[o]===e)return r[o]===t;o-=1}for(i.push(e),r.push(t),o=s.length-1;o>=0;){var a=s[o];if(!p(a,t)||!Xn(t[a],e[a],i,r))return!1;o-=1}return i.pop(),r.pop(),!0},Hi=function(e){return function t(i){for(var r,n,s,o=[],a=0,l=i.length;l>a;){if(Ze(i[a]))for(r=e?t(i[a]):i[a],s=0,n=r.length;n>s;)o[o.length]=r[s],s+=1;else o[o.length]=i[a];a+=1}return o}},Ni=function(){function e(e,t,i){for(var r=0,n=i.length;n>r;){if(t=e["@@transducer/step"](t,i[r]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r+=1}return e["@@transducer/result"](t)}function t(e,t,i){for(var r=i.next();!r.done;){if(t=e["@@transducer/step"](t,r.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r=i.next()}return e["@@transducer/result"](t)}function i(e,t,i){return e["@@transducer/result"](i.reduce(ye(e["@@transducer/step"],e),t))}var r="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(n,s,o){if("function"==typeof n&&(n=P(n)),Ze(o))return e(n,s,o);if("function"==typeof o.reduce)return i(n,s,o);if(null!=o[r])return t(n,s,o[r]());if("function"==typeof o.next)return t(n,s,o);throw new TypeError("reduce: list must be array or iterable")}}(),Fi=function(){var e={"@@transducer/init":Array,"@@transducer/step":function(e,t){return e.push(t),e},"@@transducer/result":d},t={"@@transducer/init":String,"@@transducer/step":function(e,t){return e+t},"@@transducer/result":d},i={"@@transducer/init":Object,"@@transducer/step":function(e,t){return N(e,Ze(t)?xt(t[0],t[1]):t)},"@@transducer/result":d};return function(r){if(T(r))return r;if(Ze(r))return e;if("string"==typeof r)return t;if("object"==typeof r)return i;throw new Error("Cannot create transformer for "+r)}}(),Gi=function(){function e(e,t){this.f=e,this.retained=[],this.xf=t}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){return this.retained=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.f(t)?this.retain(e,t):this.flush(e,t)},e.prototype.flush=function(e,t){return e=Ni(this.xf["@@transducer/step"],e,this.retained),this.retained=[],this.xf["@@transducer/step"](e,t)},e.prototype.retain=function(e,t){return this.retained.push(t),e},D(function(t,i){return new e(t,i)})}(),Di=function(){function e(e,t){
this.xf=t,this.f=e,this.inputs={}}return e.prototype["@@transducer/init"]=I.init,e.prototype["@@transducer/result"]=function(e){var t;for(t in this.inputs)if(p(t,this.inputs)&&(e=this.xf["@@transducer/step"](e,this.inputs[t]),e["@@transducer/reduced"])){e=e["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){var i=this.f(t);return this.inputs[i]=this.inputs[i]||[i,[]],this.inputs[i][1]=pe(t,this.inputs[i][1]),e},D(function(t,i){return new e(t,i)})}(),qi=G(function(e){return we(e.length,function(){var t=0,i=arguments[0],r=arguments[arguments.length-1],n=M(arguments);return n[0]=function(){var e=i.apply(this,l(arguments,[t,r]));return t+=1,e},e.apply(this,n)})}),Ui=G(function(e){return gt(2,e)}),zi=G(function(e){return null!=e&&"function"==typeof e.clone?e.clone():Mi(e,[],[],!0)}),ji=G(function(e){return we(e.length,e)}),Wi=D(z("drop",K,function(e,t){return Vt(Math.max(0,e),1/0,t)})),Vi=D(z("dropLast",Z,Ii)),Xi=D(z("dropLastWhile",Gi,j)),Ki=D(function(e,t){return Pi(e,t,[],[])}),Zi=D(z("filter",$,function(e,t){return w(t)?Ni(function(i,r){return e(t[r])&&(i[r]=t[r]),i},{},Ye(t)):h(e,t)})),Qi=G(Hi(!0)),Yi=G(function(e){return ji(function(t,i){var r=M(arguments);return r[0]=i,r[1]=t,e.apply(this,r)})}),$i=bt(0),Ji=Vt(0,-1),er=q(function(e,t,i){var r,n;t.length>i.length?(r=t,n=i):(r=i,n=t);for(var s=[],o=0;o<n.length;)u(e,n[o],r)&&(s[s.length]=n[o]),o+=1;return gi(e,s)}),tr=q(function(e,t,i){return T(e)?Ni(t(e),e["@@transducer/init"](),i):Ni(t(Fi(e)),Mi(e,[],[],!1),i)}),ir=G(function(e){for(var t=Ye(e),i=t.length,r=0,n={};i>r;){var s=t[r],o=e[s],a=p(o,n)?n[o]:n[o]=[];a[a.length]=s,r+=1}return n}),rr=G(function(e){for(var t=Ye(e),i=t.length,r=0,n={};i>r;){var s=t[r];n[e[s]]=s,r+=1}return n}),nr=G(function(e){return null!=e&&Ki(e,Oe(e))}),sr=bt(-1),or=D(function(e,t){if("function"!=typeof t.lastIndexOf||v(t)){for(var i=t.length-1;i>=0;){if(Ki(t[i],e))return i;i-=1}return-1}return t.lastIndexOf(e)}),ar=D(z("map",re,function(e,t){switch(Object.prototype.toString.call(t)){case"[object Function]":return we(t.length,function(){return e.call(this,t.apply(this,arguments))});case"[object Object]":return Ni(function(i,r){return i[r]=e(t[r]),i},{},Ye(t));default:return C(e,t)}})),lr=D(function(e,t){return Ni(function(i,r){return i[r]=e(t[r],r,t),i},{},Ye(t))}),ur=q(function(e,t,i){return ht(function(t,i,r){return e(i,r)},t,i)}),hr=Bi(l),cr=Bi(Yi(l)),fr=q(function(e,t,i){return Ki(Lt(e,i),t)}),pr=D(function(e,t){return ar(It(e),t)}),dr=bi(C,[Rt,Ue]),gr=q(function(e,t,i){return Ht(Ki(t),e,i)}),vr=q(function(e,t,i){return Ht(Ke(e),t,i)}),yr=q(Ni),mr=U(4,[],function(e,t,i,r){return Ni(function(r,n){var s=i(n);return r[s]=e(p(s,r)?r[s]:t,n),r},{},r)}),br=D(function(e,t){return Zi(a(e),t)}),wr=D(function(e,t){return ni(ue(e),t)}),xr=yr(oe,0),Sr=D(function(e,t){return Wi(e>=0?t.length-e:0,t)}),_r=we(4,function(e,t,i,r){return Ni(e("function"==typeof t?P(t):t),i,r)}),Tr=q(function(e,t,i){return gi(e,l(t,i))}),Cr=D(function(e,t){return Ti(ar(Ki,e),t)}),kr=function(){var e=function(e){return{"@@transducer/init":I.init,"@@transducer/result":function(t){return e["@@transducer/result"](t)},"@@transducer/step":function(t,i){var r=e["@@transducer/step"](t,i);return r["@@transducer/reduced"]?c(r):r}}};return function(t){var i=e(t);return{"@@transducer/init":I.init,"@@transducer/result":function(e){return i["@@transducer/result"](e)},"@@transducer/step":function(e,t){return Ze(t)?Ni(i,e,t):Ni(i,e,[t])}}}}(),Lr=function(e,t,i){var r,n;if("function"==typeof e.indexOf)switch(typeof t){case"number":if(0===t){for(r=1/t;i<e.length;){if(n=e[i],0===n&&1/n===r)return i;i+=1}return-1}if(t!==t){for(;i<e.length;){if(n=e[i],"number"==typeof n&&n!==n)return i;i+=1}return-1}return e.indexOf(t,i);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,i);case"object":if(null===t)return e.indexOf(t,i)}for(;i<e.length;){if(Ki(e[i],t))return i;i+=1}return-1},Or=D(function(e,t){return ar(e,kr(t))}),Ar=G(function(e){return we(yr(ot,0,pr("length",e)),function(){for(var t=0,i=e.length;i>t;){if(!e[t].apply(this,arguments))return!1;t+=1}return!0})}),Er=G(function(e){for(var t=e.length,i=0;t>i;){if(Lr(e,e[i],i+1)>=0)return!1;i+=1}return!0}),Rr=G(function(e){return we(yr(ot,0,pr("length",e)),function(){for(var t=0,i=e.length;i>t;){if(e[t].apply(this,arguments))return!0;t+=1}return!1})}),Mr=D(function(e,t){return"function"==typeof e.ap?e.ap(t):"function"==typeof e?we(Math.max(e.length,t.length),function(){return e.apply(this,arguments)(t.apply(this,arguments))}):Ni(function(e,i){return l(e,ar(i,t))},[],e)}),Br=G(function Kn(e){return e=ar(function(e){return"function"==typeof e?e:Kn(e)},e),we(yr(ot,0,pr("length",wi(e))),function(){var t=arguments;return ar(function(e){return de(e,t)},e)})}),Ir=ji(function(e){return e.apply(this,M(arguments,1))}),Pr=D(z("chain",Or,function(e,t){return"function"==typeof t?function(){return t.call(this,e.apply(this,arguments)).apply(this,arguments)}:Hi(!1)(ar(e,t))})),Hr=G(function(e){var t=yr(ot,0,ar(function(e){return e[0].length},e));return r(t,function(){for(var t=0;t<e.length;){if(e[t][0].apply(this,arguments))return e[t][1].apply(this,arguments);t+=1}})}),Nr=D(function(e,t){if(e>10)throw new Error("Constructor with greater than ten arguments");return 0===e?function(){return new t}:ji(gt(e,function(e,i,r,n,s,o,a,l,u,h){switch(arguments.length){case 1:return new t(e);case 2:return new t(e,i);case 3:return new t(e,i,r);case 4:return new t(e,i,r,n);case 5:return new t(e,i,r,n,s);case 6:return new t(e,i,r,n,s,o);case 7:return new t(e,i,r,n,s,o,a);case 8:return new t(e,i,r,n,s,o,a,l);case 9:return new t(e,i,r,n,s,o,a,l,u);case 10:return new t(e,i,r,n,s,o,a,l,u,h)}}))}),Fr=D(function(e,t){return we(yr(ot,0,pr("length",t)),function(){var i=arguments,r=this;return e.apply(r,C(function(e){return e.apply(r,i)},t))})}),Gr=mr(function(e,t){return e+1},0),Dr=D(z("dropRepeatsWith",Q,function(e,t){var i=[],r=1,n=t.length;if(0!==n)for(i[0]=t[0];n>r;)e(sr(i),t[r])||(i[i.length]=t[r]),r+=1;return i})),qr=q(function(e,t,i){return Ki(e(t),e(i))}),Ur=q(function(e,t,i){return Ki(t[e],i[e])}),zr=D(z("groupBy",Di,mr(function(e,t){return null==e&&(e=[]),e.push(t),e},null))),jr=mr(function(e,t){return t},null),Wr=D(function(e,t){return"function"!=typeof t.indexOf||v(t)?Lr(t,e,0):t.indexOf(e)}),Vr=G(function(e){return Fr(s,e)}),Xr=D(function(e,t){return function(i){return function(r){return ar(function(e){return t(e,r)},i(e(r)))}}}),Kr=G(function(e){return Xr(bt(e),mi(e))}),Zr=G(function(e){return Xr(Lt(e),ve(e))}),Qr=G(function(e){return Xr(It(e),ge(e))}),Yr=D(function(e,t){var i=we(e,t);return we(e,function(){return Ni(Mr,ar(i,arguments[0]),M(arguments,1))})}),$r=G(function(e){return xr(e)/e.length}),Jr=G(function(e){var t=e.length;if(0===t)return NaN;var i=2-t%2,r=(t-i)/2;return $r(M(e).sort(function(e,t){return t>e?-1:e>t?1:0}).slice(r,r+i))}),en=Vr([Zi,br]),tn=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return r(arguments[0].length,yr(O,arguments[0],Jt(arguments)))},rn=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return r(arguments[0].length,yr(A,arguments[0],Jt(arguments)))},nn=yr(dt,1),sn=D(function(e,t){return"function"==typeof t.sequence?t.sequence(e):Gt(function(e,t){return Mr(ar(Bt,t),e)},e([]),t)}),on=q(function(e,t,i){return sn(e,ar(t,i))}),an=Pr(d),ln=function(e,t){return Lr(t,e,0)>=0},un=function Zn(e,t){var i=function(i){var r=t.concat([e]);return ln(i,r)?"<Circular>":Zn(i,r)},r=function(e,t){return C(function(t){return E(t)+": "+i(e[t])},t.slice().sort())};switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+C(i,e).join(", ")+"))";case"[object Array]":return"["+C(i,e).concat(r(e,br(function(e){return/^\d+$/.test(e)},Ye(e)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof e?"new Boolean("+i(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?i(NaN):E(B(e)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof e?"new Number("+i(e.valueOf())+")":1/e===-(1/0)?"-0":e.toString(10);case"[object String]":return"object"==typeof e?"new String("+i(e.valueOf())+")":E(e);case"[object Undefined]":return"undefined";default:if("function"==typeof e.toString){var n=e.toString();if("[object Object]"!==n)return n}return"{"+r(e,Ye(e)).join(", ")+"}"}},hn=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return tn.apply(this,zt(arguments))},cn=function(){return hn.apply(this,Bt(Ue,ar(Pr,arguments)))},fn=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return rn.apply(this,zt(arguments))},pn=G(function(e){return Nr(e.length,e)}),dn=D(ln),gn=D(function(e,t){for(var i=[],r=0,n=e.length;n>r;)ln(e[r],t)||ln(e[r],i)||(i[i.length]=e[r]),r+=1;return i}),vn=G(z("dropRepeats",Q(Ki),Dr(Ki))),yn=G(function(e){return Yr(e.length,e)}),mn=D(function(e,t){var i={};for(var r in t)ln(r,e)||(i[r]=t[r]);return i}),bn=function(){return cn.apply(this,zt(arguments))},wn=G(function(e){return un(e,[])}),xn=D(function(e,t){return br(Yi(ln)(e),t)}),Sn=function(){function e(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}function t(e,t,i){var r,n,s=typeof e;switch(s){case"string":case"number":return 0!==e||i._items["-0"]||1/e!==-(1/0)?null!==i._nativeSet?t?(r=i._nativeSet.size,i._nativeSet.add(e),n=i._nativeSet.size,n>r):i._nativeSet.has(e):s in i._items?e in i._items[s]?!t:(t&&(i._items[s][e]=!0),t):(t&&(i._items[s]={},i._items[s][e]=!0),t):(t&&(i._items["-0"]=!0),t);case"boolean":if(s in i._items){var o=e?1:0;return i._items[s][o]?!t:(t&&(i._items[s][o]=!0),t)}return t&&(i._items[s]=e?[!1,!0]:[!0,!1]),t;case"function":return null!==i._nativeSet?t?(r=i._nativeSet.size,i._nativeSet.add(e),n=i._nativeSet.size,n>r):i._nativeSet.has(e):s in i._items?ln(e,i._items[s])?!t:(t&&i._items[s].push(e),t):(t&&(i._items[s]=[e]),t);case"undefined":return i._items[s]?!t:(t&&(i._items[s]=!0),t);case"object":if(null===e)return i._items["null"]?!t:(t&&(i._items["null"]=!0),t);default:return s=Object.prototype.toString.call(e),s in i._items?ln(e,i._items[s])?!t:(t&&i._items[s].push(e),t):(t&&(i._items[s]=[e]),t)}}return e.prototype.add=function(e){return t(e,!0,this)},e.prototype.has=function(e){return t(e,!1,this)},e}(),_n=D(function(e,t){return y(e)?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:yn(he)(e,t)}),Tn=yn(mt),Cn=D(function(e,t){return y(e)?function(){return e.apply(this,arguments)||t.apply(this,arguments)}:yn(Tt)(e,t)}),kn=D(function(e,t){return we(e+1,function(){var i=arguments[e];if(null!=i&&Ke(Function,i[t]))return i[t].apply(i,M(arguments,0,e));throw new TypeError(wn(i)+' does not have a method named "'+t+'"')})}),Ln=kn(1,"join"),On=G(function(e){var t={};return r(e.length,function(){var i=wn(arguments);return p(i,t)||(t[i]=e.apply(this,arguments)),t[i]})}),An=kn(1,"split"),En=D(function(e,t){if(!S(e))throw new TypeError("test requires a value of type RegExp as its first argument; received "+wn(e));return o(e).test(t)}),Rn=kn(0,"toLowerCase"),Mn=kn(0,"toUpperCase"),Bn=D(function(e,t){for(var i,r,n=new Sn,s=[],o=0;o<t.length;)r=t[o],i=e(r),n.add(i)&&s.push(r),o+=1;return s}),In=Yi(kn(1,"concat")),Pn=D(function(e,t){return In(gn(e,t),gn(t,e))}),Hn=q(function(e,t,i){return In(_e(e,t,i),_e(e,i,t))}),Nn=Bn(Ue),Fn=D(function(e,t){var i,r;return e.length>t.length?(i=e,r=t):(i=t,r=e),Nn(h(Yi(ln)(i),r))}),Gn=D(hn(Nn,l)),Dn={F:Ei,T:Ri,__:e,add:oe,addIndex:qi,adjust:ae,all:le,allPass:Ar,allUniq:Er,always:ue,and:he,any:ce,anyPass:Rr,ap:Mr,aperture:fe,append:pe,apply:de,applySpec:Br,assoc:ge,assocPath:ve,binary:Ui,bind:ye,both:_n,call:Ir,chain:Pr,clamp:me,clone:zi,comparator:be,complement:Tn,compose:hn,composeK:cn,composeP:fn,concat:In,cond:Hr,construct:pn,constructN:Nr,contains:dn,converge:Fr,countBy:Gr,curry:ji,curryN:we,dec:xe,defaultTo:Se,difference:gn,differenceWith:_e,dissoc:Te,dissocPath:Ce,divide:ke,drop:Wi,dropLast:Vi,dropLastWhile:Xi,dropRepeats:vn,dropRepeatsWith:Dr,dropWhile:Le,either:Cn,empty:Oe,eqBy:qr,eqProps:Ur,equals:Ki,evolve:Ae,filter:Zi,find:Ee,findIndex:Re,findLast:Me,findLastIndex:Be,flatten:Qi,flip:Yi,forEach:Ie,fromPairs:Pe,groupBy:zr,groupWith:He,gt:Ne,gte:Fe,has:Ge,hasIn:De,head:$i,identical:qe,identity:Ue,ifElse:ze,inc:je,indexBy:jr,indexOf:Wr,init:Ji,insert:We,insertAll:Ve,intersection:Fn,intersectionWith:er,intersperse:Xe,into:tr,invert:ir,invertObj:rr,invoker:kn,is:Ke,isArrayLike:Ze,isEmpty:nr,isNil:Qe,join:Ln,juxt:Vr,keys:Ye,keysIn:$e,last:sr,lastIndexOf:or,length:Je,lens:Xr,lensIndex:Kr,lensPath:Zr,lensProp:Qr,lift:yn,liftN:Yr,lt:et,lte:tt,map:ar,mapAccum:it,mapAccumRight:rt,mapObjIndexed:lr,match:nt,mathMod:st,max:ot,maxBy:at,mean:$r,median:Jr,memoize:On,merge:lt,mergeAll:ut,mergeWith:ur,mergeWithKey:ht,min:ct,minBy:ft,modulo:pt,multiply:dt,nAry:gt,negate:vt,none:yt,not:mt,nth:bt,nthArg:wt,objOf:xt,of:St,omit:mn,once:_t,or:Tt,over:Ct,pair:kt,partial:hr,partialRight:cr,partition:en,path:Lt,pathEq:fr,pathOr:Ot,pathSatisfies:At,pick:Et,pickAll:Rt,pickBy:Mt,pipe:tn,pipeK:bn,pipeP:rn,pluck:pr,prepend:Bt,product:nn,project:dr,prop:It,propEq:gr,propIs:vr,propOr:Pt,propSatisfies:Ht,props:Nt,range:Ft,reduce:yr,reduceBy:mr,reduceRight:Gt,reduced:Dt,reject:br,remove:qt,repeat:wr,replace:Ut,reverse:zt,scan:jt,sequence:sn,set:Wt,slice:Vt,sort:Xt,sortBy:Kt,split:An,splitAt:Zt,splitEvery:Qt,splitWhen:Yt,subtract:$t,sum:xr,symmetricDifference:Pn,symmetricDifferenceWith:Hn,tail:Jt,take:ei,takeLast:Sr,takeLastWhile:ti,takeWhile:ii,tap:ri,test:En,times:ni,toLower:Rn,toPairs:si,toPairsIn:oi,toString:wn,toUpper:Mn,transduce:_r,transpose:ai,traverse:on,trim:li,tryCatch:ui,type:hi,unapply:ci,unary:fi,uncurryN:pi,unfold:di,union:Gn,unionWith:Tr,uniq:Nn,uniqBy:Bn,uniqWith:gi,unless:vi,unnest:an,until:yi,update:mi,useWith:bi,values:wi,valuesIn:xi,view:Si,when:_i,where:Ti,whereEq:Cr,without:xn,wrap:Ci,xprod:ki,zip:Li,zipObj:Oi,zipWith:Ai};"object"==typeof i?t.exports=Dn:"function"==typeof define&&define.amd?define(function(){return Dn}):this.R=Dn}).call(this)},{}]},{},[19]);
//# sourceMappingURL=dalliance-all.js.map